{"job":{"components":{"6336629":{"id":6336629,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":272,"y":16,"width":32,"height":32,"inputConnectorIDs":[6336633],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DIM_CUSTOMER_Failure"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cursor = context.cursor()\ncursor.execute(\"INSERT INTO ${SNFLDWHDB}.${SNFLDWHSCH}.AUDIT_METRICS(JOB_NAME,USER_NAME,SOURCEDB_NAME,SOURCESCHEMA_NAME,DESTINATIONDB_NAME,DESTINATIONSCHEMA_NAME,ROWS_INSERTED, ROWS_UPDATED, START_DATE, END_DATE,JOB_STATUS)  select '%s' AS JOB_NAME ,CURRENT_USER() AS USER_NAME ,'${SNFLKDB}' AS SOURCEDB_NAME ,'${SNFLKSCH}' AS SOURCESCHEMA_NAME ,'${SNFLDWHDB}' AS DESTINATIONDB_NAME ,'${SNFLDWHSCH}' AS DESTINATIONSCHEMA_NAME ,0 AS ROWS_INSERTED ,0 AS ROWS_UPDATED ,'%s' AS START_DATE ,CURRENT_TIMESTAMP() AS END_DATE ,'FAILURE' AS JOB_STATUS\" % (Job_Name,Job_StartTimeStamp))\t\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6336630":{"id":6336630,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-224,"y":16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6336632],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6336631":{"id":6336631,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":16,"y":16,"width":32,"height":32,"inputConnectorIDs":[6336632],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[6336633],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Status","mapTo":"audit_status"},"2":{"slot":2,"fromId":null,"fromName":"Component","mapTo":"audit_component"},"3":{"slot":3,"fromId":null,"fromName":"Started At","mapTo":"audit_started"},"4":{"slot":4,"fromId":null,"fromName":"Duration","mapTo":"audit_duration"},"5":{"slot":5,"fromId":null,"fromName":"Completed At","mapTo":"audit_completed"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DIM_CUSTOMER"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"from datetime import datetime\nfrom pytz import timezone\n\n\njob_name = 'DW_DIM_CUSTOMER'\ncontext.updateVariable(\"Job_Name\",job_name)\n\nfmt = \"%Y-%m-%d %H:%M:%S\"\nCurrentTime = datetime.now(timezone(snowflake_timezone))\ncontext.updateVariable(\"Job_StartTimeStamp\",CurrentTime.strftime(fmt))\n\ncursor = context.cursor()\n#cursor.execute(\"MERGE INTO ${SNFLDWHDB}.${SNFLDWHSCH}.DIM_CUSTOMER MGE USING (SELECT DISTINCT NVL(DIM.CUSTOMERID,LDG.ACCOUNTID) COMB_ID, LDG.PARENTACCOUNTID, LDG.ACCOUNTNUMBER, LDG.NAME, LDG.CDA_BRANCHID, LDG.BRANDLEVEL_NAME, LDG.cda_WeekEndingDate, LDG.cda_invoicename, LDG.cda_isvmsaccount, LDG.cda_legacyid , LDG.cda_riskstatuscode, LDG.cda_creditstatus, LDG.cda_brand, LDG.cda_credit_vip, LDG.cda_isnationalaccount, LDG.cda_lampaccount, LDG.cda_skilllevel, LDG.cda_creditapprovedon, LDG.cda_riskapprovedon, LDG.ownerid, LDG.cda_spmid, LDG.cda_strategicaccountmanager, LDG.statecode, LDG.statuscode, LDG.cda_creditlimit, LDG.cda_staffingsupervisor, LDG.paymenttermscode, LDG.cda_paycycle, LDG.cda_billcycle, LDG.cda_timeentryfrequency, LDG.cda_timechannel , LDG.cda_timeentrytool, LDG.cda_accounttypecode, LDG.NAT_CUSTOMER, LDG.SEARCH_NAME, LDG.MODIFIEDON, LDG.CREATEDON FROM ${SNFLDWHDB}.${SNFLDWHSCH}.DIM_CUSTOMER DIM FULL OUTER JOIN ( SELECT distinct AB.*, SMB.* ,C.NAT_CUSTOMER, D.SEARCH_NAME FROM (SELECT DISTINCT CDA_SKILLLEVEL, ACCOUNTID, PARENTACCOUNTID, ACCOUNTNUMBER, NAME, CDA_BRANCHID, MODIFIEDON, CREATEDON , cda_WeekEndingDate, CDA_INVOICENAME, cda_legacyid , cda_riskstatuscode, cda_creditstatus, cda_brand, cda_credit_vip, cda_isnationalaccount, cda_lampaccount, cda_accounttypecode, CDA_ISVMSACCOUNT, cda_creditapprovedon, cda_riskapprovedon, ownerid, cda_spmid, cda_strategicaccountmanager, statecode, statuscode, cda_creditlimit, cda_staffingsupervisor, paymenttermscode, cda_paycycle, cda_billcycle, cda_timeentryfrequency, cda_timechannel, cda_timeentrytool FROM ${SNFLKDB}.${SNFLKSCH}.CRM_DL_LDG_ACCOUNTBASE QUALIFY ROW_NUMBER() OVER (PARTITION BY ACCOUNTID ORDER BY MODIFIEDON DESC,CREATEDON DESC) = 1 ) AB LEFT JOIN (SELECT VALUE AS BRANDLEVEL_NAME, ATTRIBUTEVALUE, OBJECTTYPECODE FROM ${SNFLKDB}.${SNFLKSCH}.CRM_DL_LDG_STRINGMAPBASE WHERE OBJECTTYPECODE = 1 AND UPPER(ATTRIBUTENAME) = 'CDA_SKILLLEVEL' QUALIFY ROW_NUMBER() OVER (PARTITION BY OBJECTTYPECODE, ATTRIBUTENAME, ATTRIBUTEVALUE ORDER BY DL_CREATED_DATE DESC) = 1 ) SMB ON AB.CDA_SKILLLEVEL = SMB.ATTRIBUTEVALUE LEFT OUTER JOIN ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.NATACCT C ON AB.ACCOUNTNUMBER = LTRIM(CUSTOMER) LEFT OUTER JOIN ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.ARCUSTOMER D ON AB.ACCOUNTNUMBER = LTRIM(D.CUSTOMER) ) LDG ON DIM.CUSTOMERID = LDG.ACCOUNTID where (DATE_TRUNC('DAY',LDG.MODIFIEDON)>= (SELECT NVL(MAX(DATE_TRUNC('DAY',DW_CREATED_DATE)),'2000-01-01') FROM ${SNFLDWHDB}.${SNFLDWHSCH}.DIM_CUSTOMER ) OR DATE_TRUNC('DAY',LDG.CREATEDON)>= (SELECT NVL(MAX(DATE_TRUNC('DAY',DW_CREATED_DATE)),'2000-01-01') FROM ${SNFLDWHDB}.${SNFLDWHSCH}.DIM_CUSTOMER) ) ) COMB ON MGE.CUSTOMERID = COMB.COMB_ID WHEN NOT MATCHED THEN INSERT(CUSTOMERID, PARENTCUSTOMERID, CUSTOMERNUMBER, NAME, BRANCHID, BRANDLEVEL_NAME, WeekEndingDate, InvoiceFormName, LegacyID, AccountType, RiskStatus, CreditStatus, BrandID, VIPAccount, NationalAccount, LAMPAccount, VMSAccount, BrandLevel, CreditApprovedDate, RiskApprovedDate, BusinessDevManagerID, SPMID, NPGManagerID, StateCode, StatusCode, CreditLimit, PSSMID, PaymentTerms, PayCycle, BillCycle, TimeEntryFrequency, TimeChannel, TimeentryTool, LawsonParentNumber, SearchName, DW_CREATED_DATE, DW_MODIFIED_DATE) VALUES (COMB.COMB_ID, COMB.PARENTACCOUNTID, COMB.ACCOUNTNUMBER, COMB.NAME, COMB.CDA_BRANCHID, COMB.BRANDLEVEL_NAME, COMB.cda_WeekEndingDate, COMB.cda_invoicename, COMB.cda_legacyid, COMB.cda_accounttypecode, COMB.cda_riskstatuscode, COMB.cda_creditstatus, COMB.cda_brand, COMB.cda_credit_vip, COMB.cda_isnationalaccount, COMB.cda_lampaccount, COMB.cda_isvmsaccount, COMB.cda_skilllevel, COMB.cda_creditapprovedon, COMB.cda_riskapprovedon, COMB.ownerid, COMB.cda_spmid, COMB.cda_strategicaccountmanager, COMB.statecode, COMB.statuscode, COMB.cda_creditlimit, COMB.cda_staffingsupervisor, COMB.paymenttermscode, COMB.cda_paycycle, COMB.cda_billcycle, COMB.cda_timeentryfrequency, COMB.cda_timechannel, COMB.cda_timeentrytool, COMB.NAT_CUSTOMER, COMB.SEARCH_NAME, current_timestamp, current_timestamp) WHEN MATCHED AND MGE.CUSTOMERID = COMB.COMB_ID AND COMB.PARENTACCOUNTID <> MGE.PARENTCUSTOMERID OR COMB.ACCOUNTNUMBER <> MGE.CUSTOMERNUMBER OR COMB.NAME <> MGE.NAME OR COMB.CDA_BRANCHID <> MGE.BRANCHID OR COMB.BRANDLEVEL_NAME <> MGE.BRANDLEVEL_NAME OR WeekEndingDate <> cda_WeekEndingDate OR InvoiceFormName <> cda_invoicename OR LegacyID <> cda_legacyid OR AccountType <> cda_accounttypecode OR RiskStatus <> cda_riskstatuscode OR CreditStatus <> cda_creditstatus OR BrandID <> cda_brand OR VIPAccount <> cda_credit_vip OR NationalAccount <> cda_isnationalaccount OR LAMPAccount <> cda_lampaccount OR VMSAccount <> cda_isvmsaccount OR BrandLevel <> cda_skilllevel OR CreditApprovedDate <> cda_creditapprovedon OR RiskApprovedDate <> cda_riskapprovedon OR BusinessDevManagerID <> ownerid OR SPMID <> cda_spmid OR NPGManagerID <> cda_strategicaccountmanager OR MGE.StateCode <> COMB.statecode OR MGE.StatusCode <> COMB.statuscode OR CreditLimit <> cda_creditlimit OR PSSMID <> cda_staffingsupervisor OR PaymentTerms <> paymenttermscode OR PayCycle <> cda_paycycle OR BillCycle <> cda_billcycle OR TimeEntryFrequency <> cda_timeentryfrequency OR TimeChannel <> cda_timechannel OR TimeentryTool <> cda_timeentrytool OR MGE.LawsonParentNumber <> COMB.NAT_CUSTOMER OR MGE.SearchName <> COMB.SEARCH_NAME THEN UPDATE SET MGE.PARENTCUSTOMERID = COMB.PARENTACCOUNTID, MGE.CUSTOMERNUMBER = COMB.ACCOUNTNUMBER, MGE.NAME = COMB.NAME, MGE.BRANCHID = COMB.CDA_BRANCHID, MGE.BRANDLEVEL_NAME = COMB.BRANDLEVEL_NAME, WeekEndingDate = cda_WeekEndingDate, InvoiceFormName = cda_invoicename, LegacyID = cda_legacyid, AccountType = cda_accounttypecode, RiskStatus = cda_riskstatuscode, CreditStatus = cda_creditstatus, BrandID = cda_brand, VIPAccount = cda_credit_vip, NationalAccount = cda_isnationalaccount, LAMPAccount = cda_lampaccount, VMSAccount = cda_isvmsaccount, BrandLevel = cda_skilllevel, CreditApprovedDate = cda_creditapprovedon, RiskApprovedDate = cda_riskapprovedon, BusinessDevManagerID = ownerid, SPMID = cda_spmid, NPGManagerID = cda_strategicaccountmanager, MGE.StateCode = COMB.statecode, MGE.StatusCode = COMB.statuscode, CreditLimit = cda_creditlimit, PSSMID = cda_staffingsupervisor, PaymentTerms = paymenttermscode, PayCycle = cda_paycycle, BillCycle = cda_billcycle, TimeEntryFrequency = cda_timeentryfrequency, TimeChannel = cda_timechannel, TimeentryTool = cda_timeentrytool, MGE.LawsonParentNumber = COMB.NAT_CUSTOMER, MGE.SearchName = COMB.SEARCH_NAME, MGE.DW_MODIFIED_DATE = CURRENT_TIMESTAMP\")\ncursor.execute(\"MERGE INTO ${SNFLDWHDB}.${SNFLDWHSCH}.DIM_CUSTOMER MGE USING (SELECT DISTINCT NVL(DIM.CUSTOMERID, LDG.ACCOUNTID) COMB_ID, LDG.PARENTACCOUNTID, LDG.ACCOUNTNUMBER, LDG.NAME, LDG.CDA_BRANCHID, LDG.BRANDLEVEL_NAME, LDG.cda_WeekEndingDate, LDG.cda_invoicename, LDG.cda_isvmsaccount, LDG.cda_legacyid, LDG.cda_riskstatuscode, LDG.cda_creditstatus, LDG.cda_brand, LDG.cda_credit_vip, LDG.cda_isnationalaccount, LDG.cda_lampaccount, LDG.cda_skilllevel, LDG.cda_creditapprovedon, LDG.cda_riskapprovedon, LDG.ownerid, LDG.cda_spmid, LDG.cda_strategicaccountmanager, LDG.statecode, LDG.statuscode, LDG.cda_creditlimit, LDG.cda_staffingsupervisor, LDG.paymenttermscode, LDG.cda_paycycle, LDG.cda_billcycle, LDG.cda_timeentryfrequency, LDG.cda_timechannel, LDG.cda_timeentrytool, LDG.cda_accounttypecode, LDG.NAT_CUSTOMER, LDG.SEARCH_NAME, LDG.MODIFIEDON, LDG.CREATEDON FROM ${SNFLDWHDB}.${SNFLDWHSCH}.DIM_CUSTOMER DIM FULL OUTER JOIN (SELECT DISTINCT AB.*, SMB.*, C.NAT_CUSTOMER, D.SEARCH_NAME FROM (SELECT DISTINCT CDA_SKILLLEVEL, ACCOUNTID, PARENTACCOUNTID, ACCOUNTNUMBER, NAME, CDA_BRANCHID, MODIFIEDON, CREATEDON, cda_WeekEndingDate, CDA_INVOICENAME, cda_legacyid, cda_riskstatuscode, cda_creditstatus, cda_brand, cda_credit_vip, cda_isnationalaccount, cda_lampaccount, cda_accounttypecode, CDA_ISVMSACCOUNT, cda_creditapprovedon, cda_riskapprovedon, ownerid, cda_spmid, cda_strategicaccountmanager, statecode, statuscode, cda_creditlimit, cda_staffingsupervisor, paymenttermscode, cda_paycycle, cda_billcycle, cda_timeentryfrequency, cda_timechannel, cda_timeentrytool FROM ${SNFLKDB}.${SNFLKSCH}.CRM_DL_LDG_ACCOUNTBASE QUALIFY ROW_NUMBER() OVER (PARTITION BY ACCOUNTID ORDER BY MODIFIEDON DESC,CREATEDON DESC) = 1) AB LEFT JOIN (SELECT VALUE AS BRANDLEVEL_NAME, ATTRIBUTEVALUE, OBJECTTYPECODE FROM ${SNFLKDB}.${SNFLKSCH}.CRM_DL_LDG_STRINGMAPBASE WHERE OBJECTTYPECODE = 1 AND UPPER(ATTRIBUTENAME) = 'CDA_SKILLLEVEL' QUALIFY ROW_NUMBER() OVER (PARTITION BY OBJECTTYPECODE, ATTRIBUTENAME, ATTRIBUTEVALUE ORDER BY DL_CREATED_DATE DESC) = 1 ) SMB ON AB.CDA_SKILLLEVEL = SMB.ATTRIBUTEVALUE LEFT OUTER JOIN (SELECT * FROM ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.NATACCT QUALIFY ROW_NUMBER() OVER (PARTITION BY CUSTOMER ORDER BY NAT_CUSTOMER DESC) = 1 ) C ON AB.ACCOUNTNUMBER = LTRIM(C.CUSTOMER) LEFT OUTER JOIN (SELECT * FROM ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.ARCUSTOMER QUALIFY ROW_NUMBER() OVER (PARTITION BY CUSTOMER ORDER BY start_date DESC) = 1 ) D ON AB.ACCOUNTNUMBER = LTRIM(D.CUSTOMER)) LDG ON DIM.CUSTOMERID = LDG.ACCOUNTID WHERE (DATE_TRUNC('DAY', LDG.MODIFIEDON)>= (SELECT NVL(MAX(DATE_TRUNC('DAY', DW_CREATED_DATE)), '2000-01-01') FROM ${SNFLDWHDB}.${SNFLDWHSCH}.DIM_CUSTOMER) OR DATE_TRUNC('DAY', LDG.CREATEDON)>= (SELECT NVL(MAX(DATE_TRUNC('DAY', DW_CREATED_DATE)), '2000-01-01') FROM ${SNFLDWHDB}.${SNFLDWHSCH}.DIM_CUSTOMER)) ) COMB ON MGE.CUSTOMERID = COMB.COMB_ID WHEN NOT MATCHED THEN INSERT(CUSTOMERID, PARENTCUSTOMERID, CUSTOMERNUMBER, NAME, BRANCHID, BRANDLEVEL_NAME, WeekEndingDate, InvoiceFormName, LegacyID, AccountType, RiskStatus, CreditStatus, BrandID, VIPAccount, NationalAccount, LAMPAccount, VMSAccount, BrandLevel, CreditApprovedDate, RiskApprovedDate, BusinessDevManagerID, SPMID, NPGManagerID, StateCode, StatusCode, CreditLimit, PSSMID, PaymentTerms, PayCycle, BillCycle, TimeEntryFrequency, TimeChannel, TimeentryTool, LawsonParentNumber, SearchName, DW_CREATED_DATE, DW_MODIFIED_DATE) VALUES (COMB.COMB_ID, COMB.PARENTACCOUNTID, COMB.ACCOUNTNUMBER, COMB.NAME, COMB.CDA_BRANCHID, COMB.BRANDLEVEL_NAME, COMB.cda_WeekEndingDate, COMB.cda_invoicename, COMB.cda_legacyid, COMB.cda_accounttypecode, COMB.cda_riskstatuscode, COMB.cda_creditstatus, COMB.cda_brand, COMB.cda_credit_vip, COMB.cda_isnationalaccount, COMB.cda_lampaccount, COMB.cda_isvmsaccount, COMB.cda_skilllevel, COMB.cda_creditapprovedon, COMB.cda_riskapprovedon, COMB.ownerid, COMB.cda_spmid, COMB.cda_strategicaccountmanager, COMB.statecode, COMB.statuscode, COMB.cda_creditlimit, COMB.cda_staffingsupervisor, COMB.paymenttermscode, COMB.cda_paycycle, COMB.cda_billcycle, COMB.cda_timeentryfrequency, COMB.cda_timechannel, COMB.cda_timeentrytool, COMB.NAT_CUSTOMER, COMB.SEARCH_NAME, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) WHEN MATCHED AND MGE.CUSTOMERID = COMB.COMB_ID AND COMB.PARENTACCOUNTID <> MGE.PARENTCUSTOMERID OR COMB.ACCOUNTNUMBER <> MGE.CUSTOMERNUMBER OR COMB.NAME <> MGE.NAME OR COMB.CDA_BRANCHID <> MGE.BRANCHID OR COMB.BRANDLEVEL_NAME <> MGE.BRANDLEVEL_NAME OR WeekEndingDate <> cda_WeekEndingDate OR InvoiceFormName <> cda_invoicename OR LegacyID <> cda_legacyid OR AccountType <> cda_accounttypecode OR RiskStatus <> cda_riskstatuscode OR CreditStatus <> cda_creditstatus OR BrandID <> cda_brand OR VIPAccount <> cda_credit_vip OR NationalAccount <> cda_isnationalaccount OR LAMPAccount <> cda_lampaccount OR VMSAccount <> cda_isvmsaccount OR BrandLevel <> cda_skilllevel OR CreditApprovedDate <> cda_creditapprovedon OR RiskApprovedDate <> cda_riskapprovedon OR BusinessDevManagerID <> ownerid OR SPMID <> cda_spmid OR NPGManagerID <> cda_strategicaccountmanager OR MGE.StateCode <> COMB.statecode OR MGE.StatusCode <> COMB.statuscode OR CreditLimit <> cda_creditlimit OR PSSMID <> cda_staffingsupervisor OR PaymentTerms <> paymenttermscode OR PayCycle <> cda_paycycle OR BillCycle <> cda_billcycle OR TimeEntryFrequency <> cda_timeentryfrequency OR TimeChannel <> cda_timechannel OR TimeentryTool <> cda_timeentrytool OR MGE.LawsonParentNumber <> COMB.NAT_CUSTOMER OR MGE.SearchName <> COMB.SEARCH_NAME THEN UPDATE SET MGE.PARENTCUSTOMERID = COMB.PARENTACCOUNTID, MGE.CUSTOMERNUMBER = COMB.ACCOUNTNUMBER, MGE.NAME = COMB.NAME, MGE.BRANCHID = COMB.CDA_BRANCHID, MGE.BRANDLEVEL_NAME = COMB.BRANDLEVEL_NAME, WeekEndingDate = cda_WeekEndingDate, InvoiceFormName = cda_invoicename, LegacyID = cda_legacyid, AccountType = cda_accounttypecode, RiskStatus = cda_riskstatuscode, CreditStatus = cda_creditstatus, BrandID = cda_brand, VIPAccount = cda_credit_vip, NationalAccount = cda_isnationalaccount, LAMPAccount = cda_lampaccount, VMSAccount = cda_isvmsaccount, BrandLevel = cda_skilllevel, CreditApprovedDate = cda_creditapprovedon, RiskApprovedDate = cda_riskapprovedon, BusinessDevManagerID = ownerid, SPMID = cda_spmid, NPGManagerID = cda_strategicaccountmanager, MGE.StateCode = COMB.statecode, MGE.StatusCode = COMB.statuscode, CreditLimit = cda_creditlimit, PSSMID = cda_staffingsupervisor, PaymentTerms = paymenttermscode, PayCycle = cda_paycycle, BillCycle = cda_billcycle, TimeEntryFrequency = cda_timeentryfrequency, TimeChannel = cda_timechannel, TimeentryTool = cda_timeentrytool, MGE.LawsonParentNumber = COMB.NAT_CUSTOMER, MGE.SearchName = COMB.SEARCH_NAME, MGE.DW_MODIFIED_DATE = CURRENT_TIMESTAMP\")\n\n\ncursor.execute(\"INSERT INTO ${SNFLDWHDB}.${SNFLDWHSCH}.AUDIT_METRICS (JOB_NAME,USER_NAME,SOURCEDB_NAME,SOURCESCHEMA_NAME,DESTINATIONDB_NAME,DESTINATIONSCHEMA_NAME,ROWS_INSERTED, ROWS_UPDATED, START_DATE, END_DATE,JOB_STATUS) WITH CTE (Rows_Inserted,Rows_Updated) AS (SELECT * FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()))) select '%s' AS JOB_NAME ,CURRENT_USER() AS USER_NAME ,'${SNFLKDB}' AS SOURCEDB_NAME ,'${SNFLKSCH}' AS SOURCESCHEMA_NAME ,'${SNFLDWHDB}' AS DESTINATIONDB_NAME ,'${SNFLDWHSCH}' AS DESTINATIONSCHEMA_NAME ,CTE.Rows_Inserted AS ROWS_INSERTED ,CTE.Rows_Updated AS ROWS_UPDATED ,'%s' AS START_DATE ,CURRENT_TIMESTAMP() AS END_DATE ,'SUCCESS' AS JOB_STATUS FROM CTE\" % (job_name,Job_StartTimeStamp))\t\n\n  \n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{},"failureConnectors":{"6336633":{"id":6336633,"sourceID":6336631,"targetID":6336629}},"unconditionalConnectors":{"6336632":{"id":6336632,"sourceID":6336630,"targetID":6336631}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{},"grids":{}},"info":{"name":"jb_DW_DIM_CUSTOMER","description":"","type":"ORCHESTRATION","tag":"15e062f5-3e85-4e0f-9f8b-e956df48be47"}}