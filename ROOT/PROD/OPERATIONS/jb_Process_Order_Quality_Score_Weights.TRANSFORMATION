{"job":{"components":{"6338272":{"id":6338272,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":640,"y":320,"width":32,"height":32,"inputConnectorIDs":[6338281],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ORDER_QUALITY_METRIC_WEIGHT"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ORDER_QUALITY_METRIC_WEIGHT"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AREA_ID"},"2":{"slot":2,"type":"STRING","value":"AREA_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"AREA_NAME"},"2":{"slot":2,"type":"STRING","value":"AREA_NAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"PAYMENT_TERMS_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"PAYMENT_TERMS_WEIGHT"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"SHIFT_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"SHIFT_WEIGHT"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"SCHEDULE_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"SCHEDULE_WEIGHT"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"PAYRATE_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"PAYRATE_WEIGHT"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"GM_PERCENT_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"GM_PERCENT_WEIGHT"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ONBOARDING_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"ONBOARDING_WEIGHT"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"SAFETY_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"SAFETY_WEIGHT"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"AOA_VOLUME_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"AOA_VOLUME_WEIGHT"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"LABOR_SUPPLY_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"LABOR_SUPPLY_WEIGHT"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"PAST_DUE_PERC_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"PAST_DUE_PERC_WEIGHT"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"DAYS_BEYOND_TERMS_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"DAYS_BEYOND_TERMS_WEIGHT"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"DW_IS_ACTIVE"},"2":{"slot":2,"type":"STRING","value":"DW_IS_ACTIVE"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"DL_CREATED_DATE"},"2":{"slot":2,"type":"STRING","value":"DW_START_DATE"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"DL_CREATED_DATE"},"2":{"slot":2,"type":"STRING","value":"DL_CREATED_DATE"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"DL_CREATED_BY"},"2":{"slot":2,"type":"STRING","value":"DL_CREATED_BY"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"DL_JOBID"},"2":{"slot":2,"type":"STRING","value":"DL_JOBID"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"DW_END_DATE"},"2":{"slot":2,"type":"STRING","value":"DW_END_DATE"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_TYPE_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_TYPE_WEIGHT"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"INTERVIEW_REQUIREMENT_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"INTERVIEW_REQUIREMENT_WEIGHT"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${Sch_Enterprise}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${DB_Enterprise}"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"204":{"slot":204,"name":"Order By","elements":{},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6338273":{"id":6338273,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":0,"y":240,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[6338280],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join LDG to Area Ref and Target"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select ldg.\"RowId\"\n    ,ldg.area_id\n    ,coalesce(arb.cda_name, ldg.area_name) as area_name\n    ,ldg.payment_terms_weight\n    ,ldg.shift_weight\n    ,ldg.schedule_weight\n    ,ldg.payrate_weight\n    ,ldg.gm_percent_weight\n    ,ldg.onboarding_weight\n    ,ldg.safety_weight\n    ,ldg.aoa_volume_weight\n    ,ldg.labor_supply_weight\n    ,ldg.past_due_perc_weight\n    ,ldg.days_beyond_terms_weight\n    ,ldg.account_type_weight\n    ,ldg.interview_requirement_weight\n    ,'Y' as dw_is_active\n    ,'N' as dw_not_active\n    ,cast('9999-12-31' as datetime) as dw_end_date\n    ,case \n        when row_number()over(partition by ldg.area_id order by \"RowId\") > 1 then 'Duplicate Area ID'\n        when ldg.area_id = 'DEFAULT' then 'NA'\n        when arb.cda_areaid is null then 'Unrecognized Area ID'\n        ELSE 'NA'\n        end as error_type\nfrom ${DB_Enterprise}.${Sch_Enterprise}.ldg_order_quality_metric_weight ldg\nleft join prod_datalake.crm_mscrm.cda_areabase arb on ldg.area_id = arb.cda_areaid\norder by 1"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6338274":{"id":6338274,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":480,"y":320,"width":32,"height":32,"inputConnectorIDs":[6338284],"outputConnectorIDs":[6338281],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Insert"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ERROR_TYPE"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"NA"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6338275":{"id":6338275,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":160,"y":240,"width":32,"height":32,"inputConnectorIDs":[6338280],"outputConnectorIDs":[6338279],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add Audit Columns"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${run_history_id}"},"2":{"slot":2,"type":"STRING","value":"DL_JOBID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"DL_CREATED_DATE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()"},"2":{"slot":2,"type":"STRING","value":"DL_CREATED_BY"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6338276":{"id":6338276,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1949249710,"x":320,"y":240,"width":32,"height":32,"inputConnectorIDs":[6338279],"outputConnectorIDs":[6338283,6338284],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Replicate 0"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6338277":{"id":6338277,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":480,"y":160,"width":32,"height":32,"inputConnectorIDs":[6338283],"outputConnectorIDs":[6338282],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Error"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ERROR_TYPE"},"2":{"slot":2,"type":"STRING","value":"Not"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"NA"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6338278":{"id":6338278,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":640,"y":160,"width":32,"height":32,"inputConnectorIDs":[6338282],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Write to Exception Table"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ORDER_QUALITY_METRIC_WEIGHT_EXCEPTION"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"RowId"},"2":{"slot":2,"type":"STRING","value":"ROW_NUMBER"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"AREA_ID"},"2":{"slot":2,"type":"STRING","value":"AREA_ID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"AREA_NAME"},"2":{"slot":2,"type":"STRING","value":"AREA_NAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PAYMENT_TERMS_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"PAYMENT_TERMS_WEIGHT"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"SHIFT_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"SHIFT_WEIGHT"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"SCHEDULE_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"SCHEDULE_WEIGHT"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"PAYRATE_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"PAYRATE_WEIGHT"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"GM_PERCENT_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"GM_PERCENT_WEIGHT"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"ONBOARDING_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"ONBOARDING_WEIGHT"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"SAFETY_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"SAFETY_WEIGHT"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"AOA_VOLUME_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"AOA_VOLUME_WEIGHT"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"LABOR_SUPPLY_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"LABOR_SUPPLY_WEIGHT"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"PAST_DUE_PERC_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"PAST_DUE_PERC_WEIGHT"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"DAYS_BEYOND_TERMS_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"DAYS_BEYOND_TERMS_WEIGHT"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"ERROR_TYPE"},"2":{"slot":2,"type":"STRING","value":"ERROR_TYPE"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"DL_CREATED_DATE"},"2":{"slot":2,"type":"STRING","value":"DL_CREATED_DATE"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"DL_CREATED_BY"},"2":{"slot":2,"type":"STRING","value":"DL_CREATED_BY"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"DL_JOBID"},"2":{"slot":2,"type":"STRING","value":"DL_JOBID"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_TYPE_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_TYPE_WEIGHT"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"INTERVIEW_REQUIREMENT_WEIGHT"},"2":{"slot":2,"type":"STRING","value":"INTERVIEW_REQUIREMENT_WEIGHT"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${Sch_Enterprise}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${DB_Enterprise}"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"204":{"slot":204,"name":"Order By","elements":{},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"6338279":{"id":6338279,"sourceID":6338275,"targetID":6338276},"6338280":{"id":6338280,"sourceID":6338273,"targetID":6338275},"6338281":{"id":6338281,"sourceID":6338274,"targetID":6338272},"6338282":{"id":6338282,"sourceID":6338277,"targetID":6338278},"6338283":{"id":6338283,"sourceID":6338276,"targetID":6338277},"6338284":{"id":6338284,"sourceID":6338276,"targetID":6338274}},"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"jb_Process_Order_Quality_Score_Weights","description":"","type":"TRANSFORMATION","tag":"5a979fa7-cc72-4ec7-b5cc-fdb81792f05f"}}