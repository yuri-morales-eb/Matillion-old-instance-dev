{"job":{"components":{"6332628":{"id":6332628,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-608,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6332633],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332629":{"id":6332629,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-368,"y":0,"width":32,"height":32,"inputConnectorIDs":[6332633],"outputSuccessConnectorIDs":[6332632],"outputFailureConnectorIDs":[6332634],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Status","mapTo":"audit_status"},"2":{"slot":2,"fromId":null,"fromName":"Component","mapTo":"audit_component"},"3":{"slot":3,"fromId":null,"fromName":"Started At","mapTo":"audit_started"},"4":{"slot":4,"fromId":null,"fromName":"Duration","mapTo":"audit_duration"},"5":{"slot":5,"fromId":null,"fromName":"Completed At","mapTo":"audit_completed"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"REPORT_MEASURES"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\ncursor = context.cursor()\ncursor.execute(\"DELETE FROM ${SNFLKDB}.${SNFLKSCH}.REPORT_MEASURES_TEMP\")\ncursor.execute(\"INSERT INTO ${SNFLKDB}.${SNFLKSCH}.REPORT_MEASURES_TEMP ( ACCT_UNIT_TXT ,ACTIVITY ,NORM_POSTING_DT ,NORM_TRAN_DT ,FICA ,FUTA ,SUI ,OTHER ,GLI_EPLI ,ACA ,WORK_COMP ,ACCT_CAT_COUNT ) SELECT DISTINCT A.ACCT_UNIT_TXT ,A.ACTIVITY ,A.NORM_POSTING_DT ,A.NORM_TRAN_DT ,SUM(FICA) AS FICA ,SUM(FUTA) AS FUTA ,SUM(SUI) AS SUI ,SUM(OTHER) AS OTHER ,SUM(GLI_EPLI) AS GLI_EPLI ,SUM(ACA) AS ACA ,SUM(WORK_COMP) AS WORK_COMP ,COUNT(A.ACCT_CAT_CD) AS ACCT_CAT_COUNT FROM  (SELECT A.ACCT_UNIT_TXT ,A.ACTIVITY ,DATEADD(DAY, (7 - DATE_PART(DW, A.POSTING_DT)) % 7, A.POSTING_DT) AS NORM_POSTING_DT ,DATEADD(DAY, (7 - DATE_PART(DW, A.TRAN_DT)) % 7, A.TRAN_DT) AS NORM_TRAN_DT ,ACCT_CAT_CD ,COALESCE(CASE WHEN A.ACCOUNT_NM IN (5310) THEN (A.TRAN_AMT) END,0) AS FICA ,COALESCE(CASE WHEN A.ACCOUNT_NM IN (5320) THEN (A.TRAN_AMT) END,0)  AS FUTA ,COALESCE(CASE WHEN A.ACCOUNT_NM IN (5330) THEN (A.TRAN_AMT) END,0) AS SUI ,COALESCE(CASE WHEN ((A.ACCOUNT_NM IN (5400) AND A.ACCT_CAT_CD = 'XWHC')   \tOR (A.ACCOUNT_NM IN (5900) AND A.UNITS_AMOUNT = 0) \tOR (A.ACCOUNT_NM IN (5500,5501,5510,5530,5910))) \tTHEN  (A.TRAN_AMT) END ,0) AS OTHER ,COALESCE(CASE WHEN A.ACCOUNT_NM IN (6811,6812) THEN (A.TRAN_AMT) END,0) AS GLI_EPLI ,COALESCE(CASE WHEN A.ACCOUNT_NM IN (5800) THEN (A.TRAN_AMT) END,0) AS ACA ,COALESCE(CASE WHEN A.ACCOUNT_NM IN (5400,5410) THEN (A.TRAN_AMT) END,0) AS WORK_COMP  FROM ${SNFLKDB}.${SNFLKSCH}.DIM_TRANS A WHERE A.ACTIVE_STATUS='Y'  )A  GROUP BY A.ACCT_UNIT_TXT, A.ACTIVITY, A.NORM_POSTING_DT, A.NORM_TRAN_DT\")\ncursor.execute(\"DELETE FROM ${SNFLKDB}.${SNFLKSCH}.REPORT_MEASURES_PAY_TEMP\")\ncursor.execute(\"INSERT INTO ${SNFLKDB}.${SNFLKSCH}.REPORT_MEASURES_PAY_TEMP ( ACCT_UNIT_TXT ,ACTIVITY ,NORM_POSTING_DT ,NORM_TRAN_DT ,TOTAL_PAY_HRS2 ,TOTAL_PAY_HRS3 ,TOTAL_PAY_HRS3_ABS ,TOTAL_BILLABLE_UNIT ,TOTAL_BILLABLE_UNIT_ABS ) SELECT DISTINCT A.ACCT_UNIT_TXT ,A.ACTIVITY ,A.NORM_POSTING_DT ,A.NORM_TRAN_DT ,SUM(A.PAY_HRS) AS TOTAL_PAY_HRS2 ,SUM(A.UNITS_AMOUNT) AS TOTAL_PAY_HRS3 ,SUM(A.UNITS_AMOUNT_ABS) AS TOTAL_PAY_HRS3_ABS  ,SUM(A.BILLABLE_UNIT) AS TOTAL_BILLABLE_UNIT ,SUM(A.BILLABLE_UNIT_ABS) AS TOTAL_BILLABLE_UNIT_ABS  FROM  (SELECT DISTINCT A.ACCT_UNIT_TXT ,A.ACTIVITY ,DATEADD(DAY, (7 - DATE_PART(DW, A.POSTING_DT)) % 7, A.POSTING_DT) AS NORM_POSTING_DT ,DATEADD(DAY, (7 - DATE_PART(DW, A.TRAN_DT)) % 7, A.TRAN_DT) AS NORM_TRAN_DT ,CASE  \tWHEN A.ACCOUNT_NM IN (4100, 4200, 4600, 4900, 2660, 4800, 4750, 4950, 4525, 4700)  \t\tTHEN REPLACE(CONCAT(REPLACE(LEFT(A.ACCT_CAT_CD,1),'4','5'),RIGHT(RTRIM(A.ACCT_CAT_CD),LENGTH(RTRIM(A.ACCT_CAT_CD))-1)),'0','') \tELSE REPLACE(A.ACCT_CAT_CD,'0','') END AS ACCT_CATEGORY2 ,PR.HOURS AS PAY_HRS ,A.UNITS_AMOUNT AS UNITS_AMOUNT ,ABS(A.UNITS_AMOUNT) AS UNITS_AMOUNT_ABS ,A.BILLABLE_UNIT AS BILLABLE_UNIT ,ABS(A.BILLABLE_UNIT) AS BILLABLE_UNIT_ABS FROM ${SNFLKDB}.${SNFLKSCH}.DIM_TRANS A LEFT JOIN ${SNFLKDB}.${SNFLKSCH}.DIM_PAYRATE_TRANS PR ON A.SRC_OBJ_ID=PR.ATN_OBJ_ID AND PR.ACTIVE_STATUS='Y'  WHERE A.ACTIVE_STATUS='Y'  AND  ACCT_CATEGORY2 IN ( SELECT PP.PAY_CODE  FROM ${SNFLKDB}.${SNFLKSCH}.DIM_PAY_CODE PP WHERE PP.NON_EARNINGS = 0) )A GROUP BY A.ACCT_UNIT_TXT, A.ACTIVITY, A.NORM_POSTING_DT, A.NORM_TRAN_DT\")\ncursor.execute(\"DELETE FROM ${SNFLKDB}.${SNFLKSCH}.CALC_TRANAMOUNT_TEMP\")\ncursor.execute(\"INSERT INTO ${SNFLKDB}.${SNFLKSCH}.CALC_TRANAMOUNT_TEMP ( ACCT_UNIT_TXT ,ACTIVITY ,NORM_POSTING_DT ,NORM_TRAN_DT ,ACCT_CAT_CD ,TRAN_AMT ,TOTAL_TRAN_AMOUNT ,TOTAL_BILLABLE_AMOUNT ,TOTAL_TRAN_AMOUNT_PERCENT ,TOT_UNITS_AMOUNT ,TOTAL_PAY_HRS ,TOTAL_PAY_HRS_ABS )  SELECT DISTINCT A.ACCT_UNIT_TXT ,A.ACTIVITY ,A.NORM_POSTING_DT ,A.NORM_TRAN_DT ,RDIM.ACCT_CAT_CD ,MAX(RDIM.TRAN_AMT) AS TRAN_AMT ,SUM(A.TOTAL_TRAN_AMOUNT) AS TOTAL_TRAN_AMOUNT ,MAX(RDIM.BILLABLE_AMT) AS TOTAL_BILLABLE_AMOUNT ,MAX(RDIM.TRAN_AMT) /NULLIF(SUM(A.TOTAL_TRAN_AMOUNT),0)  AS TOTAL_TRAN_AMOUNT_PERCENT ,MAX(RDIM.UNITS_AMOUNT) AS TOT_UNITS_AMOUNT ,SUM(PRC.TOTAL_PAY_HRS3) AS TOTAL_PAY_HRS ,CASE WHEN SUM(RDIM.UNITS_AMOUNT) = 0 THEN 0 ELSE SUM(PRC.TOTAL_PAY_HRS3_ABS) END AS  TOTAL_PAY_HRS_ABS   FROM    (   SELECT   A.ACCT_UNIT_TXT ,A.ACTIVITY ,A.ACCT_CATEGORY2 ,NORM_POSTING_DT ,DATEADD(DAY, (7 - DATE_PART(DW, A.TRAN_DT)) % 7, A.TRAN_DT) AS NORM_TRAN_DT  ,SUM(CASE WHEN A.BILLABLE_AMT=0 THEN A.TRAN_AMT ELSE 0 END ) AS TOTAL_TRAN_AMOUNT ,SUM(A.BILLABLE_AMT) AS TOTAL_BILLABLE_AMOUNT FROM ${SNFLKDB}.${SNFLKSCH}.REPORT_DIMENSIONS_TEMP A  WHERE A.ACCT_CATEGORY2 IN (SELECT PP.PAY_CODE FROM ${SNFLKDB}.${SNFLKSCH}.DIM_PAY_CODE PP WHERE PP.NON_EARNINGS = 0)  GROUP BY A.ACCT_UNIT_TXT,A.ACTIVITY, A.NORM_POSTING_DT, DATEADD(DAY, (7 - DATE_PART(DW, A.TRAN_DT)) % 7, A.TRAN_DT) , A.ACCT_CATEGORY2 ) A  JOIN ${SNFLKDB}.${SNFLKSCH}.REPORT_DIMENSIONS_TEMP RDIM ON RDIM.ACCT_UNIT_TXT=A.ACCT_UNIT_TXT AND RDIM.ACTIVITY=A.ACTIVITY AND RDIM.NORM_POSTING_DT=A.NORM_POSTING_DT AND DATEADD(DAY, (7 - DATE_PART(DW,RDIM.TRAN_DT)) % 7, RDIM.TRAN_DT)=A.NORM_TRAN_DT  LEFT JOIN ${SNFLKDB}.${SNFLKSCH}.REPORT_MEASURES_PAY_TEMP PRC ON PRC.ACCT_UNIT_TXT=A.ACCT_UNIT_TXT AND PRC.ACTIVITY=A.ACTIVITY AND PRC.NORM_POSTING_DT=A.NORM_POSTING_DT AND PRC.NORM_TRAN_DT=A.NORM_TRAN_DT  WHERE RDIM.ACCT_CAT_CD IN (SELECT PP.PAY_CODE FROM ${SNFLKDB}.${SNFLKSCH}.DIM_PAY_CODE PP WHERE PP.NON_EARNINGS = 0)  GROUP BY A.ACCT_UNIT_TXT,A.ACTIVITY, A.NORM_POSTING_DT, A.NORM_TRAN_DT,RDIM.ACCT_CAT_CD\")\ncursor.execute(\"DELETE FROM ${SNFLKDB}.${SNFLKSCH}.TRANS_TEMP\")\ncursor.execute(\"INSERT INTO ${SNFLKDB}.${SNFLKSCH}.TRANS_TEMP SELECT A.SRC_OBJ_ID AS OBJ_ID, A.ACCT_UNIT_TXT AS ACCT_UNIT,  A.ACTIVITY, A.POSTING_DT AS POSTING_DATE,  DATEADD(DAY, (7 - DATE_PART(DW, A.POSTING_DT)) % 7, A.POSTING_DT) AS NORM_POSTING_DATE, A.TRAN_DT,  DATEADD(DAY, (7 - DATE_PART(DW, A.TRAN_DT)) % 7, A.TRAN_DT) AS NORM_TRAN_DATE, A.ACCT_CAT_CD,  CASE  \tWHEN A.ACCOUNT_NM IN (4100, 4200, 4600, 4900, 2660, 4800, 4750, 4950, 4525, 4700)  \t\tTHEN REPLACE(CONCAT(REPLACE(LEFT(A.ACCT_CAT_CD,1),'4','5'),RIGHT(RTRIM(A.ACCT_CAT_CD),LENGTH(RTRIM(A.ACCT_CAT_CD))-1)),'0','') \tELSE REPLACE(A.ACCT_CAT_CD,'0','') END AS ACCT_CATEGORY2, A.ACCOUNT_NM, A.BILLABLE_UNIT, CASE \tWHEN A.ACCOUNT_NM IN (4100, 4200, 4600, 4900, 2660, 4800, 4750, 4950, 4525, 4700) THEN -1*A.TRAN_AMT \tELSE 0 END AS BILLABLE_AMT, A.UNITS_AMOUNT AS UNITS_AMOUNT, A.TRAN_AMT AS TRAN_AMOUNT, PR.JOB_CODE AS WC_CODE, PR.HOURS AS PAY_HRS, PR.WORK_STATE,  PR.PAY_RATE AS PAY_RATE, INV.INVOICE_NUM FROM ${SNFLKDB}.${SNFLKSCH}.DIM_TRANS A LEFT JOIN ${SNFLKDB}.${SNFLKSCH}.DIM_PAYRATE_TRANS PR ON PR.ATN_OBJ_ID=A.SRC_OBJ_ID AND PR.ACTIVE_STATUS='Y' LEFT JOIN ${SNFLKDB}.${SNFLKSCH}.DIM_INVOICE INV ON A.SRC_OBJ_ID=INV.SRC_OBJ_ID AND INV.ACTIVE_STATUS='Y' WHERE A.ACTIVE_STATUS='Y' \")\ncursor.execute(\"DELETE FROM ${SNFLKDB}.${SNFLKSCH}.ACT_TRAN_AMT_TOTAL\")\ncursor.execute(\"INSERT INTO ${SNFLKDB}.${SNFLKSCH}.ACT_TRAN_AMT_TOTAL   SELECT  \tA.ACCT_UNIT, \tA.ACTIVITY,   \tA.ACCT_CATEGORY2, \tA.NORM_POSTING_DATE, \tA.NORM_TRAN_DATE, SUM(CASE WHEN A.BILLABLE_AMT=0 THEN A.TRAN_AMOUNT ELSE 0 END ) AS TOTAL_TRAN_AMOUNT, SUM(A.BILLABLE_AMT) AS TOTAL_BILLABLE_AMOUNT FROM ${SNFLKDB}.${SNFLKSCH}.TRANS_TEMP A WHERE A.ACCT_CATEGORY2 IN (SELECT PP.PAY_CODE FROM ${SNFLKDB}.${SNFLKSCH}.DIM_PAY_CODE PP WHERE PP.NON_EARNINGS = 0)  GROUP BY A.ACCT_UNIT,A.ACTIVITY, A.NORM_POSTING_DATE, A.NORM_TRAN_DATE, A.ACCT_CATEGORY2\")\ncursor.execute(\"DELETE FROM ${SNFLKDB}.${SNFLKSCH}.PREP_CALC_TRANAMOUNT\")\ncursor.execute(\"INSERT INTO ${SNFLKDB}.${SNFLKSCH}.PREP_CALC_TRANAMOUNT SELECT  A.ACCT_UNIT, A.ACTIVITY,  A.ACCT_CATEGORY, A.NORM_POSTING_DATE,  A.NORM_TRAN_DATE, SUM(A.TRAN_AMOUNT) AS TRAN_AMOUNT, (SELECT SUM(TAT.TOTAL_TRAN_AMOUNT) \tFROM ${SNFLKDB}.${SNFLKSCH}.ACT_TRAN_AMT_TOTAL TAT \tWHERE A.ACCT_UNIT = TAT.ACCT_UNIT  \tAND A.ACTIVITY = TAT.ACTIVITY  \tAND TAT.NORM_POSTING_DATE = A.NORM_POSTING_DATE \tAND TAT.NORM_TRAN_DATE = A.NORM_TRAN_DATE) AS TOTAL_TRAN_AMOUNT ,    0 AS TOTAL_TRAN_AMOUNT_PERCENT FROM   ${SNFLKDB}.${SNFLKSCH}.TRANS_TEMP A   WHERE  A.ACCT_CATEGORY  IN (SELECT PP.PAY_CODE FROM ${SNFLKDB}.${SNFLKSCH}.DIM_PAY_CODE PP WHERE PP.NON_EARNINGS = 0)    GROUP BY A.ACCT_UNIT,A.ACTIVITY, A.NORM_POSTING_DATE, A.NORM_TRAN_DATE,A.ACCT_CATEGORY\")\ncursor.execute(\"UPDATE ${SNFLKDB}.${SNFLKSCH}.PREP_CALC_TRANAMOUNT T   SET TOTAL_TRAN_AMOUNT_PERCENT= S.TRAN_AMOUNT / NULLIF((S.TOTAL_TRAN_AMOUNT),0)   FROM (SELECT * FROM ${SNFLKDB}.${SNFLKSCH}.PREP_CALC_TRANAMOUNT )S   WHERE T.ACCT_UNIT = S.ACCT_UNIT   \tAND T.ACTIVITY = S.ACTIVITY   \tAND T.NORM_POSTING_DATE = S.NORM_POSTING_DATE  \tAND T.NORM_TRAN_DATE = S.NORM_TRAN_DATE      AND T.ACCT_CATEGORY=S.ACCT_CATEGORY\")\ncursor.execute(\"DELETE FROM ${SNFLKDB}.${SNFLKSCH}.HOURS_PREP\")\ncursor.execute(\"INSERT INTO ${SNFLKDB}.${SNFLKSCH}.HOURS_PREP SELECT  S1.ACCT_UNIT, S1.ACTIVITY,  S1.NORM_POSTING_DATE,  S1.NORM_TRAN_DATE, S1.ACCT_CATEGORY, SUM(S1.UNITS_AMOUNT) AS TOT_UNITS_AMOUNT, SUM(PHT.TOTAL_PAY_HRS3) AS TOTAL_PAY_HRS, CASE WHEN SUM(S1.UNITS_AMOUNT) = 0 THEN 0 \t ELSE SUM(PHT.TOTAL_PAY_HRS3_ABS) END AS TOTAL_PAY_HRS_ABS  FROM ${SNFLKDB}.${SNFLKSCH}.TRANS_TEMP S1 INNER JOIN ${SNFLKDB}.${SNFLKSCH}.REPORT_MEASURES_PAY_TEMP PHT ON S1.ACCT_UNIT = PHT.ACCT_UNIT_TXT \tAND S1.ACTIVITY = PHT.ACTIVITY  \tAND S1.NORM_POSTING_DATE = PHT.NORM_POSTING_DT \tAND S1.NORM_TRAN_DATE = PHT.NORM_TRAN_DT     WHERE S1.ACCT_CATEGORY IN (SELECT PP.PAY_CODE FROM ${SNFLKDB}.${SNFLKSCH}.DIM_PAY_CODE PP WHERE PP.NON_EARNINGS = 0) GROUP BY S1.NORM_POSTING_DATE, S1.NORM_TRAN_DATE, S1.ACCT_UNIT,S1.ACTIVITY, S1.ACCT_CATEGORY\")\ncursor.execute(\"DELETE FROM ${SNFLKDB}.${SNFLKSCH}.ACCT_CAT_COUNT\")\ncursor.execute(\"INSERT INTO ${SNFLKDB}.${SNFLKSCH}.ACCT_CAT_COUNT SELECT HP.ACCT_UNIT, HP.ACTIVITY,  HP.NORM_POSTING_DATE,  HP.NORM_TRAN_DATE, COUNT(HP.ACCT_CATEGORY) AS ACCT_CAT_COUNT FROM ${SNFLKDB}.${SNFLKSCH}.HOURS_PREP HP GROUP BY HP.NORM_POSTING_DATE, HP.NORM_TRAN_DATE, HP.ACCT_UNIT,HP.ACTIVITY\")\ncursor.execute(\"DELETE FROM ${SNFLKDB}.${SNFLKSCH}.CALC_WORKCOMPAC\")\ncursor.execute(\"INSERT INTO ${SNFLKDB}.${SNFLKSCH}.CALC_WORKCOMPAC SELECT  CWC.ACCT_UNIT_TXT, CWC.ACTIVITY, CWC.NORM_POSTING_DT, CWC.NORM_TRAN_DT, CWC.WORK_COMP, ACC.ACCT_CAT_COUNT FROM ${SNFLKDB}.${SNFLKSCH}.REPORT_MEASURES_TEMP CWC LEFT JOIN ${SNFLKDB}.${SNFLKSCH}.ACCT_CAT_COUNT ACC ON CWC.ACTIVITY = ACC.ACTIVITY   AND CWC.ACCT_UNIT_TXT = ACC.ACCT_UNIT  AND CWC.NORM_TRAN_DT = ACC.NORM_TRAN_DATE AND CWC.NORM_POSTING_DT = ACC.NORM_POSTING_DATE\")\ncursor.execute(\"DELETE FROM ${SNFLKDB}.${SNFLKSCH}.PAY_TRAN_MEASURES_TEMP\")\ncursor.execute(\"INSERT INTO ${SNFLKDB}.${SNFLKSCH}.PAY_TRAN_MEASURES_TEMP (ACCT_UNIT_TXT, ACTIVITY, NORM_POSTING_DT, NORM_TRAN_DT, ACCT_CAT_CD, TRAN_AMOUNT, TOTAL_TRAN_AMOUNT, TOTAL_TRAN_AMOUNT_PERCENT, TOTAL_PAY_HRS, TOTAL_PAY_HRS_PERCENT, FICA, FUTA, SUI, WORK_COMP, OTHER, GLI_EPLI, ACA, FICA1, FUTA1, SUI1, OTHER1, GLI_EPLI1, ACA1, WORK_COMP1) SELECT DISTINCT COALESCE(TA.ACCT_UNIT_TXT, RM.ACCT_UNIT_TXT, RMP.ACCT_UNIT_TXT, WC.ACCT_UNIT) AS ACCT_UNIT,  COALESCE(TA.ACTIVITY, RM.ACTIVITY, RMP.ACTIVITY, WC.ACTIVITY) AS ACTIVITY,  COALESCE(TA.NORM_POSTING_DT, RM.NORM_POSTING_DT, RMP.NORM_POSTING_DT, WC.NORM_POSTING_DATE) AS NORM_POSTING_DT,  COALESCE(TA.NORM_TRAN_DT, RM.NORM_TRAN_DT, RMP.NORM_TRAN_DT, WC.NORM_TRAN_DATE) AS NORM_TRAN_DT,  TA.ACCT_CAT_CD,  TA.TRAN_AMT,  TA.TOTAL_TRAN_AMOUNT,  TA.TOTAL_TRAN_AMOUNT_PERCENT,  HP.TOTAL_PAY_HRS,  CASE  WHEN RMP.TOTAL_PAY_HRS3 = 0   AND HP.TOTAL_PAY_HRS_ABS = 0   AND RMP.TOTAL_BILLABLE_UNIT = 0   AND RMP.TOTAL_BILLABLE_UNIT_ABS = 0   AND WC.ACCT_CAT_COUNT >= 1 THEN 1/CAST(WC.ACCT_CAT_COUNT AS NUMBER(18, 2))  WHEN RMP.TOTAL_PAY_HRS3 = 0   AND HP.TOTAL_PAY_HRS_ABS = 0   AND RMP.TOTAL_BILLABLE_UNIT = 0   AND RMP.TOTAL_BILLABLE_UNIT_ABS = 0   AND (WC.ACCT_CAT_COUNT IS NULL    OR WC.ACCT_CAT_COUNT < 1) THEN 0  WHEN RMP.TOTAL_PAY_HRS3 = 0   AND HP.TOTAL_PAY_HRS_ABS = 0   AND RMP.TOTAL_BILLABLE_UNIT = 0   AND RMP.TOTAL_BILLABLE_UNIT_ABS <> 0   AND WC.ACCT_CAT_COUNT <= 1 THEN 1  WHEN RMP.TOTAL_PAY_HRS3 = 0   AND HP.TOTAL_PAY_HRS_ABS = 0   AND RMP.TOTAL_BILLABLE_UNIT = 0   AND RMP.TOTAL_BILLABLE_UNIT_ABS <> 0   AND WC.ACCT_CAT_COUNT > 1 THEN 1/CAST(WC.ACCT_CAT_COUNT AS NUMBER(18, 2))  WHEN RMP.TOTAL_PAY_HRS3 = 0   AND HP.TOTAL_PAY_HRS_ABS = 0   AND RMP.TOTAL_BILLABLE_UNIT <> 0   AND RMP.TOTAL_BILLABLE_UNIT_ABS <> 0   AND WC.ACCT_CAT_COUNT >= 1 THEN 1/CAST(WC.ACCT_CAT_COUNT AS NUMBER(18, 2))  WHEN RMP.TOTAL_PAY_HRS3 = 0   AND HP.TOTAL_PAY_HRS_ABS <> 0 THEN ABS(HP.TOT_UNITS_AMOUNT)/HP.TOTAL_PAY_HRS_ABS  WHEN RMP.TOTAL_PAY_HRS3 = 0 THEN 0  ELSE HP.TOT_UNITS_AMOUNT / RMP.TOTAL_PAY_HRS3  END AS TOTAL_PAY_HRS_PERCENT,  CASE  WHEN RM.FICA IS NOT NULL THEN RM.FICA * COALESCE(PREP.TOTAL_TRAN_AMOUNT_PERCENT, 1)  ELSE 0.00  END AS FICA,  CASE  WHEN RM.FUTA IS NOT NULL THEN RM.FUTA * COALESCE(PREP.TOTAL_TRAN_AMOUNT_PERCENT, 1)  ELSE 0.00  END AS FUTA,  CASE  WHEN RM.SUI IS NOT NULL THEN RM.SUI * COALESCE(PREP.TOTAL_TRAN_AMOUNT_PERCENT, 1)  ELSE 0.00  END AS SUI,  WC.WORK_COMP AS WORK_COMP,  CASE  WHEN RM.OTHER IS NOT NULL THEN RM.OTHER * COALESCE(PREP.TOTAL_TRAN_AMOUNT_PERCENT, 1)  ELSE 0.00  END AS OTHER,  CASE  WHEN RM.GLI_EPLI IS NOT NULL THEN RM.GLI_EPLI * COALESCE(PREP.TOTAL_TRAN_AMOUNT_PERCENT, 1)  ELSE 0.00  END AS GLI_EPLI,  CASE  WHEN RM.ACA IS NOT NULL THEN RM.ACA * COALESCE(PREP.TOTAL_TRAN_AMOUNT_PERCENT, 1)  ELSE 0.00  END AS ACA,  RM.FICA AS FICA1,  RM.FUTA AS FUTA1,  RM.SUI AS SUI1,  COALESCE(RM.OTHER, 0) AS OTHER1,  COALESCE(RM.GLI_EPLI, 0) AS GLI_EPLI1,  COALESCE(RM.ACA, 0) AS ACA1,  WC.WORK_COMP AS WORK_COMP1 FROM ${SNFLKDB}.${SNFLKSCH}.CALC_TRANAMOUNT_TEMP TA JOIN ${SNFLKDB}.${SNFLKSCH}.HOURS_PREP HP ON TA.ACCT_UNIT_TXT = HP.ACCT_UNIT   AND TA.ACTIVITY = HP.ACTIVITY   AND TA.NORM_POSTING_DT = HP.NORM_POSTING_DATE   AND TA.NORM_TRAN_DT = HP.NORM_TRAN_DATE   AND TA.ACCT_CAT_CD=HP.ACCT_CATEGORY LEFT JOIN ${SNFLKDB}.${SNFLKSCH}.PREP_CALC_TRANAMOUNT PREP ON TA.ACCT_UNIT_TXT = PREP.ACCT_UNIT   AND TA.ACTIVITY = PREP.ACTIVITY   AND TA.NORM_POSTING_DT = PREP.NORM_POSTING_DATE   AND TA.NORM_TRAN_DT = PREP.NORM_TRAN_DATE   AND TA.ACCT_CAT_CD=PREP.ACCT_CATEGORY FULL JOIN ${SNFLKDB}.${SNFLKSCH}.REPORT_MEASURES_TEMP RM ON TA.ACCT_UNIT_TXT = RM.ACCT_UNIT_TXT   AND TA.ACTIVITY = RM.ACTIVITY   AND TA.NORM_POSTING_DT = RM.NORM_POSTING_DT   AND TA.NORM_TRAN_DT = RM.NORM_TRAN_DT FULL JOIN ${SNFLKDB}.${SNFLKSCH}.REPORT_MEASURES_PAY_TEMP RMP ON TA.ACCT_UNIT_TXT = RMP.ACCT_UNIT_TXT   AND TA.ACTIVITY = RMP.ACTIVITY   AND TA.NORM_POSTING_DT = RMP.NORM_POSTING_DT   AND TA.NORM_TRAN_DT = RMP.NORM_TRAN_DT FULL JOIN ${SNFLKDB}.${SNFLKSCH}.CALC_WORKCOMPAC WC ON TA.ACCT_UNIT_TXT = WC.ACCT_UNIT   AND TA.ACTIVITY = WC.ACTIVITY   AND TA.NORM_POSTING_DT = WC.NORM_POSTING_DATE   AND TA.NORM_TRAN_DT = WC.NORM_TRAN_DATE\")\nresult = cursor.fetchone()\ncontext.updateVariable(\"audit_rowcount\", int(result[0]))"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332630":{"id":6332630,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-192,"y":48,"width":32,"height":32,"inputConnectorIDs":[6332634],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_REPORT_MEASURES_FAILURE"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_REPORT_MEASURES"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332631":{"id":6332631,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-208,"y":-64,"width":32,"height":32,"inputConnectorIDs":[6332632],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_REPORT_MEASURES_SUCCESS"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_REPORT_MEASURES"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"6332632":{"id":6332632,"sourceID":6332629,"targetID":6332631}},"failureConnectors":{"6332634":{"id":6332634,"sourceID":6332629,"targetID":6332630}},"unconditionalConnectors":{"6332633":{"id":6332633,"sourceID":6332628,"targetID":6332629}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{},"grids":{}},"info":{"name":"jb_REPORT_MEASURES","description":"","type":"ORCHESTRATION","tag":"211f9ac3-e2d6-4a7a-910c-c75f125e2add"}}