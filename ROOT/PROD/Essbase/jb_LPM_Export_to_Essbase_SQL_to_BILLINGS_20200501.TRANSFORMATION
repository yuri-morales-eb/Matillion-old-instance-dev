{"job":{"components":{"6339136":{"id":6339136,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":16,"y":400,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[6339143],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Billing OUT Query"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select last_day(payment_date,'WEEK') AS payment_dt_sunday\n    , v.customer_id as CUSTOMER\n    , round(sum(v.pay_amount),2) as GROSS_PROFIT\nfrom  ${DB_Enterprise}.${SNFLFINSCH}.vw_lpm_export v\ngroup by 1,2\norder by payment_dt_sunday"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6339137":{"id":6339137,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":416,"y":320,"width":32,"height":32,"inputConnectorIDs":[6339144],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BILLING_IN"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BILLING_IN"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CREATED_AT_SUNDAY"},"2":{"slot":2,"type":"STRING","value":"CREATED_AT_SUNDAY"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOMER"},"2":{"slot":2,"type":"STRING","value":"CUSTOMER"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"GROSS_PROFIT"},"2":{"slot":2,"type":"STRING","value":"GROSS_PROFIT"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SNFLFINSCH}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${DB_Enterprise}"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"204":{"slot":204,"name":"Order By","elements":{},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6339138":{"id":6339138,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":16,"y":480,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[6339142],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Billing NET Query"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select \nta.created_at_sunday,\ntb.payment_dt_sunday,\nta.customer,\nta.gross_profit as \"IN\",\ntb.gross_profit as \"OUT\",\n  (SUM(ta.gross_profit) OVER (PARTITION BY ta.customer ORDER BY ta.created_at_sunday ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)\n  -  SUM(tb.gross_profit) OVER (PARTITION BY tb.customer ORDER BY tb.payment_dt_sunday ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW))AS \"NET\"\nfrom  ${DB_Enterprise}.${SNFLFINSCH}.billing_in as ta\nleft join ${DB_Enterprise}.${SNFLFINSCH}.billing_out as tb\non ta.created_at_sunday = tb.payment_dt_sunday\nand ta.customer = tb.customer\nwhere ta.gross_profit <> tb.gross_profit\norder by 2,1"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6339139":{"id":6339139,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":416,"y":400,"width":32,"height":32,"inputConnectorIDs":[6339143],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BILLING_OUT"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BILLING_OUT"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PAYMENT_DT_SUNDAY"},"2":{"slot":2,"type":"STRING","value":"PAYMENT_DT_SUNDAY"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOMER"},"2":{"slot":2,"type":"STRING","value":"CUSTOMER"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"GROSS_PROFIT"},"2":{"slot":2,"type":"STRING","value":"GROSS_PROFIT"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SNFLFINSCH}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${DB_Enterprise}"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"204":{"slot":204,"name":"Order By","elements":{},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6339140":{"id":6339140,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":14,"y":325,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[6339144],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Billing IN Query"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select \nto_date(last_day(v.created_at,'WEEK')) AS CREATED_AT_SUNDAY\n    , v.customer_id as CUSTOMER\n    , round(sum(v.pay_amount),2) as GROSS_PROFIT\nfrom  ${DB_Enterprise}.${SNFLFINSCH}.vw_lpm_export v\ngroup by 1,2\norder by created_at_sunday\n\n\n"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6339141":{"id":6339141,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":416,"y":480,"width":32,"height":32,"inputConnectorIDs":[6339142],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BILLING_NET"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BILLING_NET"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CREATED_AT_SUNDAY"},"2":{"slot":2,"type":"STRING","value":"CREATED_AT_SUNDAY"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"PAYMENT_DT_SUNDAY"},"2":{"slot":2,"type":"STRING","value":"PAYMENT_DT_SUNDAY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOMER"},"2":{"slot":2,"type":"STRING","value":"CUSTOMER"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"IN"},"2":{"slot":2,"type":"STRING","value":"IN"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"OUT"},"2":{"slot":2,"type":"STRING","value":"OUT"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"NET"},"2":{"slot":2,"type":"STRING","value":"NET"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SNFLFINSCH}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${DB_Enterprise}"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"204":{"slot":204,"name":"Order By","elements":{},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"6339142":{"id":6339142,"sourceID":6339138,"targetID":6339141},"6339143":{"id":6339143,"sourceID":6339136,"targetID":6339139},"6339144":{"id":6339144,"sourceID":6339140,"targetID":6339137}},"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"jb_LPM_Export_to_Essbase_SQL_to_BILLINGS_20200501","description":"","type":"TRANSFORMATION","tag":"abfcea5f-0fe2-4b3e-8f9a-597e2a852348"}}