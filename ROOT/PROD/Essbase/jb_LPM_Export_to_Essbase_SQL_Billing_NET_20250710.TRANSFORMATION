{"job":{"components":{"6339503":{"id":6339503,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":16,"y":480,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[6339505],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Billing NET Query"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WITH CTE_NET AS (\n  SELECT\n  \tta.customer,\n  \tta.created_at_sunday,\n  \ttb.payment_dt_sunday,\n  \tta.gross_profit as \"IN\",\n  \tCOALESCE(tb.gross_profit,0) as \"OUT\",\n  \tta.gross_profit - COALESCE(tb.gross_profit,0) as NET\n  FROM ${DB_Enterprise}.${SNFLFINSCH}.billing_in as ta\n  LEFT JOIN ${DB_Enterprise}.${SNFLFINSCH}.billing_out as tb\n  \tON ta.customer = tb.customer\n  \tAND ta.created_at_sunday = tb.payment_dt_sunday\n)\n\nSELECT\n    created_at_sunday,\n    payment_dt_sunday,\n    customer,\n    \"IN\",\n    \"OUT\",\n    SUM(NET) OVER (PARTITION BY customer ORDER BY created_at_sunday ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS NET\nFROM CTE_NET\nORDER BY created_at_sunday"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6339504":{"id":6339504,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":320,"y":480,"width":32,"height":32,"inputConnectorIDs":[6339505],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BILLING_NET"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BILLING_NET"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CREATED_AT_SUNDAY"},"2":{"slot":2,"type":"STRING","value":"CREATED_AT_SUNDAY"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"PAYMENT_DT_SUNDAY"},"2":{"slot":2,"type":"STRING","value":"PAYMENT_DT_SUNDAY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOMER"},"2":{"slot":2,"type":"STRING","value":"CUSTOMER"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"IN"},"2":{"slot":2,"type":"STRING","value":"IN"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"OUT"},"2":{"slot":2,"type":"STRING","value":"OUT"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"NET"},"2":{"slot":2,"type":"STRING","value":"NET"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SNFLFINSCH}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${DB_Enterprise}"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"204":{"slot":204,"name":"Order By","elements":{},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"6339505":{"id":6339505,"sourceID":6339503,"targetID":6339504}},"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"jb_LPM_Export_to_Essbase_SQL_Billing_NET_20250710","description":"","type":"TRANSFORMATION","tag":"c0175039-a9e7-48ba-a4ab-e2ec200987e2"}}