{"job":{"components":{"6339519":{"id":6339519,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":16,"y":480,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[6339553],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Billing NET Query"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WITH CTE_DATES AS (\n    SELECT DISTINCT created_at_sunday AS Date, customer\n    FROM ${DB_Enterprise}.${SNFLFINSCH}.billing_in\n    UNION\n    SELECT DISTINCT payment_dt_sunday AS Date, customer\n    FROM ${DB_Enterprise}.${SNFLFINSCH}.billing_out\n),\nCTE_NET AS (\n    SELECT\n        d.Date AS Billing_Date,\n        bi.created_at_sunday,\n        bo.payment_dt_sunday,\n        COALESCE(bi.customer, bo.customer) AS customer,\n        COALESCE(bi.GROSS_PROFIT, 0) AS \"IN\",\n        COALESCE(bi.GROSS_PROFIT_51, 0) AS IN_51,\n        COALESCE(bi.GROSS_PROFIT_59, 0) AS IN_59,\n        COALESCE(bi.GROSS_PROFIT_99, 0) AS IN_99,\n        COALESCE(bo.GROSS_PROFIT, 0) AS OUT,\n        COALESCE(bo.GROSS_PROFIT_51, 0) AS OUT_51,\n        COALESCE(bo.GROSS_PROFIT_59, 0) AS OUT_59,\n        COALESCE(bo.GROSS_PROFIT_99, 0) AS OUT_99,\n        COALESCE(bi.GROSS_PROFIT, 0) - COALESCE(bo.GROSS_PROFIT, 0) AS Difference,\n        COALESCE(bi.GROSS_PROFIT_51, 0) - COALESCE(bo.GROSS_PROFIT_51, 0) AS Difference_51,\n        COALESCE(bi.GROSS_PROFIT_59, 0) - COALESCE(bo.GROSS_PROFIT_59, 0) AS Difference_59,\n        COALESCE(bi.GROSS_PROFIT_99, 0) - COALESCE(bo.GROSS_PROFIT_99, 0) AS Difference_99\n    FROM CTE_DATES d\n    LEFT JOIN ${DB_Enterprise}.${SNFLFINSCH}.billing_in bi\n        ON d.Date = bi.CREATED_AT_SUNDAY AND d.customer = bi.CUSTOMER\n    LEFT JOIN ${DB_Enterprise}.${SNFLFINSCH}.billing_out bo\n        ON d.Date = bo.payment_dt_sunday AND d.customer = bo.CUSTOMER\n)\n\nSELECT\n    created_at_sunday,\n    payment_dt_sunday,\n    customer,\n    \"IN\",\n    IN_51,\n    IN_59,\n    IN_99,\n    OUT,\n    OUT_51,\n    OUT_59,\n    OUT_99,\n    Difference AS NET,\n    Difference_51 AS NET_51,\n    Difference_59 AS NET_59,\n    Difference_99 AS NET_99\nFROM CTE_NET\nORDER BY Billing_Date"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6339552":{"id":6339552,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":320,"y":480,"width":32,"height":32,"inputConnectorIDs":[6339553],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BILLING_NET"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BILLING_NET"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CREATED_AT_SUNDAY"},"2":{"slot":2,"type":"STRING","value":"CREATED_AT_SUNDAY"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"PAYMENT_DT_SUNDAY"},"2":{"slot":2,"type":"STRING","value":"PAYMENT_DT_SUNDAY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOMER"},"2":{"slot":2,"type":"STRING","value":"CUSTOMER"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"IN"},"2":{"slot":2,"type":"STRING","value":"IN"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"IN_51"},"2":{"slot":2,"type":"STRING","value":"IN_51"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"IN_59"},"2":{"slot":2,"type":"STRING","value":"IN_59"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"IN_99"},"2":{"slot":2,"type":"STRING","value":"IN_99"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"OUT"},"2":{"slot":2,"type":"STRING","value":"OUT"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"OUT_51"},"2":{"slot":2,"type":"STRING","value":"OUT_51"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"OUT_59"},"2":{"slot":2,"type":"STRING","value":"OUT_59"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"OUT_99"},"2":{"slot":2,"type":"STRING","value":"OUT_99"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"NET"},"2":{"slot":2,"type":"STRING","value":"NET"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"NET_51"},"2":{"slot":2,"type":"STRING","value":"NET_51"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"NET_59"},"2":{"slot":2,"type":"STRING","value":"NET_59"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"NET_99"},"2":{"slot":2,"type":"STRING","value":"NET_99"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SNFLFINSCH}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${DB_Enterprise}"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"204":{"slot":204,"name":"Order By","elements":{},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"6339553":{"id":6339553,"sourceID":6339519,"targetID":6339552}},"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"jb_LPM_Export_to_Essbase_SQL_Billing_NET","description":"","type":"TRANSFORMATION","tag":"4d54ca42-13a0-4f1b-a13a-6240a9ea5227"}}