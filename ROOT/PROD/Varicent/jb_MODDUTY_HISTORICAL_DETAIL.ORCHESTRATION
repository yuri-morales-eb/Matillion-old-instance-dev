{"job":{"components":{"6342712":{"id":6342712,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-560,"y":-64,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6342754],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6342713":{"id":6342713,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-416,"y":-64,"width":32,"height":32,"inputConnectorIDs":[6342754],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[6342762],"outputUnconditionalConnectorIDs":[6342756],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_Begin"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_Begin"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"RUNNING"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6342714":{"id":6342714,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":112,"y":-64,"width":32,"height":32,"inputConnectorIDs":[6342757],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6342715":{"id":6342715,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":0,"y":-160,"width":32,"height":32,"inputConnectorIDs":[6342759],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6342755],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_Failure"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_End"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"FAILURE"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6342716":{"id":6342716,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":0,"y":-64,"width":32,"height":32,"inputConnectorIDs":[6342753],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6342757],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_Success"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_End"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"SUCCESS"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6342717":{"id":6342717,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":112,"y":-160,"width":32,"height":32,"inputConnectorIDs":[6342755],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6342718":{"id":6342718,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-272,"y":-64,"width":32,"height":32,"inputConnectorIDs":[6342756],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[6342760],"outputUnconditionalConnectorIDs":[6342758],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LOAD THE DATA"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT INTO ${SNFLENTDB}.${SNFLKSCH_VARICENT}.MODDUTY_HISTORICAL_DETAIL \n(SELECT CL.EMPLOYEE_ID__C AS EMPLOYEE_ID, \n        WS.CLAIMANT_NAME__C AS NAME, \n        CL.ACCOUNT_UNIT_SRC__C AS ACCOUNTING_UNIT, \n        CL.ACCOUNTING_UNIT_NAME_SRC__C AS ACCOUNTING_UNIT_NAME, \n        CL.CLIENT_NUMBER__C AS CLIENT_NUMBER, \n        TO_VARCHAR(CL.DATE_OF_LOSS__C, 'MM/DD/YYYY') AS DATE_OF_LOSS, \n        DT.FISCAL_PERIOD AS FISCAL_MONTH,\n        DT.FISCAL_YEAR AS FISCAL_YEAR,\n        WS.CLAIM__C AS CLAIM_NUMBER, \n        WS.EMPLOYEE_OFFERED_MODIFIED_DUTY__C AS EMPLOYEE_OFFERED_MODIFIED_DUTY, \n        WS.EMPLOYEE_ABLE_TO_WORK__C AS EMPLOYEE_ABLE_TO_WORK, \n        CL.ACTIVITY_TYPE_DETAILS__C, \n        CL.MATILLION_UPDATED_TIMESTAMP\n    FROM PROD_DATALAKE.RISKONNECT.WORK_STATUS__C WS\n    INNER JOIN PROD_DATALAKE.RISKONNECT.CLAIM__C CL \n        ON WS.CLAIM__C = CL.ID\n    INNER JOIN PROD_EDW.ENT.DATE_DIM DT\n        ON DT.DATE = CL.DATE_OF_LOSS__C\n    WHERE (DT.FISCAL_YEAR = YEAR(GETDATE())-1 -- PRIOR FISCAL YEAR \n        AND CL.COVERAGE_MINOR__C IN ('Workers Comp Medical Only', 'Workers Comp Indemnity')    \n        AND WS.ACTIVITY_TYPE__C NOT IN ('At Work â€“ Full Duty')\n        AND WS.ACTIVE_OR_COMPLETED__C NOT IN ('Void')\n        AND CL.ACCOUNT_UNIT_SRC__C IS NOT NULL)\n)"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6342719":{"id":6342719,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-272,"y":-160,"width":32,"height":32,"inputConnectorIDs":[6342760,6342761,6342762],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6342759],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Failure Path"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6342752":{"id":6342752,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":-128,"y":-64,"width":32,"height":32,"inputConnectorIDs":[6342758],"outputSuccessConnectorIDs":[6342753],"outputFailureConnectorIDs":[6342761],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Row Count"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select count(*) as num_rows\nfrom ${SNFLENTDB}.${SNFLKSCH_VARICENT}.MODDUTY_HISTORICAL_DETAIL\n"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_rowcount"},"2":{"slot":2,"type":"STRING","value":"NUM_ROWS"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"6342753":{"id":6342753,"sourceID":6342752,"targetID":6342716}},"failureConnectors":{"6342760":{"id":6342760,"sourceID":6342718,"targetID":6342719},"6342761":{"id":6342761,"sourceID":6342752,"targetID":6342719},"6342762":{"id":6342762,"sourceID":6342713,"targetID":6342719}},"unconditionalConnectors":{"6342754":{"id":6342754,"sourceID":6342712,"targetID":6342713},"6342755":{"id":6342755,"sourceID":6342715,"targetID":6342717},"6342756":{"id":6342756,"sourceID":6342713,"targetID":6342718},"6342757":{"id":6342757,"sourceID":6342716,"targetID":6342714},"6342758":{"id":6342758,"sourceID":6342718,"targetID":6342752},"6342759":{"id":6342759,"sourceID":6342719,"targetID":6342715}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{"6342711":{"id":6342711,"x":-608,"y":-277,"width":250,"height":58,"text":"This is a manual job which will run once a year when the compensation team informs us. Do not schedule the MATILLION job. ","colour":"e6e63c"}},"variables":{},"grids":{}},"info":{"name":"jb_MODDUTY_HISTORICAL_DETAIL","description":"","type":"ORCHESTRATION","tag":"d800e79b-869c-452d-88dd-4ab09f6a3123"}}