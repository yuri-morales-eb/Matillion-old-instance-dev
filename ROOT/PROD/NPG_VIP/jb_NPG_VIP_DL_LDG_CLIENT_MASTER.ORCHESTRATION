{"job":{"components":{"6336205":{"id":6336205,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":620619864,"x":256,"y":160,"width":32,"height":32,"inputConnectorIDs":[6336223],"outputSuccessConnectorIDs":[6336222],"outputFailureConnectorIDs":[6336294],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Status","mapTo":"audit_status"},"2":{"slot":2,"fromId":null,"fromName":"Component","mapTo":"audit_component"},"3":{"slot":3,"fromId":null,"fromName":"Started At","mapTo":"audit_started"},"4":{"slot":4,"fromId":null,"fromName":"Duration","mapTo":"audit_duration"},"5":{"slot":5,"fromId":null,"fromName":"Completed At","mapTo":"audit_completed"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Archive File"}}}},"visible":true},"2":{"slot":2,"name":"Source Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"S3"}}}},"visible":true},"4":{"slot":4,"name":"Target Object Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NPG_VIP_DL_LDG_CLIENT_MASTER_${filetimestamp}.xlsx"}}}},"visible":true},"5":{"slot":5,"name":"Target Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"S3"}}}},"visible":true},"6":{"slot":6,"name":"Set Home Directory as Root","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"7":{"slot":7,"name":"Source URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ftp://[username[:password]@]hostname[:port][path]"}}}},"visible":false},"8":{"slot":8,"name":"Source Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"9":{"slot":9,"name":"Source Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"10":{"slot":10,"name":"Source URL","elements":{},"visible":false},"11":{"slot":11,"name":"Source URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"hdfs://host:port/filePath"}}}},"visible":false},"12":{"slot":12,"name":"Perform Certificate Validation","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"13":{"slot":13,"name":"Source URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"https://[username[:password]@]hostname[:port][absolute-path]"}}}},"visible":false},"14":{"slot":14,"name":"Source Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"15":{"slot":15,"name":"Source Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"16":{"slot":16,"name":"Source URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"http://[username[:password]@]hostname[:port][absolute-path]"}}}},"visible":false},"17":{"slot":17,"name":"Source Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"18":{"slot":18,"name":"Source Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"19":{"slot":19,"name":"Source URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${s3_URL}NPG_VIP_DL_LDG_CLIENT_MASTER.xlsx"}}}},"visible":true},"20":{"slot":20,"name":"Set Home Directory as Root","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"21":{"slot":21,"name":"Source URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sftp://[username[:password]@]hostname[:port][path]"}}}},"visible":false},"22":{"slot":22,"name":"Source Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"23":{"slot":23,"name":"Source Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"24":{"slot":24,"name":"Source SFTP Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"25":{"slot":25,"name":"Source URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"smb://[[[authdomain;]user@]host[:port][/share[/dirpath][/name]]][?context]"}}}},"visible":false},"26":{"slot":26,"name":"Source Domain","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"27":{"slot":27,"name":"Source Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"28":{"slot":28,"name":"Source Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"29":{"slot":29,"name":"Target URL","elements":{},"visible":false},"30":{"slot":30,"name":"Target URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"hdfs://host:port/filePath"}}}},"visible":false},"31":{"slot":31,"name":"Target URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${s3_URL}NPG_CLIENTMASTER_BACKUP/"}}}},"visible":true},"33":{"slot":33,"name":"Set Home Directory as Root","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"34":{"slot":34,"name":"Target URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sftp://[username[:password]@]hostname[:port][path]"}}}},"visible":false},"35":{"slot":35,"name":"Target Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"36":{"slot":36,"name":"Target Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"37":{"slot":37,"name":"Target SFTP Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"38":{"slot":38,"name":"Target URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"smb://[[[authdomain;]user@]host[:port][/share[/dirpath][/name]]][?context]"}}}},"visible":false},"39":{"slot":39,"name":"Target Domain","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"40":{"slot":40,"name":"Target Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"41":{"slot":41,"name":"Target Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"42":{"slot":42,"name":"Unpack ZIP file","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"43":{"slot":43,"name":"Gzip data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"44":{"slot":44,"name":"Access Control List Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Bucket Owner Read"}}}},"visible":true},"50":{"slot":50,"name":"URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"https://<account>.sharepoint.com"}}}},"visible":false},"51":{"slot":51,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"52":{"slot":52,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"53":{"slot":53,"name":"SharePoint Edition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SharePoint Online"}}}},"visible":false},"54":{"slot":54,"name":"File Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Document"}}}},"visible":false},"55":{"slot":55,"name":"Library","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"56":{"slot":56,"name":"File URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"57":{"slot":57,"name":"Connection Options","elements":{},"visible":false},"90":{"slot":90,"name":"Authentication","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"91":{"slot":91,"name":"File ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"93":{"slot":93,"name":"File ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"94":{"slot":94,"name":"Path","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"95":{"slot":95,"name":"Download Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"HTML"}}}},"visible":false},"96":{"slot":96,"name":"Download As Zip","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"97":{"slot":97,"name":"Authentication","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"98":{"slot":98,"name":"File Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"File"}}}},"visible":false},"158":{"slot":158,"name":"Service Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOAP"}}}},"visible":false},"159":{"slot":159,"name":"Authentication","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"16040":{"slot":16040,"name":"Blob Location","elements":{},"visible":false},"16140":{"slot":16140,"name":"Blob Location","elements":{},"visible":false},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6336206":{"id":6336206,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-336,"y":160,"width":32,"height":32,"inputConnectorIDs":[6336255],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6336253],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Begin"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_Begin"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"RUNNING"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6336207":{"id":6336207,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-464,"y":160,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6336255],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6336208":{"id":6336208,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-96,"y":160,"width":32,"height":32,"inputConnectorIDs":[6336219],"outputSuccessConnectorIDs":[6336251],"outputFailureConnectorIDs":[6336292],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Insert into Target"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DELETE FROM ${NPG_ENV_DB}.${NPG_ENV_SCH}.NPG_VIP_DL_LDG_CLIENT_MASTER;\nINSERT INTO ${NPG_ENV_DB}.${NPG_ENV_SCH}.NPG_VIP_DL_LDG_CLIENT_MASTER \n(\n\t\t\t\t\tACCOUNT_TYPE ,\n                    GRAND_PARENT_ID ,\n                    PARENT_NAME ,\n                    PARENT_ID ,\n                    SITE ,\n                    CUSTOMER_ID ,\n                    ESSBASE_CUSTOMER_ID ,\n                    CATEGORY,\n                    SUB_CATEGORY ,\n                    CLASS_YEAR ,\n                    LEGACY_ACCOUNT_TYPE ,\n  \t\t\t\t\tVIP_SALES_DIRECTOR,\n                    VIP_PLUS ,\n  \t\t\t\t\tVIP_DATE_WON,\n  \t\t\t\t\tVIP_GO_LIVE,\n                    NPG_MANAGER ,\n                    NPG_OPS_MANAGER ,\n                    SPS_SPECIALIST ,\n                    VMS_TOOL ,\n                    MSP_NAME ,\n                    VMS_FEE ,\n                    NPG_WEEK_WON ,\n                    FIRST_BILLED_CRM ,\n                    BRANCH_ID ,\n                    NEW_EXPANSION_LOGO ,\n                    INHERITED ,\n                    VIP_CATEGORY,\n                    VIP_SUB_CATEGORY,\n                    VIP_CLASS_YEAR,\n                    CY_VIP_RB_CATEGORY ,\n                    PY_VIP_RB_CATEGORY ,\n                    NPG_INCENTIVE,\n                    NPG_REPS,\n                    SPS_INCENTIVE ,\n                    NPG_OPS_INCENTIVES,\n                    DL_CREATED_DATE ,\n                    DL_CREATEDBY,\n                    DL_JOBID,\n\t\t\t\t\tACCOUNT_MGMT_FOCUS,\n                    SALES_MANAGER,\n                    ACCOUNT_MANAGER,\n                    OPS_MANAGER,\n                    FIELD_MANAGER,\n                    EXECUTIVE_SPONSOR,\n  \t\t\t\t\tVENDER_NEUTRAL,\n                    VMS_CLIENT_TYPE,\n                    YEAR_VMS_WON\n)\nSELECT DISTINCT\n\t\t\t\t\tACCOUNT_TYPE,\n                    GRAND_PARENT_ID,\n                    PARENT_NAME,\n                    PARENT_ID,\n                    SITE,\n                    CUSTOMER_ID,\n                    ESSBASE_CUSTOMER_ID,\n                    CATEGORY,\n                    SUB_CATEGORY,\n                    CLASS_YEAR,\n                    LEGACY_ACCOUNT_TYPE ,\n  \t\t\t\t\tVIP_SALES_DIRECTOR,\n                    VIP_PLUS ,\n  \t\t\t\t\tVIP_DATE_WON,\n  \t\t\t\t\tVIP_GO_LIVE,\n                    SALES_MANAGER AS NPG_MANAGER,\n                    OPS_MANAGER AS NPG_OPS_MANAGER,\n                    SPS_SPECIALIST,\n                    VMS_TOOL,\n                    MSP_NAME,\n                    VMS_FEE,\n                    \"NPG_Week_Won\" ,\n                    \"First Billed CRM\" ,\n                    \"Branch ID\" ,\n                    \"New/Expansion Logo\",\n                    \"Inherited\" ,\n                    \"VIP CATEGORY\" ,\n                    \"VIP SUB_CATEGORY\" ,\n                    \"VIP CLASS_YEAR\" ,\n                    \"CY VIP RB Category\",\n                    \"PY VIP RB Category\",\n                    \"NPG Incentive\" ,\n                    \"NPG Reps\" ,\n                    \"SPS Incentive\" ,\n                    \"NPG Ops Incentives\",\n                    CAST(CURRENT_TIMESTAMP AS TIMESTAMP_NTZ) ,\n                    CAST('${environment_username}' as  VARCHAR(50)) ,\n                    CAST('${run_history_id}' as VARCHAR(50)),\n\t\t\t\t\t\"Account Mgmt Focus\",\n                    SALES_MANAGER,\n                    ACCOUNT_MANAGER,\n                    OPS_MANAGER,\n                    FIELD_MANAGER,\n                    EXECUTIVE_SPONSOR,\n                    \"Vender_Neutral\",\n                    \"VMS_Client_Type\",\n                    \"Year_VMS_Won\"\nFROM ${NPG_ENV_DB}.${NPG_ENV_SCH}.NPG_VIP_DL_LDG_CLIENT_MASTER_TEMP\nWHERE CUSTOMER_ID IN (SELECT DISTINCT ACCOUNTNUMBER FROM ${SNFLKDB}.${SNFLKSCH}.CRM_DL_LDG_ACCOUNTBASE ACCT ) \nAND CUSTOMER_ID NOT IN \n(SELECT CUSTOMER_ID FROM (\nSELECT CUSTOMER_ID,COUNT(*) FROM ${NPG_ENV_DB}.${NPG_ENV_SCH}.NPG_VIP_DL_LDG_CLIENT_MASTER_TEMP  GROUP BY 1 HAVING COUNT(*) >1)\n)\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6336209":{"id":6336209,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":496,"y":160,"width":32,"height":32,"inputConnectorIDs":[6336221],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6336254],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Success"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_End"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"SUCCESS"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6336210":{"id":6336210,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":384,"y":0,"width":32,"height":32,"inputConnectorIDs":[6336289],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6336288],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Failure"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_End"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"FAILURE"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6336211":{"id":6336211,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":384,"y":160,"width":32,"height":32,"inputConnectorIDs":[6336222],"outputSuccessConnectorIDs":[6336221],"outputFailureConnectorIDs":[6336293],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Prep Audit Success"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select count(*) as num_rows\nfrom ${NPG_ENV_DB}.${NPG_ENV_SCH}.NPG_VIP_DL_LDG_CLIENT_MASTER_TEMP"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_rowcount"},"2":{"slot":2,"type":"STRING","value":"NUM_ROWS"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6336212":{"id":6336212,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1897708461,"x":-240,"y":160,"width":32,"height":32,"inputConnectorIDs":[6336253],"outputSuccessConnectorIDs":[6336219],"outputFailureConnectorIDs":[6336290],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"New_Load_Excel"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Basic"}}}},"visible":true},"6":{"slot":6,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ClientMasterFile"}}}},"visible":true},"7":{"slot":7,"name":"Data Selection","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"RowId"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_TYPE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"GRAND_PARENT_ID"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PARENT_NAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"PARENT_ID"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"SITE"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOMER_ID"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ESSBASE_CUSTOMER_ID"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"CATEGORY"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"SUB_CATEGORY"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"CLASS_YEAR"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"LEGACY_ACCOUNT_TYPE"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"VIP_SALES_DIRECTOR"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"VIP_PLUS"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"VIP_DATE_WON"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"VIP_GO_LIVE"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"NPG_MANAGER"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"NPG_OPS_MANAGER"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"SPS_SPECIALIST"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"VMS_TOOL"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"MSP_NAME"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"VMS_FEE"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"NPG_Week_Won"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"First Billed CRM"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"Branch ID"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"New/Expansion Logo"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"Inherited"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"VIP CATEGORY"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"VIP SUB_CATEGORY"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"VIP CLASS_YEAR"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"CY VIP RB Category"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"PY VIP RB Category"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"NPG Incentive"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"NPG Reps"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"SPS Incentive"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"NPG Ops Incentives"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"Account Mgmt Focus"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"SALES_MANAGER"}}},"39":{"slot":39,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_MANAGER"}}},"40":{"slot":40,"values":{"1":{"slot":1,"type":"STRING","value":"OPS_MANAGER"}}},"41":{"slot":41,"values":{"1":{"slot":1,"type":"STRING","value":"FIELD_MANAGER"}}},"42":{"slot":42,"values":{"1":{"slot":1,"type":"STRING","value":"EXECUTIVE_SPONSOR"}}},"43":{"slot":43,"values":{"1":{"slot":1,"type":"STRING","value":"Vender_Neutral"}}},"44":{"slot":44,"values":{"1":{"slot":1,"type":"STRING","value":"VMS_Client_Type"}}},"45":{"slot":45,"values":{"1":{"slot":1,"type":"STRING","value":"Year_VMS_Won"}}}},"visible":true},"8":{"slot":8,"name":"Data Source Filter","elements":{},"visible":true},"9":{"slot":9,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"10":{"slot":10,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT ..."}}}},"visible":false},"11":{"slot":11,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"12":{"slot":12,"name":"Connection Options","elements":{},"visible":true},"13":{"slot":13,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${NPG_ENV_DB}"}}}},"visible":true},"14":{"slot":14,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${NPG_ENV_SCH}"}}}},"visible":true},"15":{"slot":15,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NPG_VIP_DL_LDG_CLIENT_MASTER_TEMP"}}}},"visible":true},"16":{"slot":16,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${NPG_ENV_WH}"}}}},"visible":true},"17":{"slot":17,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etld1"}}}},"visible":false},"18":{"slot":18,"name":"Primary Keys","elements":{},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Excel"}}}},"visible":false},"400":{"slot":400,"name":"Storage URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://etld1/NPG_VIP_DL_LDG_CLIENT_MASTER.xlsx"}}}},"visible":true},"401":{"slot":401,"name":"Cell Range","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"A1:AR200000"}}}},"visible":true},"402":{"slot":402,"name":"Contains Header Row","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"403":{"slot":403,"name":"Credentials","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"498":{"slot":498,"name":"Storage Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Amazon S3 Storage"}}}},"visible":true},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"1013":{"slot":1013,"name":"Auto Debug","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}}},"visible":true},"1014":{"slot":1014,"name":"Debug Level","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"3"}}}},"visible":false},"1992":{"slot":1992,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1993":{"slot":1993,"name":"Use Accelerated Endpoint","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"1994":{"slot":1994,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"1995":{"slot":1995,"name":"Stage Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LDG"}}}},"visible":false},"1996":{"slot":1996,"name":"Stage Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEV_NPG_VIP"}}}},"visible":false},"1997":{"slot":1997,"name":"New Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NPG_VIP_DL_LDG_CLIENT_MASTER_TEMP"}}}},"visible":false},"1998":{"slot":1998,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LDG"}}}},"visible":false},"1999":{"slot":1999,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEV_NPG_VIP"}}}},"visible":false},"2000":{"slot":2000,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"40501":{"slot":40501,"name":"","elements":{},"visible":false},"40502":{"slot":40502,"name":"Load Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":""}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"63319":{"slot":63319,"name":"Stage Authentication","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Credentials"}}}},"visible":false},"63320":{"slot":63320,"name":"Storage Account","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"63321":{"slot":63321,"name":"Blob Container","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"63322":{"slot":63322,"name":"Storage Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"84533":{"slot":84533,"name":"Storage Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"88340":{"slot":88340,"name":"","elements":{},"visible":false},"88341":{"slot":88341,"name":"Stage Platform","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Snowflake Managed"}}}},"visible":true},"88342":{"slot":88342,"name":"Stage Authentication","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Credentials"}}}},"visible":false},"88343":{"slot":88343,"name":"Storage Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"88344":{"slot":88344,"name":"Use Accelerated Endpoint","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"88345":{"slot":88345,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"98776":{"slot":98776,"name":"GCS Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6336213":{"id":6336213,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":16,"y":160,"width":32,"height":32,"inputConnectorIDs":[6336251],"outputSuccessConnectorIDs":[6336220],"outputFailureConnectorIDs":[6336295],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Exception Handling"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DELETE FROM ${NPG_ENV_DB}.${NPG_ENV_SCH}.NPG_VIP_CLIENT_MASTER_EXCEPTION;\n\n-- Handling missing customer in CRM\nINSERT INTO ${NPG_ENV_DB}.${NPG_ENV_SCH}.NPG_VIP_CLIENT_MASTER_EXCEPTION \n(\n\t\t\t\t\tACCOUNT_TYPE ,\n                    GRAND_PARENT_ID ,\n                    PARENT_NAME ,\n                    PARENT_ID ,\n                    SITE ,\n                    CUSTOMER_ID ,\n                    ESSBASE_CUSTOMER_ID ,\n                    CATEGORY,\n                    SUB_CATEGORY ,\n                    CLASS_YEAR ,\n                    LEGACY_ACCOUNT_TYPE ,\n  \t\t\t\t\tVIP_SALES_DIRECTOR,\n                    VIP_PLUS ,\n  \t\t\t\t\tVIP_DATE_WON,\n  \t\t\t\t\tVIP_GO_LIVE,\n                    NPG_MANAGER ,\n                    NPG_OPS_MANAGER ,\n                    SPS_SPECIALIST ,\n                    VMS_TOOL ,\n                    MSP_NAME ,\n                    VMS_FEE ,\n                    NPG_WEEK_WON ,\n                    FIRST_BILLED_CRM ,\n                    BRANCH_ID ,\n                    NEW_EXPANSION_LOGO ,\n                    INHERITED ,\n                    VIP_CATEGORY,\n                    VIP_SUB_CATEGORY,\n                    VIP_CLASS_YEAR,\n                    CY_VIP_RB_CATEGORY ,\n                    PY_VIP_RB_CATEGORY ,\n                    NPG_INCENTIVE,\n                    NPG_REPS,\n                    SPS_INCENTIVE ,\n                    NPG_OPS_INCENTIVES,\n                   \tEXCEPTION_REASON,\n                    DL_CREATED_DATE ,\n                    DL_CREATEDBY,\n                    DL_JOBID,\n\t\t\t\t\tACCOUNT_MGMT_FOCUS,\n                    SALES_MANAGER,\n                    ACCOUNT_MANAGER,\n                    OPS_MANAGER,\n                    FIELD_MANAGER,\n                    EXECUTIVE_SPONSOR,\n  \t\t\t\t\tVENDER_NEUTRAL,\n                    VMS_CLIENT_TYPE,\n                    YEAR_VMS_WON\n  \n)\nSELECT DISTINCT\n\t\t\t\t\tACCOUNT_TYPE\t,\n\t\t\t\t\tGRAND_PARENT_ID\t,\n                    PARENT_NAME ,\n\t\t\t\t\tPARENT_ID\t,\n\t\t\t\t\tSITE\t,\n\t\t\t\t\tCUSTOMER_ID\t,\n\t\t\t\t\tESSBASE_CUSTOMER_ID\t,\n\t\t\t\t\tCATEGORY\t,\n\t\t\t\t\tSUB_CATEGORY,\n                    CLASS_YEAR,\n                    LEGACY_ACCOUNT_TYPE ,\n  \t\t\t\t\tVIP_SALES_DIRECTOR,\n                    VIP_PLUS ,\n  \t\t\t\t\tVIP_DATE_WON,\n  \t\t\t\t\tVIP_GO_LIVE,\n\t\t\t\t\tSALES_MANAGER AS NPG_MANAGER,\n\t\t\t\t\tOPS_MANAGER AS NPG_OPS_MANAGER,\n\t\t\t\t\tSPS_SPECIALIST,\n\t\t\t\t\tVMS_TOOL,\n\t\t\t\t\tMSP_NAME,\n\t\t\t\t\tVMS_FEE\t,\n                    \"NPG_Week_Won\",\n                    \"First Billed CRM\",\n                    \"Branch ID\",\n                    \"New/Expansion Logo\",\n                    \"Inherited\" ,\n                    \"VIP CATEGORY\" ,\n                    \"VIP SUB_CATEGORY\" ,\n                    \"VIP CLASS_YEAR\" ,\n                    \"CY VIP RB Category\",\n                    \"PY VIP RB Category\",\n                    \"NPG Incentive\",\n                    \"NPG Reps\",\n                    \"SPS Incentive\",\n                    \"NPG Ops Incentives\",\n                    'CUSTOMER NOT EXISTS IN CRM ACCOUNTBASE',\n                    CAST(CURRENT_TIMESTAMP AS TIMESTAMP_NTZ) ,\n\t\t\t\t\tCAST('${environment_username}' as  VARCHAR(50)) ,\n\t\t\t\t\tCAST('${run_history_id}' as VARCHAR(50)),\n\t\t\t\t\t\"Account Mgmt Focus\",\n                    SALES_MANAGER,\n                    ACCOUNT_MANAGER,\n                    OPS_MANAGER,\n                    FIELD_MANAGER,\n                    EXECUTIVE_SPONSOR,\n                    \"Vender_Neutral\",\n                    \"VMS_Client_Type\",\n                    \"Year_VMS_Won\"\nFROM ${NPG_ENV_DB}.${NPG_ENV_SCH}.NPG_VIP_DL_LDG_CLIENT_MASTER_TEMP\nWHERE CUSTOMER_ID NOT IN \n(SELECT DISTINCT ACCOUNTNUMBER FROM ${SNFLKDB}.${SNFLKSCH}.CRM_DL_LDG_ACCOUNTBASE ACCT\n);\n\n-- Handling duplicate customer details\n\nINSERT INTO ${NPG_ENV_DB}.${NPG_ENV_SCH}.NPG_VIP_CLIENT_MASTER_EXCEPTION\n(\n\t\t\t\t\tACCOUNT_TYPE ,\n                    GRAND_PARENT_ID ,\n                    PARENT_NAME ,\n                    PARENT_ID ,\n                    SITE ,\n                    CUSTOMER_ID ,\n                    ESSBASE_CUSTOMER_ID ,\n                    CATEGORY,\n                    SUB_CATEGORY ,\n                    CLASS_YEAR ,\n                    LEGACY_ACCOUNT_TYPE ,\n  \t\t\t\t\tVIP_SALES_DIRECTOR,\n                    VIP_PLUS ,\n  \t\t\t\t\tVIP_DATE_WON,\n  \t\t\t\t\tVIP_GO_LIVE,\n                    NPG_MANAGER ,\n                    NPG_OPS_MANAGER ,\n                    SPS_SPECIALIST ,\n                    VMS_TOOL ,\n                    MSP_NAME ,\n                    VMS_FEE ,\n                    NPG_WEEK_WON ,\n                    FIRST_BILLED_CRM ,\n                    BRANCH_ID ,\n                    NEW_EXPANSION_LOGO ,\n                    INHERITED ,\n                    VIP_CATEGORY,\n                    VIP_SUB_CATEGORY,\n                    VIP_CLASS_YEAR,\n                    CY_VIP_RB_CATEGORY ,\n                    PY_VIP_RB_CATEGORY ,\n                    NPG_INCENTIVE,\n                    NPG_REPS,\n                    SPS_INCENTIVE ,\n                    NPG_OPS_INCENTIVES,\n  \t\t\t\t\tEXCEPTION_REASON,\n                    DL_CREATED_DATE ,\n                    DL_CREATEDBY,\n                    DL_JOBID,\n\t\t\t\t\tACCOUNT_MGMT_FOCUS,\n                    SALES_MANAGER,\n                    ACCOUNT_MANAGER,\n                    OPS_MANAGER,\n                    FIELD_MANAGER,\n                    EXECUTIVE_SPONSOR,\n  \t\t\t\t\tVENDER_NEUTRAL,\n                    VMS_CLIENT_TYPE,\n                    YEAR_VMS_WON\n)\nSELECT \t\tDISTINCT \n\t\t\t\t\tACCOUNT_TYPE\t,\n\t\t\t\t\tGRAND_PARENT_ID\t,\n                    PARENT_NAME,\n\t\t\t\t\tPARENT_ID\t,\n\t\t\t\t\tSITE\t,\n\t\t\t\t\tCUSTOMER_ID\t,\n\t\t\t\t\tESSBASE_CUSTOMER_ID\t,\n\t\t\t\t\tCATEGORY\t,\n\t\t\t\t\tSUB_CATEGORY\t,\n                    CLASS_YEAR,\n                    LEGACY_ACCOUNT_TYPE ,\n  \t\t\t\t\tVIP_SALES_DIRECTOR,\n                    VIP_PLUS ,\n  \t\t\t\t\tVIP_DATE_WON,\n  \t\t\t\t\tVIP_GO_LIVE,\n\t\t\t\t\tSALES_MANAGER AS NPG_MANAGER,\n\t\t\t\t\tOPS_MANAGER AS NPG_OPS_MANAGER,\n\t\t\t\t\tSPS_SPECIALIST\t,\n\t\t\t\t\tVMS_TOOL\t,\n\t\t\t\t\tMSP_NAME\t,\n\t\t\t\t\tVMS_FEE\t,\n                    \"NPG_Week_Won\",\n                    \"First Billed CRM\",\n                    \"Branch ID\",\n                    \"New/Expansion Logo\",\n                    \"Inherited\" ,\n                    \"VIP CATEGORY\" ,\n                    \"VIP SUB_CATEGORY\" ,\n                    \"VIP CLASS_YEAR\" ,\n                    \"CY VIP RB Category\",\n                    \"PY VIP RB Category\",\n                    \"NPG Incentive\",\n                    \"NPG Reps\",\n                    \"SPS Incentive\",\n                    \"NPG Ops Incentives\",\n\t\t\t\t\t'DUPLICATE CUSTOMER RECORD' AS EXCEPTION_REASON,\n                    CAST(CURRENT_TIMESTAMP AS TIMESTAMP_NTZ) ,\n\t\t\t\t\tCAST('${environment_username}' as  VARCHAR(50)) ,\n\t\t\t\t\tCAST('${run_history_id}' as VARCHAR(50)),\n\t\t\t\t\t\"Account Mgmt Focus\",\n                    SALES_MANAGER,\n                    ACCOUNT_MANAGER,\n                    OPS_MANAGER,\n                    FIELD_MANAGER,\n                    EXECUTIVE_SPONSOR,\n                    \"Vender_Neutral\",\n                    \"VMS_Client_Type\",\n                    \"Year_VMS_Won\"\nFROM ${NPG_ENV_DB}.${NPG_ENV_SCH}.NPG_VIP_DL_LDG_CLIENT_MASTER_TEMP \nWHERE CUSTOMER_ID IN \n(\n  SELECT CUSTOMER_ID FROM (\nSELECT CUSTOMER_ID,COUNT(*) FROM ${NPG_ENV_DB}.${NPG_ENV_SCH}.NPG_VIP_DL_LDG_CLIENT_MASTER_TEMP  GROUP BY 1 HAVING COUNT(*) >1\n)\n)\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6336214":{"id":6336214,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":256,"y":0,"width":32,"height":32,"inputConnectorIDs":[6336252],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6336289],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Prep Audit Failure"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select count(*) as num_rows\nfrom ${NPG_ENV_DB}.${NPG_ENV_SCH}.NPG_VIP_DL_LDG_CLIENT_MASTER\nwhere DL_JOBID = ${run_history_id}\n"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_rowcount"},"2":{"slot":2,"type":"STRING","value":"NUM_ROWS"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6336215":{"id":6336215,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":80,"y":0,"width":32,"height":32,"inputConnectorIDs":[6336290,6336291,6336292,6336293,6336294,6336295],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6336252],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Failure Path"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6336216":{"id":6336216,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":144,"y":160,"width":32,"height":32,"inputConnectorIDs":[6336220],"outputSuccessConnectorIDs":[6336223],"outputFailureConnectorIDs":[6336291],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Set File TimeStamp"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import time\nimport datetime\n\nimport boto\n\nst = datetime.datetime.fromtimestamp(time.time()).strftime('%Y%m%d%H%M%S')\n\ncontext.updateVariable(\"filetimestamp\",st)\n#print(st)\n\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6336217":{"id":6336217,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":624,"y":160,"width":32,"height":32,"inputConnectorIDs":[6336254],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6336218":{"id":6336218,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":496,"y":0,"width":32,"height":32,"inputConnectorIDs":[6336288],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"6336219":{"id":6336219,"sourceID":6336212,"targetID":6336208},"6336220":{"id":6336220,"sourceID":6336213,"targetID":6336216},"6336221":{"id":6336221,"sourceID":6336211,"targetID":6336209},"6336222":{"id":6336222,"sourceID":6336205,"targetID":6336211},"6336223":{"id":6336223,"sourceID":6336216,"targetID":6336205},"6336251":{"id":6336251,"sourceID":6336208,"targetID":6336213}},"failureConnectors":{"6336290":{"id":6336290,"sourceID":6336212,"targetID":6336215},"6336291":{"id":6336291,"sourceID":6336216,"targetID":6336215},"6336292":{"id":6336292,"sourceID":6336208,"targetID":6336215},"6336293":{"id":6336293,"sourceID":6336211,"targetID":6336215},"6336294":{"id":6336294,"sourceID":6336205,"targetID":6336215},"6336295":{"id":6336295,"sourceID":6336213,"targetID":6336215}},"unconditionalConnectors":{"6336252":{"id":6336252,"sourceID":6336215,"targetID":6336214},"6336253":{"id":6336253,"sourceID":6336206,"targetID":6336212},"6336254":{"id":6336254,"sourceID":6336209,"targetID":6336217},"6336255":{"id":6336255,"sourceID":6336207,"targetID":6336206},"6336288":{"id":6336288,"sourceID":6336210,"targetID":6336218},"6336289":{"id":6336289,"sourceID":6336214,"targetID":6336210}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{"6336204":{"id":6336204,"x":-422,"y":-14,"width":250,"height":58,"text":"send error to Rachel Kubin","colour":"d60000"}},"variables":{},"grids":{}},"info":{"name":"jb_NPG_VIP_DL_LDG_CLIENT_MASTER","description":"","type":"ORCHESTRATION","tag":"b3d56586-fc04-4608-907e-19bdf5f5612b"}}