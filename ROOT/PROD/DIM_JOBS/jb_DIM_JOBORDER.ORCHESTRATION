{"job":{"components":{"6332911":{"id":6332911,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-400,"y":0,"width":32,"height":32,"inputConnectorIDs":[6332930],"outputSuccessConnectorIDs":[6332923],"outputFailureConnectorIDs":[6332931],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Begin"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_Begin"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"RUNNING"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332912":{"id":6332912,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":160,"y":-112,"width":32,"height":32,"inputConnectorIDs":[6332926],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6332927],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Failure"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_End"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"FAILURE"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332913":{"id":6332913,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-560,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6332930],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332914":{"id":6332914,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":240,"y":0,"width":32,"height":32,"inputConnectorIDs":[6332929],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6332925],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Success"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_End"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"SUCCESS"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332915":{"id":6332915,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-241,"y":-4,"width":32,"height":32,"inputConnectorIDs":[6332923],"outputSuccessConnectorIDs":[6332924],"outputFailureConnectorIDs":[6332933],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Merge"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MERGE INTO ${SNFLKDB}.${SNFLKSCH}.dim_job_order t\nUSING (\n  SELECT DISTINCT jb.cda_joborderid AS src_job_ord_id\n    , sm.value AS job_ord_typ\n    , cda_name AS job_cd_nm\n    , to_timestamp_ntz(CURRENT_TIMESTAMP(0)) AS created_dt\n    , CURRENT_USER() AS created_by\n    , to_timestamp_ntz(CURRENT_TIMESTAMP(0)) AS modified_dt\n    , CURRENT_USER() AS modified_by\n    , 'Y' AS active_status\n  FROM ${SFDBPROD_DATALAKE}.${SNFLKSCH_CRM}.cda_joborderbase jb\n  LEFT JOIN ${SFDBPROD_DATALAKE}.${SNFLKSCH_CRM}.stringmapbase sm\n    ON sm.attributename = 'cda_jobordertype'\n      AND sm.objecttypecode = 10019\n      AND sm.attributevalue = jb.cda_jobordertype\n  LEFT JOIN ${SFDBPROD_DATALAKE}.${SNFLKSCH_CRM}.CDA_JOBCODEBASE jc\n    ON jc.cda_jobcodeid = jb.cda_jobcode\n  ) s\n  ON t.src_job_ord_id = s.src_job_ord_id\nWHEN MATCHED\n  AND (\n    t.job_ord_typ is distinct from s.job_ord_typ\n    OR t.job_cd_nm is distinct from s.job_cd_nm\n    )\n  AND t.modified_dt = (\n    SELECT max(modified_dt)\n    FROM ${SNFLKDB}.${SNFLKSCH}.dim_job_order\n    WHERE src_job_ord_id = s.src_job_ord_id\n    )\n  THEN\n    UPDATE\n    SET modified_dt = to_timestamp_ntz(CURRENT_TIMESTAMP(0))\n      , modified_by = CURRENT_USER()\n      , active_status = 'N'\nWHEN NOT MATCHED\n  THEN\n    INSERT (\n      src_job_ord_id\n      , job_ord_typ\n      , job_cd_nm\n      , created_dt\n      , created_by\n      , modified_dt\n      , modified_by\n      , active_status\n      )\n    VALUES (\n      s.src_job_ord_id\n      , s.job_ord_typ\n      , s.job_cd_nm\n      , s.created_dt\n      , s.created_by\n      , s.modified_dt\n      , s.modified_by\n      , s.active_status\n      )"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332916":{"id":6332916,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-80,"y":0,"width":32,"height":32,"inputConnectorIDs":[6332924],"outputSuccessConnectorIDs":[6332922],"outputFailureConnectorIDs":[6332932],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Inserts"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"/* Handles inserts for cases when the update deprecated an existing record */\nINSERT INTO ${SNFLKDB}.${SNFLKSCH}.dim_job_order (\n  src_job_ord_id\n  , job_ord_typ\n  , job_cd_nm\n  , created_dt\n  , created_by\n  , modified_dt\n  , modified_by\n  , active_status\n  )\nSELECT s.*\nFROM ${SNFLKDB}.${SNFLKSCH}.dim_job_order t\nINNER JOIN (\n  SELECT DISTINCT jb.cda_joborderid AS src_job_ord_id\n    , sm.value AS job_ord_typ\n    , cda_name AS job_cd_nm\n    , to_timestamp_ntz(CURRENT_TIMESTAMP(0)) AS created_dt\n    , CURRENT_USER() AS created_by\n    , to_timestamp_ntz(CURRENT_TIMESTAMP(0)) AS modified_dt\n    , CURRENT_USER() AS modified_by\n    , 'Y' AS active_status\n  FROM ${SFDBPROD_DATALAKE}.${SNFLKSCH_CRM}.cda_joborderbase jb\n  LEFT JOIN ${SFDBPROD_DATALAKE}.${SNFLKSCH_CRM}.stringmapbase sm\n    ON sm.attributename = 'cda_jobordertype'\n      AND sm.objecttypecode = 10019\n      AND sm.attributevalue = jb.cda_jobordertype\n  LEFT JOIN ${SFDBPROD_DATALAKE}.${SNFLKSCH_CRM}.CDA_JOBCODEBASE jc\n    ON jc.cda_jobcodeid = jb.cda_jobcode\n  ) s\n  ON t.src_job_ord_id = s.src_job_ord_id\n    AND (\n      t.job_ord_typ is distinct from s.job_ord_typ\n      OR t.job_cd_nm is distinct from s.job_cd_nm\n      )\n    AND t.modified_dt = (\n      SELECT max(modified_dt)\n      FROM ${SNFLKDB}.${SNFLKSCH}.dim_job_order\n      WHERE src_job_ord_id = s.src_job_ord_id\n      )"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332917":{"id":6332917,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":320,"y":-112,"width":32,"height":32,"inputConnectorIDs":[6332927],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332918":{"id":6332918,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":400,"y":0,"width":32,"height":32,"inputConnectorIDs":[6332925],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332919":{"id":6332919,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":0,"y":-112,"width":32,"height":32,"inputConnectorIDs":[6332928],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6332926],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Prep Audit Failure"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select count(*) as rows_modified\nfrom ${SNFLKDB}.${SNFLKSCH}.dim_job_order\nwhere modified_dt >= current_date()"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_rowcount"},"2":{"slot":2,"type":"STRING","value":"ROWS_MODIFIED"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332920":{"id":6332920,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-240,"y":-112,"width":32,"height":32,"inputConnectorIDs":[6332931,6332932,6332933],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6332928],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Failure"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332921":{"id":6332921,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":78,"y":2,"width":32,"height":32,"inputConnectorIDs":[6332922],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6332929],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Prep Audit Success"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select count(*) as rows_modified\nfrom ${SNFLKDB}.${SNFLKSCH}.dim_job_order\nwhere modified_dt >= current_date()"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_rowcount"},"2":{"slot":2,"type":"STRING","value":"ROWS_MODIFIED"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"6332922":{"id":6332922,"sourceID":6332916,"targetID":6332921},"6332923":{"id":6332923,"sourceID":6332911,"targetID":6332915},"6332924":{"id":6332924,"sourceID":6332915,"targetID":6332916}},"failureConnectors":{"6332931":{"id":6332931,"sourceID":6332911,"targetID":6332920},"6332932":{"id":6332932,"sourceID":6332916,"targetID":6332920},"6332933":{"id":6332933,"sourceID":6332915,"targetID":6332920}},"unconditionalConnectors":{"6332925":{"id":6332925,"sourceID":6332914,"targetID":6332918},"6332926":{"id":6332926,"sourceID":6332919,"targetID":6332912},"6332927":{"id":6332927,"sourceID":6332912,"targetID":6332917},"6332928":{"id":6332928,"sourceID":6332920,"targetID":6332919},"6332929":{"id":6332929,"sourceID":6332921,"targetID":6332914},"6332930":{"id":6332930,"sourceID":6332913,"targetID":6332911}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{},"grids":{}},"info":{"name":"jb_DIM_JOBORDER","description":"","type":"ORCHESTRATION","tag":"9ef28b32-be9f-4107-8989-a14ed81f63e0"}}