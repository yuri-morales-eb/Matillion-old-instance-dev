{"job":{"components":{"6333001":{"id":6333001,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":304,"y":-144,"width":32,"height":32,"inputConnectorIDs":[6333006],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6333005],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Failure"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_End"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"FAILURE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"audit_rowcount"},"2":{"slot":2,"type":"STRING","value":"0"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6333043":{"id":6333043,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-48,"y":0,"width":32,"height":32,"inputConnectorIDs":[6333007],"outputSuccessConnectorIDs":[6333002],"outputFailureConnectorIDs":[6333011],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Begin"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_Begin"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"RUNNING"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6333044":{"id":6333044,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-176,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6333007],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6333045":{"id":6333045,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":432,"y":0,"width":32,"height":32,"inputConnectorIDs":[6333008],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6333046":{"id":6333046,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":304,"y":0,"width":32,"height":32,"inputConnectorIDs":[6333004],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6333008],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Success"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_End"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"SUCCESS"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6333047":{"id":6333047,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":432,"y":-144,"width":32,"height":32,"inputConnectorIDs":[6333005],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6333048":{"id":6333048,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":64,"y":-144,"width":32,"height":32,"inputConnectorIDs":[6333009,6333010,6333011],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6333006],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6333049":{"id":6333049,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":192,"y":0,"width":32,"height":32,"inputConnectorIDs":[6333003],"outputSuccessConnectorIDs":[6333004],"outputFailureConnectorIDs":[6333009],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Row Count","mapTo":"audit_rowcount"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Insert data"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT INTO ${SNFLKDB}.${SNFLKSCH}.DIM_EMPLOYEE\n (\n  SRC_EMP_ID, FIRST_NAME, LAST_NAME, \n  RESOURCE_CD, FINALIZEDBY, CREATED_DT, \n  CREATED_BY, MODIFIED_DT, MODIFIED_BY, \n  ACTIVE_STATUS\n ) \nSELECT S.*\n  FROM (SELECT DISTINCT COALESCE(TO_CHAR(E.EMPLOYEE),LTRIM(REGEXP_REPLACE(A.RESOURCE_CODE, '^0*', ''))) AS SRC_EMP_ID, \n                RTRIM(COALESCE(E.FIRST_NAME, R.FIRST_NAME)) AS FIRST_NAME, \n                RTRIM(COALESCE(E.LAST_NAME, R.LAST_NAME)) AS LAST_NAME, \n                LTRIM(A.RESOURCE_CODE) AS RESOURCE_CD, \n                EB.CDA_FINALIZEDBY AS FINALIZEDBY, \n                TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(0)) AS CREATED_DT, \n                CURRENT_USER() AS CREATED_BY, \n                TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(0)) AS MODIFIED_DT, \n                CURRENT_USER() AS MODIFIED_BY, \n                'Y' AS ACTIVE_STATUS \n           FROM ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.ACTRANS A \n                LEFT JOIN ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.EMPLOYEE E \n                  ON LTRIM(REGEXP_REPLACE(A.RESOURCE_CODE, '^0*', '')) = CAST(E.EMPLOYEE AS VARCHAR(100)) \n                LEFT JOIN (SELECT EB.CDA_EMPLOYEENUMBER, \n                                  MAX(EB.CDA_FINALIZEDBY) AS CDA_FINALIZEDBY \n                             FROM ${SFDBPROD_DATALAKE}.${SNFLKSCH_CRM}.CDA_EMPLOYEEBASE EB \n                            GROUP BY EB.CDA_EMPLOYEENUMBER\n                          ) EB ON EB.CDA_EMPLOYEENUMBER = E.EMPLOYEE \n                LEFT JOIN ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.ACRESOURCE R ON LTRIM(REGEXP_REPLACE(A.RESOURCE_CODE, '^0*', '')) = R.RESOURCE_CODE \n          WHERE LEN(A.RESOURCE_CODE) > 0 \n        QUALIFY ROW_NUMBER() OVER(PARTITION BY SRC_EMP_ID, A.RESOURCE_CODE ORDER BY A.OBJ_ID DESC) = 1\n             ) S\n WHERE NOT EXISTS (SELECT 1\n                     FROM ${SNFLKDB}.${SNFLKSCH}.DIM_EMPLOYEE INV\n                    WHERE S.SRC_EMP_ID = INV.SRC_EMP_ID\n                      AND S.RESOURCE_CD = INV.RESOURCE_CD\n                      AND (S.FINALIZEDBY = INV.FINALIZEDBY OR (S.FINALIZEDBY IS NULL AND INV.FINALIZEDBY IS NULL))\n                      AND (S.FIRST_NAME = INV.FIRST_NAME OR (S.FIRST_NAME IS NULL AND INV.FIRST_NAME IS NULL))\n                      AND (S.LAST_NAME = INV.LAST_NAME OR (S.LAST_NAME IS NULL AND INV.LAST_NAME IS NULL))\n                      AND INV.ACTIVE_STATUS = 'Y')"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6333050":{"id":6333050,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":64,"y":0,"width":32,"height":32,"inputConnectorIDs":[6333002],"outputSuccessConnectorIDs":[6333003],"outputFailureConnectorIDs":[6333010],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Row Count","mapTo":"audit_rowcount1"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Merge data"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MERGE INTO ${SNFLKDB}.${SNFLKSCH}.DIM_EMPLOYEE T \n USING (\n        SELECT DISTINCT COALESCE(\n               TO_CHAR(E.EMPLOYEE), \n               LTRIM(REGEXP_REPLACE(A.RESOURCE_CODE, '^0*', ''))) AS SRC_EMP_ID, \n               RTRIM(COALESCE(E.FIRST_NAME, R.FIRST_NAME)) AS FIRST_NAME, \n               RTRIM(COALESCE(E.LAST_NAME, R.LAST_NAME)) AS LAST_NAME, \n               LTRIM(A.RESOURCE_CODE) AS RESOURCE_CD, \n               EB.CDA_FINALIZEDBY AS FINALIZEDBY, \n               TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(0)) AS CREATED_DT, \n               CURRENT_USER() AS CREATED_BY, \n               TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(0)) AS MODIFIED_DT, \n               CURRENT_USER() AS MODIFIED_BY, \n               'Y' AS ACTIVE_STATUS ,\n               HASH(RTRIM(COALESCE(E.FIRST_NAME, R.FIRST_NAME)),RTRIM(COALESCE(E.LAST_NAME, R.LAST_NAME))\n                    ,EB.CDA_FINALIZEDBY) AS TRACKINGHASH\n          FROM ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.ACTRANS A \n          LEFT JOIN ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.EMPLOYEE E \n            ON LTRIM( REGEXP_REPLACE(A.RESOURCE_CODE, '^0*', '')) = CAST(E.EMPLOYEE AS VARCHAR(100)) \n          LEFT JOIN (SELECT EB.CDA_EMPLOYEENUMBER, \n                            MAX(EB.CDA_FINALIZEDBY) AS CDA_FINALIZEDBY \n                       FROM ${SFDBPROD_DATALAKE}.${SNFLKSCH_CRM}.CDA_EMPLOYEEBASE EB \n                      GROUP BY EB.CDA_EMPLOYEENUMBER\n                    ) EB \n            ON EB.CDA_EMPLOYEENUMBER = E.EMPLOYEE \n          LEFT JOIN ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.ACRESOURCE R \n            ON LTRIM(REGEXP_REPLACE(A.RESOURCE_CODE, '^0*', '')) = R.RESOURCE_CODE \n         WHERE LEN(A.RESOURCE_CODE) > 0 \n       QUALIFY ROW_NUMBER() OVER(PARTITION BY SRC_EMP_ID, A.RESOURCE_CODE ORDER BY A.OBJ_ID DESC) = 1\n        ) S \n     ON T.SRC_EMP_ID = S.SRC_EMP_ID \n    AND T.RESOURCE_CD = S.RESOURCE_CD \n    AND T.ACTIVE_STATUS = 'Y' \n   WHEN MATCHED AND S.TRACKINGHASH <> HASH(T.FIRST_NAME,T.LAST_NAME,T.FINALIZEDBY) \n   THEN UPDATE SET MODIFIED_DT = TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(0)), \n                   MODIFIED_BY = CURRENT_USER(), \n                   ACTIVE_STATUS = 'N' \n   WHEN NOT MATCHED \n   THEN INSERT (SRC_EMP_ID, FIRST_NAME, LAST_NAME, \n                RESOURCE_CD, FINALIZEDBY, CREATED_DT, \n                CREATED_BY, MODIFIED_DT, MODIFIED_BY, \n                ACTIVE_STATUS\n               ) \n        VALUES (S.SRC_EMP_ID, S.FIRST_NAME, S.LAST_NAME, \n                S.RESOURCE_CD, S.FINALIZEDBY, S.CREATED_DT, \n                S.CREATED_BY, S.MODIFIED_DT, S.MODIFIED_BY, \n                S.ACTIVE_STATUS\n               );"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"6333002":{"id":6333002,"sourceID":6333043,"targetID":6333050},"6333003":{"id":6333003,"sourceID":6333050,"targetID":6333049},"6333004":{"id":6333004,"sourceID":6333049,"targetID":6333046}},"failureConnectors":{"6333009":{"id":6333009,"sourceID":6333049,"targetID":6333048},"6333010":{"id":6333010,"sourceID":6333050,"targetID":6333048},"6333011":{"id":6333011,"sourceID":6333043,"targetID":6333048}},"unconditionalConnectors":{"6333005":{"id":6333005,"sourceID":6333001,"targetID":6333047},"6333006":{"id":6333006,"sourceID":6333048,"targetID":6333001},"6333007":{"id":6333007,"sourceID":6333044,"targetID":6333043},"6333008":{"id":6333008,"sourceID":6333046,"targetID":6333045}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{},"grids":{}},"info":{"name":"jb_DIM_EMPLOYEE","description":"","type":"ORCHESTRATION","tag":"0fb80182-c575-4339-baee-ac79e15e4025"}}