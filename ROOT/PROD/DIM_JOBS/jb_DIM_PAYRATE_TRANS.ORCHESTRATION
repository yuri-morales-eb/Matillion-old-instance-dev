{"job":{"components":{"6332935":{"id":6332935,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-32,"y":240,"width":32,"height":32,"inputConnectorIDs":[6332949],"outputSuccessConnectorIDs":[6332946],"outputFailureConnectorIDs":[6332992],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Begin"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_Begin"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"RUNNING"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332936":{"id":6332936,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":160,"y":240,"width":32,"height":32,"inputConnectorIDs":[6332946],"outputSuccessConnectorIDs":[6332945],"outputFailureConnectorIDs":[6332993],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Row Count","mapTo":"audit_rowcount"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Deprecate missing Object Ids"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE ${SNFLKDB}.${SNFLKSCH}.DIM_PAYRATE_TRANS DPT \nSET DPT.MODIFIED_DT = TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(0))\n  , DPT.MODIFIED_BY = CURRENT_USER()\n  , DPT.ACTIVE_STATUS = 'N'\nWHERE DPT.ACTIVE_STATUS = 'Y' \n  AND NOT EXISTS (\n    SELECT 1\n    FROM ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.ZPYBLMATCH ZPY\n    WHERE ZPY.ATN_OBJ_ID = DPT.ATN_OBJ_ID\n  \t)\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332937":{"id":6332937,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":160,"y":144,"width":32,"height":32,"inputConnectorIDs":[6332992,6332993,6332994],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6332947],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Failure"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332938":{"id":6332938,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":400,"y":144,"width":32,"height":32,"inputConnectorIDs":[6332947],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6332950],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Failure"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_End"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"FAILURE"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332939":{"id":6332939,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":480,"y":240,"width":32,"height":32,"inputConnectorIDs":[6332944],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6332948],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Success"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_End"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"SUCCESS"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332940":{"id":6332940,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":640,"y":240,"width":32,"height":32,"inputConnectorIDs":[6332948],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332941":{"id":6332941,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":320,"y":240,"width":32,"height":32,"inputConnectorIDs":[6332945],"outputSuccessConnectorIDs":[6332944],"outputFailureConnectorIDs":[6332994],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Status","mapTo":"audit_status"},"2":{"slot":2,"fromId":null,"fromName":"Component","mapTo":"audit_component"},"3":{"slot":3,"fromId":null,"fromName":"Started At","mapTo":"audit_started"},"4":{"slot":4,"fromId":null,"fromName":"Duration","mapTo":"audit_duration"},"5":{"slot":5,"fromId":null,"fromName":"Completed At","mapTo":"audit_completed"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DIM_PAYRATE_TRANS"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\ncursor = context.cursor()\ncursor.execute(\"MERGE INTO ${SNFLKDB}.${SNFLKSCH}.DIM_PAYRATE_TRANS T USING ( SELECT DISTINCT PR.COMPANY     AS COMPANY ,PR.EMPLOYEE     AS EMPLOYEE ,PR.CHECK_ID     AS CHECK_ID     ,PR.PAY_SUM_GRP  AS PAY_SUM_GRP  ,PR.TIME_SEQ     AS TIME_SEQ     ,PR.JOB_CODE     AS JOB_CODE     ,PR.PROCESS_LEVEL AS PROCESS_LEVEL ,PR.WORK_STATE   AS WORK_STATE   ,PR.HOURS        AS HOURS        ,PR.RATE   +PR.OT_RATE     AS PAY_RATE         ,PR.WAGE_AMOUNT  AS WAGE_AMOUNT  ,PR.DEPARTMENT   AS DEPARTMENT   ,PR.PCT_DIST_FLAG AS PCT_DIST_FLAG ,PR.SHIFT         AS SHIFT        ,Z.TIMEENTRY_ID   AS SRC_TIMEENTRY_ID ,Z.TIMECARD_ID    AS SRC_TIMECARD_ID ,Z.ATN_OBJ_ID     AS ATN_OBJ_ID ,Z.PAY_CODE       AS PAY_CODE ,Z.ACCT_CAT       AS  ACCT_CAT ,Z.BILL_ONLY      AS BILL_ONLY ,Z.PAY_ONLY       AS PAY_ONLY ,TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(0)) AS CREATED_DT ,CURRENT_USER() AS CREATED_BY ,TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(0)) AS MODIFIED_DT ,CURRENT_USER() AS MODIFIED_BY ,'Y' AS ACTIVE_STATUS FROM ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.ZPYBLMATCH Z INNER JOIN ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.PRTIME PR   ON Z.COMPANY = PR.COMPANY AND Z.EMPLOYEE = PR.EMPLOYEE AND Z.CHECK_ID = PR.CHECK_ID AND Z.PAY_SUM_GRP = PR.PAY_SUM_GRP AND Z.TIME_SEQ = PR.TIME_SEQ )S ON T.TIME_SEQ=S.TIME_SEQ AND T.ATN_OBJ_ID=S.ATN_OBJ_ID  WHEN MATCHED AND ( T.COMPANY<>S.COMPANY  OR T.EMPLOYEE<>S.EMPLOYEE  OR T.CHECK_ID<>S. CHECK_ID OR T.PAY_SUM_GRP<>S.PAY_SUM_GRP  OR T.PAY_CODE<>S.PAY_CODE  OR T.JOB_CODE<>S.JOB_CODE  OR T.PROCESS_LEVEL<>S.PROCESS_LEVEL  OR T.WORK_STATE<>S.WORK_STATE  OR T.HOURS<>S.HOURS  OR T.PAY_RATE<>S.PAY_RATE  OR T.WAGE_AMOUNT<>S.WAGE_AMOUNT  OR T.DEPARTMENT<>S.DEPARTMENT  OR T.PCT_DIST_FLAG<>S.PCT_DIST_FLAG  OR T.SHIFT<>S.SHIFT  OR T.SRC_TIMEENTRY_ID<>S.SRC_TIMEENTRY_ID  OR T.SRC_TIMECARD_ID<>S.SRC_TIMECARD_ID  OR T.ACCT_CAT<>S.ACCT_CAT  OR T.BILL_ONLY<>S.BILL_ONLY  OR T.PAY_ONLY<>S.PAY_ONLY) THEN  UPDATE  SET MODIFIED_DT = TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(0)), MODIFIED_BY = CURRENT_USER(), ACTIVE_STATUS='N'  WHEN NOT MATCHED THEN INSERT ( COMPANY ,EMPLOYEE ,CHECK_ID ,PAY_SUM_GRP ,TIME_SEQ ,JOB_CODE ,PROCESS_LEVEL ,WORK_STATE ,HOURS ,PAY_RATE ,WAGE_AMOUNT ,DEPARTMENT ,PCT_DIST_FLAG ,SHIFT ,SRC_TIMEENTRY_ID ,SRC_TIMECARD_ID ,ATN_OBJ_ID ,PAY_CODE ,ACCT_CAT ,BILL_ONLY ,PAY_ONLY ,CREATED_DT ,CREATED_BY ,MODIFIED_DT ,MODIFIED_BY ,ACTIVE_STATUS ) VALUES ( S.COMPANY ,S.EMPLOYEE ,S.CHECK_ID ,S.PAY_SUM_GRP ,S.TIME_SEQ ,S.JOB_CODE ,S.PROCESS_LEVEL ,S.WORK_STATE ,S.HOURS ,S.PAY_RATE ,S.WAGE_AMOUNT ,S.DEPARTMENT ,S.PCT_DIST_FLAG ,S.SHIFT ,S.SRC_TIMEENTRY_ID ,S.SRC_TIMECARD_ID ,S.ATN_OBJ_ID ,S.PAY_CODE ,S.ACCT_CAT ,S.BILL_ONLY ,S.PAY_ONLY ,S.CREATED_DT ,S.CREATED_BY ,S.MODIFIED_DT ,S.MODIFIED_BY ,S.ACTIVE_STATUS )\")\nresult = cursor.fetchone()\n###audit_rowcount_new =  sum(audit_rowcount,int(result[0]))\ncontext.updateVariable(\"audit_rowcount\", int(result[0]))\n\n#rowcount = int(cursor.fetchone()[0])\n#print \"Updated Rows Count\" \n#print  rowcount\n\ncursor.execute(\"INSERT INTO ${SNFLKDB}.${SNFLKSCH}.DIM_PAYRATE_TRANS ( COMPANY ,EMPLOYEE ,CHECK_ID ,PAY_SUM_GRP ,TIME_SEQ ,JOB_CODE ,PROCESS_LEVEL ,WORK_STATE ,HOURS ,PAY_RATE ,WAGE_AMOUNT ,DEPARTMENT ,PCT_DIST_FLAG ,SHIFT ,SRC_TIMEENTRY_ID ,SRC_TIMECARD_ID ,ATN_OBJ_ID ,PAY_CODE ,ACCT_CAT ,BILL_ONLY ,PAY_ONLY ,CREATED_DT ,CREATED_BY ,MODIFIED_DT ,MODIFIED_BY ,ACTIVE_STATUS ) SELECT S.* FROM ${SNFLKDB}.${SNFLKSCH}.DIM_PAYRATE_TRANS T INNER JOIN ( SELECT DISTINCT PR.COMPANY     AS COMPANY ,PR.EMPLOYEE     AS EMPLOYEE ,PR.CHECK_ID     AS CHECK_ID     ,PR.PAY_SUM_GRP  AS PAY_SUM_GRP  ,PR.TIME_SEQ     AS TIME_SEQ     ,PR.JOB_CODE     AS JOB_CODE     ,PR.PROCESS_LEVEL AS PROCESS_LEVEL ,PR.WORK_STATE   AS WORK_STATE   ,PR.HOURS        AS HOURS        ,PR.RATE   + PR.OT_RATE     AS PAY_RATE         ,PR.WAGE_AMOUNT  AS WAGE_AMOUNT  ,PR.DEPARTMENT   AS DEPARTMENT   ,PR.PCT_DIST_FLAG AS PCT_DIST_FLAG ,PR.SHIFT         AS SHIFT        ,Z.TIMEENTRY_ID   AS SRC_TIMEENTRY_ID ,Z.TIMECARD_ID    AS SRC_TIMECARD_ID ,Z.ATN_OBJ_ID     AS ATN_OBJ_ID ,Z.PAY_CODE       AS PAY_CODE ,Z.ACCT_CAT       AS  ACCT_CAT ,Z.BILL_ONLY      AS BILL_ONLY ,Z.PAY_ONLY       AS PAY_ONLY ,TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(0)) AS CREATED_DT ,CURRENT_USER() AS CREATED_BY ,TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(0)) AS MODIFIED_DT ,CURRENT_USER() AS MODIFIED_BY ,'Y' AS ACTIVE_STATUS          FROM ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.ZPYBLMATCH Z INNER JOIN ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.PRTIME PR   ON Z.COMPANY = PR.COMPANY AND Z.EMPLOYEE = PR.EMPLOYEE AND Z.CHECK_ID = PR.CHECK_ID AND Z.PAY_SUM_GRP = PR.PAY_SUM_GRP AND Z.TIME_SEQ = PR.TIME_SEQ )S ON T.TIME_SEQ=S.TIME_SEQ AND T.ATN_OBJ_ID=S.ATN_OBJ_ID  AND (T.COMPANY<>S.COMPANY  OR T.EMPLOYEE<>S.EMPLOYEE  OR T.CHECK_ID<>S. CHECK_ID OR T.PAY_SUM_GRP<>S.PAY_SUM_GRP  OR T.PAY_CODE<>S.PAY_CODE  OR T.JOB_CODE<>S.JOB_CODE  OR T.PROCESS_LEVEL<>S.PROCESS_LEVEL  OR T.WORK_STATE<>S.WORK_STATE  OR T.HOURS<>S.HOURS  OR T.PAY_RATE<>S.PAY_RATE  OR T.WAGE_AMOUNT<>S.WAGE_AMOUNT  OR T.DEPARTMENT<>S.DEPARTMENT  OR T.PCT_DIST_FLAG<>S.PCT_DIST_FLAG  OR T.SHIFT<>S.SHIFT  OR T.SRC_TIMEENTRY_ID<>S.SRC_TIMEENTRY_ID  OR T.SRC_TIMECARD_ID<>S.SRC_TIMECARD_ID  OR T.ACCT_CAT<>S.ACCT_CAT  OR T.BILL_ONLY<>S.BILL_ONLY  OR T.PAY_ONLY<>S.PAY_ONLY) WHERE T.MODIFIED_DT = (SELECT MAX(MODIFIED_DT) FROM ${SNFLKDB}.${SNFLKSCH}.DIM_PAYRATE_TRANS WHERE TIME_SEQ =S.TIME_SEQ AND ATN_OBJ_ID=S.ATN_OBJ_ID)\")\nresult = cursor.fetchone()\ncontext.updateVariable(\"audit_rowcount1\", int(result[0]))\n\n#rowcount = int(cursor.fetchone()[0])\n#print \"New Rows Count\" \n#print  rowcount\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332942":{"id":6332942,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":560,"y":144,"width":32,"height":32,"inputConnectorIDs":[6332950],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6332943":{"id":6332943,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-160,"y":240,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6332949],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"6332944":{"id":6332944,"sourceID":6332941,"targetID":6332939},"6332945":{"id":6332945,"sourceID":6332936,"targetID":6332941},"6332946":{"id":6332946,"sourceID":6332935,"targetID":6332936}},"failureConnectors":{"6332992":{"id":6332992,"sourceID":6332935,"targetID":6332937},"6332993":{"id":6332993,"sourceID":6332936,"targetID":6332937},"6332994":{"id":6332994,"sourceID":6332941,"targetID":6332937}},"unconditionalConnectors":{"6332947":{"id":6332947,"sourceID":6332937,"targetID":6332938},"6332948":{"id":6332948,"sourceID":6332939,"targetID":6332940},"6332949":{"id":6332949,"sourceID":6332943,"targetID":6332935},"6332950":{"id":6332950,"sourceID":6332938,"targetID":6332942}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{},"grids":{}},"info":{"name":"jb_DIM_PAYRATE_TRANS","description":"","type":"ORCHESTRATION","tag":"b3c281e2-ee20-4555-8960-442120686655"}}