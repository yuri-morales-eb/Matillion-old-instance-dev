{"job":{"components":{"6341664":{"id":6341664,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":64,"y":32,"width":32,"height":32,"inputConnectorIDs":[6341680],"outputSuccessConnectorIDs":[6341678],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get row number"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print (myvar)\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print (context.getGridVariable('mygridvar'))\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\n\n\ncontext.updateVariable('initial_row_count', audit_rowcount)\n\nprint(f\"Rows to upload: {initial_row_count}\")\n\n\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341665":{"id":6341665,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":320,"y":-64,"width":32,"height":32,"inputConnectorIDs":[6341683,6341689,6341690],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6341685],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341666":{"id":6341666,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":-64,"y":32,"width":32,"height":32,"inputConnectorIDs":[6341676],"outputSuccessConnectorIDs":[6341680],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Num rows to delete"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WITH CTE_CUSTOMER_DATA AS (WITH CTE_EB_TRANSACTIONS AS (SELECT ACACT.LEVEL_DETAIL_02  AS CUSTOMER_NUMBER,\n                                                               MAX(ACTR.POSTING_DATE) AS POSTING_DATE\n                                                        FROM PROD_DATALAKE.LAWPROD.ACACTIVITY ACACT\n                                                                 INNER JOIN PROD_DATALAKE.LAWPROD.ACTRANS ACTR\n                                                                            ON ACTR.ACTIVITY = ACACT.ACTIVITY\n                                                        GROUP BY ACACT.LEVEL_DETAIL_02),\n                                CTE_EB_TRANSACTION_DIM_DATE AS (SELECT EBT.CUSTOMER_NUMBER AS CUSTOMER_NUMBER,\n                                                                       EBT.POSTING_DATE    AS POSTING_DATE,\n                                                                       DD.FISCAL_PERIOD    AS FISCAL_PERIOD,\n                                                                       DD.FISCAL_YEAR      AS FISCAL_YEAR\n                                                                FROM CTE_EB_TRANSACTIONS EBT\n                                                                         LEFT JOIN PROD_EDW.ENT.DATE_DIM DD\n                                                                                   ON EBT.POSTING_DATE = DD.DATE),\n                                CTE_ALL_CUSTOMERS_SOURCE AS (SELECT LWC.CUSTOMER_NUMBER                                              AS CUSTOMER_NUMBER,\n                                                                    LWC.CUSTOMER_NAME                                                AS CUSTOMER_NAME,\n                                                                    IFF(EBTDD.CUSTOMER_NUMBER IS NOT NULL, 'Traditional', 'Digital') AS SOURCE,\n                                                                    EBTDD.FISCAL_PERIOD                                              AS FISCAL_PERIOD,\n                                                                    EBTDD.FISCAL_YEAR                                                AS FISCAL_YEAR\n                                                             FROM PROD_ENTERPRISE.ADAPTIVE.VW_LAW_CUSTOMER LWC\n                                                                      LEFT JOIN CTE_EB_TRANSACTION_DIM_DATE EBTDD\n                                                                                ON LWC.CUSTOMER_NUMBER = EBTDD.CUSTOMER_NUMBER),\n                                CTE_ALL_CUSTOMERS AS (SELECT CS.CUSTOMER_NUMBER,\n                                                             CS.CUSTOMER_NAME,\n                                                             CS.SOURCE\n                                                      FROM CTE_ALL_CUSTOMERS_SOURCE CS\n                                                      WHERE (CS.FISCAL_YEAR IS NULL OR CS.FISCAL_YEAR >= 2024)\n                                                        AND (CS.FISCAL_PERIOD IS NULL OR CS.FISCAL_PERIOD < (SELECT TO_NUMBER(DD.FISCAL_PERIOD) AS FISCAL_PERIOD\n                                                                                                             FROM PROD_EDW.ENT.DATE_DIM DD\n                                                                                                             WHERE DD.DATE = CURRENT_DATE()))),\n                               /* Duplicates (if needed): Finding duplicates in final dataset*/\n                                CTE_STEP1_DUPES_FINAL_SET AS (SELECT C.CUSTOMER_NUMBER AS CUSTOMER_NUMBER,\n                                                                     COUNT(1)          AS COUNT\n                                                              FROM CTE_ALL_CUSTOMERS C\n                                                              GROUP BY C.CUSTOMER_NUMBER\n                                                              HAVING COUNT > 1),\n                               /* Ignoring duplicates from final dataset to dedup later */\n                                CTE_STEP2_IGNORING_DUPES_FINAL_SET AS (SELECT ALLCUST.*\n                                                                       FROM CTE_ALL_CUSTOMERS ALLCUST\n                                                                       WHERE ALLCUST.CUSTOMER_NUMBER NOT IN (SELECT DISTINCT DF.CUSTOMER_NUMBER FROM CTE_STEP1_DUPES_FINAL_SET DF)),\n                               /* Applying deduping rule: keep the row from EB (Traditional) */\n                                CTE_STEP3_DEDUPING_DUPES_FINAL_SET AS (SELECT ALLCUST.CUSTOMER_NUMBER AS CUSTOMER_NUMBER,\n                                                                              ALLCUST.CUSTOMER_NAME   AS CUSTOMER_NAME,\n                                                                              ALLCUST.SOURCE          AS SOURCE\n                                                                       FROM CTE_ALL_CUSTOMERS ALLCUST\n                                                                       WHERE ALLCUST.SOURCE = 'Traditional'\n                                                                         AND ALLCUST.CUSTOMER_NUMBER IN (SELECT DISTINCT DF.CUSTOMER_NUMBER FROM CTE_STEP1_DUPES_FINAL_SET DF)),\n                               /* Union both datasets: the one with no duplicates + the one with duplicates worked */\n                                CTE_STEP4_FINAL_SET AS (SELECT IDF.CUSTOMER_NUMBER AS CUSTOMER_NUMBER,\n                                                               IDF.CUSTOMER_NAME   AS CUSTOMER_NAME,\n                                                               IDF.SOURCE          AS SOURCE\n                                                        FROM CTE_STEP2_IGNORING_DUPES_FINAL_SET IDF\n                                                        UNION ALL\n                                                        SELECT D.CUSTOMER_NUMBER AS CUSTOMER_NUMBER,\n                                                               D.CUSTOMER_NAME   AS CUSTOMER_NAME,\n                                                               D.SOURCE          AS SOURCE\n                                                        FROM CTE_STEP3_DEDUPING_DUPES_FINAL_SET D)\n                           SELECT FS.CUSTOMER_NUMBER AS CUSTOMER_NUMBER,\n                                  FS.CUSTOMER_NAME   AS CUSTOMER_NAME,\n                                  FS.SOURCE          AS SOURCE\n                           FROM CTE_STEP4_FINAL_SET FS),\n     CTE_CY_WC_CODES AS (WITH CTE_RANK AS (WITH CTE_TEMP_DATE_SHEET AS (SELECT TO_DATE(DATE_TRUNC(MONTH, CURRENT_DATE() - 30))       AS CY_CM,\n                                                                               DATE_FROM_PARTS(YEAR(CY_CM), MONTH(CY_CM) - 1, 1)     AS CY_PM,\n                                                                               DATE_FROM_PARTS(YEAR(CY_CM) - 1, MONTH(CY_CM), 1)     AS PY_CM,\n                                                                               DATE_FROM_PARTS(YEAR(CY_CM) - 1, MONTH(CY_CM) - 1, 1) AS PY_PM,\n                                                                               DATE_FROM_PARTS(YEAR(CY_CM) - 2, MONTH(CY_CM), 1)     AS PPY_CM,\n                                                                               DATE_FROM_PARTS(YEAR(CY_CM) - 2, MONTH(CY_CM) - 1, 1) AS PPY_PM,\n                                                                               DATE_FROM_PARTS(YEAR(CY_CM) - 3, MONTH(CY_CM), 1)     AS _3PY_CM,\n                                                                               DATE_FROM_PARTS(YEAR(CY_CM) - 3, MONTH(CY_CM) - 1, 1) AS _3PY_PM)\n                                           SELECT FPR.CUST_ID       AS CUST_ID,\n                                                  FPR.WC_CODE       AS WC_CODE,\n                                                  SUM(FPR.BILL_AMT) AS REV\n                                           FROM DATALAKE.PUBLIC.REPORT_FPR FPR\n                                                    LEFT JOIN PROD_EDW.ENT.DATE_DIM DD\n                                                              ON DD.DATE = FPR.NORM_POSTING_DATE\n                                                                  AND DD.DW_ACTIVE_FLAG = 'Y'\n                                           WHERE DD.FISCAL_YEAR IN (SELECT YEAR(TDS.CY_CM) FROM CTE_TEMP_DATE_SHEET TDS)\n                                             AND DD.FISCAL_PERIOD IN (SELECT MONTH(TDS.CY_CM) FROM CTE_TEMP_DATE_SHEET TDS)\n                                             AND FPR.WC_CODE IS NOT NULL\n                                             AND FPR.WC_CODE <> ''\n                                           GROUP BY CUST_ID,\n                                                    WC_CODE)\n                         SELECT R.CUST_ID                                                                   AS CUST_ID,\n                                R.WC_CODE                                                                   AS WC_CODE,\n                                ROW_NUMBER() OVER (PARTITION BY R.CUST_ID ORDER BY COALESCE(R.REV, 0) DESC) AS REV_RANK\n                         FROM CTE_RANK R\n                         QUALIFY REV_RANK = 1),\n     CTE_NAICS_DATA AS (SELECT DISTINCT CSFD.ACCOUNT_NUMBER                AS CUSTOMER_NUMBER,\n                                        CSFD.INDUSTCODES_NAICS_PRIORITY1_C AS INDUSTCODES_NAICS_PRIORITY1_C,\n                                        DN.SIX_DIGIT_NAICS_CODE            AS SIX_DIGIT_NAICS_CODE,\n                                        DN.INDUSTRY                        AS INDUSTRY,\n                                        DN.SEGMENT                         AS SEGMENT,\n                                        DN.SUB_SEGMENT                     AS SUB_SEGMENT\n                        FROM PROD_EDW.ENT.CUSTOMER_SF_DIM CSFD\n                                 LEFT JOIN DEV_SANDBOX_MERILYTICS.DATAWAREHOUSE.DIM_NAICS_DESC DN\n                                           ON CSFD.INDUSTCODES_NAICS_PRIORITY1_C = DN.SIX_DIGIT_NAICS_CODE\n                        WHERE CSFD.DW_ACTIVE_FLAG = 'Y'\n                          AND CSFD.DW_DATA_SOURCE_KEY = '2'),\n     CTE_DATA_TRANSFORMATION AS (SELECT C.CUSTOMER_NUMBER                                                                                            AS CUSTOMER_CODE,\n                                        C.CUSTOMER_NAME                                                                                              AS CUSTOMER_NAME,\n                                        IFF(C.SOURCE = 'Digital', NULL, (CASE\n                                                                             WHEN UPPER(LDGCM.ACCOUNT_TYPE) IN ('VIP', 'VIP/VMS', 'VIP/NPG', 'VIP/HYBRID') THEN 'VIP'\n                                                                             WHEN UPPER(LDGCM.ACCOUNT_TYPE) IN ('RETAIL', 'VMS') THEN LDGCM.ACCOUNT_TYPE\n                                                                             WHEN LDGCM.ACCOUNT_TYPE IS NULL THEN 'Retail'\n                                                                             WHEN UPPER(LDGCM.ACCOUNT_TYPE) IN ('NPG', 'HYBRID') THEN 'NPG'\n                                            END))                                                                                                    AS ACCOUNT_TYPE_ROLLUP_NAME,\n                                        REPLACE(ACCOUNT_TYPE_ROLLUP_NAME, ' ', '_')                                                                  AS ACCOUNT_TYPE_ROLLUP_TAG,\n                                        IFF(ACCOUNT_TYPE_ROLLUP_NAME = 'VIP', 'eBMax', NULL)                                                         AS EBMAX_NAME,\n                                        REPLACE(EBMAX_NAME, ' ', '_')                                                                                AS EBMAX_TAG,\n                                        IFF(C.SOURCE = 'Digital', NULL,\n                                            IFF(LDGCM.ACCOUNT_MGMT_FOCUS IS NULL OR LDGCM.ACCOUNT_MGMT_FOCUS = 'N', 'Non-Enterprise', 'Enterprise')) AS ENTERPRISE_NAME,\n                                        REPLACE(ENTERPRISE_NAME, ' ', '_')                                                                           AS ENTERPRISE_TAG,\n                                        IFF(C.SOURCE = 'Digital', NULL, IFF(LDGCM.ACCOUNT_TYPE = 'HYBRID', 'Hybrid',\n                                                                            IFF(LDGCM.ACCOUNT_TYPE IS NULL, 'Retail', LDGCM.ACCOUNT_TYPE)))          AS ACCOUNT_TYPE_NAME,\n                                        REPLACE(ACCOUNT_TYPE_NAME, ' ', '_')                                                                         AS ACCOUNT_TYPE_TAG,\n                                        WCC.WC_CODE                                                                                                  AS WC_CODE,\n                                        WCCLAS.CLASSIFICATION                                                                                        AS WC_CODE_CLASSIFICATION,\n                                        REPLACE(WCCLAS.CLASSIFICATION, ' ', '_')                                                                     AS WC_CODE_CLASSIFICATION_TAG,\n                                        WCCLAS.CONSOLIDATED_CLASSIFICATION                                                                           AS WC_CODE_CONSOLIDATED_CLASSIFICATION,\n                                        REPLACE(WCCLAS.CONSOLIDATED_CLASSIFICATION, ' ', '_')                                                        AS WC_CODE_CONSOLIDATED_CLASSIFICATION_TAG,\n                                        LDGCM.PARENT_ID                                                                                              AS PARENT_CODE,\n                                        LDGCM.PARENT_NAME                                                                                            AS PARENT_NAME,\n                                        NAICS.INDUSTRY                                                                                               AS INDUSTRY,\n                                        NAICS.SEGMENT                                                                                                AS SEGMENT,\n                                        NAICS.SUB_SEGMENT                                                                                            AS SUB_SEGMENT,\n                                        C.SOURCE                                                                                                     AS DIGITAL_TAG\n                                 FROM CTE_CUSTOMER_DATA C\n                                          LEFT JOIN PROD_NPG_VIP.LDG.NPG_VIP_DL_LDG_CLIENT_MASTER LDGCM\n                                                    ON C.CUSTOMER_NUMBER = LDGCM.CUSTOMER_ID\n                                          LEFT JOIN CTE_CY_WC_CODES WCC\n                                                    ON C.CUSTOMER_NUMBER = WCC.CUST_ID\n                                          LEFT JOIN ${DB_Enterprise}.ADAPTIVE.WORKERS_COMP_CODES WCCLAS\n                                                    ON WCC.WC_CODE = WCCLAS.WC_CODE\n                                          LEFT JOIN CTE_NAICS_DATA NAICS\n                                                    ON LDGCM.CUSTOMER_ID = NAICS.CUSTOMER_NUMBER)\nSELECT COUNT(*) AS num_rows\nFROM CTE_DATA_TRANSFORMATION DT\n"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_rowcount"},"2":{"slot":2,"type":"STRING","value":"NUM_ROWS"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341667":{"id":6341667,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-160,"y":32,"width":32,"height":32,"inputConnectorIDs":[6341687],"outputSuccessConnectorIDs":[6341676],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Begin"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_Begin"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"RUNNING"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341668":{"id":6341668,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-256,"y":32,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6341687],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341669":{"id":6341669,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":864,"y":-64,"width":32,"height":32,"inputConnectorIDs":[6341684],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341670":{"id":6341670,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":688,"y":80,"width":32,"height":32,"inputConnectorIDs":[6341682],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6341688],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Success"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_End"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"SUCCESS"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341671":{"id":6341671,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":560,"y":-64,"width":32,"height":32,"inputConnectorIDs":[6341685],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6341686],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Prep Audit Failure"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select 0 as num_rows"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_rowcount"},"2":{"slot":2,"type":"STRING","value":"NUM_ROWS"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341672":{"id":6341672,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":448,"y":80,"width":32,"height":32,"inputConnectorIDs":[6341677],"outputSuccessConnectorIDs":[6341679],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Prep Audit Success"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select count(*) as num_rows\nfrom ${DB_Enterprise}.${SCH_ADAPTIVE}.CUSTOMER_SEGMENTATION\n"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_rowcount"},"2":{"slot":2,"type":"STRING","value":"NUM_ROWS"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341673":{"id":6341673,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":864,"y":80,"width":32,"height":32,"inputConnectorIDs":[6341688],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341674":{"id":6341674,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":320,"y":32,"width":32,"height":32,"inputConnectorIDs":[6341681],"outputSuccessConnectorIDs":[6341677],"outputFailureConnectorIDs":[6341690],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jb_Customer_Segmentation_load"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jb_Customer_Segmentation_load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341675":{"id":6341675,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":688,"y":-64,"width":32,"height":32,"inputConnectorIDs":[6341686],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6341684],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Failure"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_End"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"FAILURE"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341699":{"id":6341699,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":237373210,"x":176,"y":32,"width":32,"height":32,"inputConnectorIDs":[6341678],"outputSuccessConnectorIDs":[6341681],"outputFailureConnectorIDs":[6341689],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate Table"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${DB_Enterprise}"}}}},"visible":true},"4":{"slot":4,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SCH_ADAPTIVE}"}}}},"visible":true},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOMER_SEGMENTATION"}}}},"visible":true},"6":{"slot":6,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341700":{"id":6341700,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":560,"y":80,"width":32,"height":32,"inputConnectorIDs":[6341679],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[6341682],"outputFalseConnectorIDs":[6341683],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If 0"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{},"visible":false},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":false},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${initial_row_count} == ${audit_rowcount}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"6341676":{"id":6341676,"sourceID":6341667,"targetID":6341666},"6341677":{"id":6341677,"sourceID":6341674,"targetID":6341672},"6341678":{"id":6341678,"sourceID":6341664,"targetID":6341699},"6341679":{"id":6341679,"sourceID":6341672,"targetID":6341700},"6341680":{"id":6341680,"sourceID":6341666,"targetID":6341664},"6341681":{"id":6341681,"sourceID":6341699,"targetID":6341674}},"failureConnectors":{"6341689":{"id":6341689,"sourceID":6341699,"targetID":6341665},"6341690":{"id":6341690,"sourceID":6341674,"targetID":6341665}},"unconditionalConnectors":{"6341684":{"id":6341684,"sourceID":6341675,"targetID":6341669},"6341685":{"id":6341685,"sourceID":6341665,"targetID":6341671},"6341686":{"id":6341686,"sourceID":6341671,"targetID":6341675},"6341687":{"id":6341687,"sourceID":6341668,"targetID":6341667},"6341688":{"id":6341688,"sourceID":6341670,"targetID":6341673}},"trueConnectors":{"6341682":{"id":6341682,"sourceID":6341700,"targetID":6341670}},"falseConnectors":{"6341683":{"id":6341683,"sourceID":6341700,"targetID":6341665}},"iterationConnectors":{},"noteConnectors":{},"notes":{"6341698":{"id":6341698,"x":-255,"y":-178,"width":406,"height":111,"text":"**Jb_Adaptive_Customer_Segmentation**\n1. Target table: ADAPTIVE.CUSTOMER_SEGMENTATION. \n2. Schedule: monthly\n\n**NOTE:** The table CUSTOMER_SEGMENTATION is truncated and reloaded.\n","colour":"e6e63c"}},"variables":{"initial_row_count":{"definition":{"name":"initial_row_count","type":"DECIMAL","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"-1"}},"grids":{}},"info":{"name":"Jb_Adaptive_Customer_Segmentation","description":"","type":"ORCHESTRATION","tag":"9110a71c-924d-43b3-a4f0-beb8b53f4414"}}