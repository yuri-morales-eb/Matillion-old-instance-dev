{"job":{"components":{"6341325":{"id":6341325,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-48,"y":-80,"width":32,"height":32,"inputConnectorIDs":[6341309,6341310,6341311,6341351,6341352,6341353],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6341306],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Failurepath 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341326":{"id":6341326,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":773867971,"x":80,"y":48,"width":32,"height":32,"inputConnectorIDs":[6341341],"outputSuccessConnectorIDs":[6341340],"outputFailureConnectorIDs":[6341311],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load from S3 to Snowflake"}}}},"visible":true},"4":{"slot":4,"name":"S3 Object Prefix","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://etld1/"}}}},"visible":true},"5":{"slot":5,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SNFLKDB_PDL}"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SFSCHCONCUR}"}}}},"visible":true},"8":{"slot":8,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LDG_REQUESTED_VENDOR"}}}},"visible":true},"9":{"slot":9,"name":"Load Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ADDRESS_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"VENDOR_NAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ADDRESS_1"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ADDRESS_2"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ADDRESS_3"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"CITY"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"STATE"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"POSTAL_CODE"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"COUNTRY"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"CONTACT_FIRST_NAME"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"CONTACT_LAST_NAME"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"PHONE_NUMBER"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_1"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_2"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_3"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_4"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_5"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_6"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_7"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_8"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_9"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_10"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_11"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_12"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_13"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_14"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_15"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"ADDRESS_CREATE_DATE"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"CREATED_BY_EMPLOYEE_ID"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"IMAGE_AVAILABLE"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"TAX_ID"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"SHIPPING_TERMS_CODE"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"SHIPPING_METHOD"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"NET_PAYMENT_TERMS"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"DISCOUNT_TERMS"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"DISCOUNT_PERCENTAGE"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"PO_CONTACT_FIRST_NAME"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"PO_CONTACT_LAST_NAME"}}},"39":{"slot":39,"values":{"1":{"slot":1,"type":"STRING","value":"PO_CONTACT_EMAIL"}}},"40":{"slot":40,"values":{"1":{"slot":1,"type":"STRING","value":"PO_CONTACT_PHONE_NUMBER"}}},"41":{"slot":41,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_16"}}},"42":{"slot":42,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_17"}}},"43":{"slot":43,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_18"}}},"44":{"slot":44,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_19"}}},"45":{"slot":45,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOM_20"}}},"46":{"slot":46,"values":{"1":{"slot":1,"type":"STRING","value":"FUTURE_USE_16"}}},"47":{"slot":47,"values":{"1":{"slot":1,"type":"STRING","value":"FUTURE_USE_17"}}},"48":{"slot":48,"values":{"1":{"slot":1,"type":"STRING","value":"FUTURE_USE_18"}}},"49":{"slot":49,"values":{"1":{"slot":1,"type":"STRING","value":"FUTURE_USE_19"}}},"50":{"slot":50,"values":{"1":{"slot":1,"type":"STRING","value":"FUTURE_USE_20"}}}},"visible":true},"10":{"slot":10,"name":"Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"11":{"slot":11,"name":"File Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CSV"}}}},"visible":true},"12":{"slot":12,"name":"Compression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUTO"}}}},"visible":true},"20":{"slot":20,"name":"Record Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"21":{"slot":21,"name":"Field Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"|"}}}},"visible":true},"22":{"slot":22,"name":"Skip Header","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"1"}}}},"visible":true},"23":{"slot":23,"name":"Date Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"YYYY-MM-DD"}}}},"visible":true},"24":{"slot":24,"name":"Time Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"25":{"slot":25,"name":"Timestamp Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"26":{"slot":26,"name":"","elements":{},"visible":false},"27":{"slot":27,"name":"Escape","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR_OR_ESCAPE_SEQUENCE","value":""}}}},"visible":true},"28":{"slot":28,"name":"Escape Unenclosed Field","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR_OR_ESCAPE_SEQUENCE","value":""}}}},"visible":true},"29":{"slot":29,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"30":{"slot":30,"name":"Field Optionally Enclosed","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR","value":""}}}},"visible":true},"31":{"slot":31,"name":"Null If","elements":{},"visible":true},"32":{"slot":32,"name":"Error On Column Count Mismatch","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"33":{"slot":33,"name":"Empty Field as Null","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"34":{"slot":34,"name":"Encoding Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"35":{"slot":35,"name":"Skip Blank Lines","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"36":{"slot":36,"name":"Replace Invalid Characters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"40":{"slot":40,"name":"Enable Octal","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"41":{"slot":41,"name":"Allow Duplicates","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"42":{"slot":42,"name":"Strip Outer Array","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"43":{"slot":43,"name":"Strip Null Values","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"44":{"slot":44,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"45":{"slot":45,"name":"Nest Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"46":{"slot":46,"name":"Null If","elements":{},"visible":false},"47":{"slot":47,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"50":{"slot":50,"name":"Null If","elements":{},"visible":false},"51":{"slot":51,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"60":{"slot":60,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"61":{"slot":61,"name":"Preserve Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"62":{"slot":62,"name":"Strip Outer Element","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"63":{"slot":63,"name":"Disable Snowflake Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"64":{"slot":64,"name":"Disable Auto Convert","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"66":{"slot":66,"name":"Null If","elements":{},"visible":false},"67":{"slot":67,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"70":{"slot":70,"name":"Null If","elements":{},"visible":false},"71":{"slot":71,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"120":{"slot":120,"name":"On Error","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Abort Statement"}}}},"visible":true},"121":{"slot":121,"name":"n","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":false},"122":{"slot":122,"name":"Size Limit (B)","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"123":{"slot":123,"name":"Purge Files","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"124":{"slot":124,"name":"Truncate Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"125":{"slot":125,"name":"Force Load","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"126":{"slot":126,"name":"Match By Column Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"140":{"slot":140,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"141":{"slot":141,"name":"Master Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"142":{"slot":142,"name":"KMS Key Id","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"143":{"slot":143,"name":"Authentication","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Credentials"}}}},"visible":true},"144":{"slot":144,"name":"Storage Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"200":{"slot":200,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"201":{"slot":201,"name":"Pattern","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concur/requested_vendor/${concur_requested_vendor_filename}"}}}},"visible":true},"203":{"slot":203,"name":"Metadata Fields","elements":{},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341327":{"id":6341327,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-544,"y":48,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6341305],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341328":{"id":6341328,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":656,"y":-80,"width":32,"height":32,"inputConnectorIDs":[6341306],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341329":{"id":6341329,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":656,"y":48,"width":32,"height":32,"inputConnectorIDs":[6341342],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341330":{"id":6341330,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":240,"y":48,"width":32,"height":32,"inputConnectorIDs":[6341340],"outputSuccessConnectorIDs":[6341339],"outputFailureConnectorIDs":[6341310],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jb_Concur_Requested_Vendor_Insert"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jb_Concur_Requested_Vendor_Insert"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341331":{"id":6341331,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-160,"y":48,"width":32,"height":32,"inputConnectorIDs":[6341308],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[6341301],"outputFalseConnectorIDs":[6341304],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If Rules Without Errors"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rules_passed"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"True"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341332":{"id":6341332,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-432,"y":48,"width":32,"height":32,"inputConnectorIDs":[6341305],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[6341302],"outputFalseConnectorIDs":[6341303],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If Apply Data Quality Rules"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"apply_rules"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"True"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341333":{"id":6341333,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":237373210,"x":-48,"y":48,"width":32,"height":32,"inputConnectorIDs":[6341307],"outputSuccessConnectorIDs":[6341341],"outputFailureConnectorIDs":[6341353],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate RAW"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SNFLKDB_PDL}"}}}},"visible":true},"4":{"slot":4,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SFSCHCONCUR}"}}}},"visible":true},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LDG_REQUESTED_VENDOR"}}}},"visible":true},"6":{"slot":6,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341334":{"id":6341334,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":528,"y":48,"width":32,"height":32,"inputConnectorIDs":[6341343],"outputSuccessConnectorIDs":[6341342],"outputFailureConnectorIDs":[6341352],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Completed At","mapTo":"audit_completed"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delete from S3"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import boto3\nfrom datetime import datetime, timedelta\n\ns3_session = boto3.Session()\ns3_resource = s3_session.resource('s3')\ns3_client = s3_session.client('s3')\n\ns3_bucket_name= s3_URL.replace(\"s3:\", '').strip('/')\nbucket = s3_resource.Bucket(s3_bucket_name)\n\nsource_folder = 'Concur/requested_vendor'\n\ndrop_date = (datetime.today() - timedelta(days=0)).strftime('%Y%m%d')\nprint('Drop input path date is ', drop_date)\n\nkept_days = 365\ndrop_archive_date = (datetime.today() - timedelta(days=kept_days)).strftime('%Y%m%d')\nprint('Drop archive path date is ', drop_archive_date)\n\nfor obj in bucket.objects.filter(Prefix=source_folder):\n#\tprint(obj.key)\n    try:\n        if obj.key.endswith('.cdata'): \n            src_file = os.path.basename(obj.key)\n      \t\t# This conditional is to remove files moved to the archive folder\n            if not obj.key.endswith('Concur/requested_vendor/Archive/'):\n                if src_file == concur_requested_vendor_filename:\n                    name, extension = os.path.splitext(obj.key)\n                    src_source_file_path = source_folder +'/'+ src_file\n                    s3_client.delete_object(Bucket=s3_bucket_name, Key=src_source_file_path)\n                    print('Successfully Deleted: ', obj.key)    \n            # This conditional is to purge in the archive folder files older than 365 days\n            else:\n                file_date = obj.last_modified.strftime('%Y%m%d')\n                if len(src_file) > 0 and file_date <= drop_archive_date:\n                    s3_client.delete_object(Bucket=s3_bucket_name, Key=obj.key)\n                    print(f'\\n****Archived file {src_file} with more than {kept_days} days old deleted...!')\n    except:\n        print('Error Deleting file : ' + src_file)\n\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341335":{"id":6341335,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":384,"y":48,"width":32,"height":32,"inputConnectorIDs":[6341339],"outputSuccessConnectorIDs":[6341343],"outputFailureConnectorIDs":[6341351],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Archive Files"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import boto3\n\ns3_client = boto3.Session()\ns3 = s3_client.resource('s3')\ns3_bucket_name= s3_URL.replace(\"s3:\", '').strip('/')\nbucket = s3.Bucket(s3_bucket_name)\ns3_resource = boto3.resource('s3')\n\nsource_folder = 'Concur/requested_vendor'\narchive_folder = 'Concur/requested_vendor/Archive'\n\ntime_now = datetime.datetime.now().strftime('_%Y%m%d')\n\n\nfor obj in bucket.objects.filter(Prefix=source_folder):\n\ttry:\n\t\tif not obj.key.startswith('Concur/requested_vendor/Archive'):\n\t\t\tsrc_file = os.path.basename(obj.key)\n\t\t\tname, extension = os.path.splitext(obj.key)\n\t\t\tif extension =='.cdata' and src_file == concur_requested_vendor_filename:\n\t\t\t\ts3_src_file_path = source_folder +'/'+ src_file\n\t\t\t\tdest_file = src_file[:-5] + time_now + '.cdata'\n\t\t\t\tprint('Archiving File:  ' + name)\n\t\t\t\n\t\t\t\ts3_dest_file_path = archive_folder +'/'+ dest_file\n\n\n\t\t\t\tobj_data = obj.get()['Body'].read()\n\n\n\t\t\t\td = boto3.Session()\n\t\t\t\ta = d.client('s3')\n\t\t\t\tres = a.put_object(Bucket=s3_bucket_name, Body=obj_data, Key=s3_dest_file_path)\n\t\t\t\tprint('Successfully Archived... ')\n\n            \n\texcept:\n\t\tprint('Error Archiving file : ' + src_file)\n\nprint('\\n****File successfully archived...!')\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341336":{"id":6341336,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":-288,"y":48,"width":32,"height":32,"inputConnectorIDs":[6341302],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6341308],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Data Quality Rules"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import pandera as pa\nfrom pandera import Column, DataFrameSchema, Check\nimport pandas as pd\nimport numpy as np\nimport boto3\nimport os\nfrom io import StringIO\nimport logging\n\n# Define the schema based on the table definition\nschema = DataFrameSchema({\n    0: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 20)),\n    1: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 255)),\n    2: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 255)),\n    3: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 255)),\n    4: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 255)),\n    5: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 255)),\n    6: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 255)),\n    7: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 20)),\n    8: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 2)),\n    9: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 255)),\n    10: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 255)),\n    11: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 12)),\n    12: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    13: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    14: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    15: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    16: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    17: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    18: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    19: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    20: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    21: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    22: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    23: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    24: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    25: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    26: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    27: Column(pa.DateTime, coerce=True, nullable=True),\n    28: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    29: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 1)),\n    30: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    31: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 10)),\n    32: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 10)),\n    33: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 255)),\n    34: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 255)),\n    35: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 11)),\n    36: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 255)),\n    37: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 255)),\n    38: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 255)),\n    39: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 25)),\n    40: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    41: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    42: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    43: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    44: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 48)),\n    45: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 3)),\n    46: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 255)),\n    47: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 255)),\n    48: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 255)),\n    49: Column(pa.String, coerce=True, nullable=True, checks=Check.str_length(0, 255))\n})\n\n# Setup logging\nlogging.basicConfig(level=logging.INFO, format='%(levelname)s: %(message)s')\n\n# Configuration\nsession = boto3.Session()\ns3 = session.resource('s3')\ns3_bucket_name = s3_URL.replace(\"s3:\", '').strip('/')\nbucket = s3.Bucket(s3_bucket_name)\ns3_resource = boto3.resource('s3')\n\nSOURCE_FOLDER = 'Concur/requested_vendor'\nARCHIVE_FOLDER = f'{SOURCE_FOLDER}/Archive'\nDATA_QUALITY = f'{SOURCE_FOLDER}/DataQuality'\n\n#function to read file from bucket\ndef read_s3_data_file():\n    \"\"\"Read a specific file from S3 and return it as a DataFrame.\"\"\"\n    try:\n        client = session.client('s3')\n\n        response = client.get_object(Bucket=s3_bucket_name, Key=SOURCE_FOLDER+\"/\"+concur_requested_vendor_filename)\n        content = response['Body'].read().decode('utf-8')\n        df_csv_data = pd.read_csv(StringIO(content), skiprows=1, header=None, sep='|')\n        logging.info(f'Successfully read file from S3: {concur_requested_vendor_filename}')\n        return df_csv_data\n\n    except Exception as e:\n        logging.error(f'Failed to read S3 file: {e}')\n    return None\n\n#Function to write log file with dataQA errors\ndef write_results_to_s3(df, filename):\n    \"\"\"Write the DataFrame to S3.\"\"\"\n    try:\n        client = session.client('s3')\n        csv_buffer = StringIO()\n        df.to_csv(csv_buffer, index=False)\n        #df.to_csv(f\"{s3_URL}{DATA_QUALITY}/{filename}\", index=False)\n        res = client.put_object(Bucket=s3_bucket_name, Body=csv_buffer.getvalue(), Key=f'{DATA_QUALITY}/{filename}')\n        logging.info(f'Successfully wrote results to S3: {filename}')\n    except Exception as e:\n        logging.error(f'Failed to write results to S3: {e}')\n\n#Main function\ndef main():\n    # Read data\n    df_data = read_s3_data_file()\n    validated_df = None\n    if df_data is not None and len(df_data) > 0:\n        try:\n            validated_df = schema.validate(df_data, lazy = True)\n            logging.info(\"Data validated successfully!\")\n        except pa.errors.SchemaErrors as e:\n            context.updateVariable('rules_passed', False)\n            if validated_df is None:\n                validated_df = e.failure_cases\n            write_results_to_s3(validated_df, f\"Validation_result_{concur_requested_vendor_filename}\")\n            logging.error(f\"Schema validation error: {e}\")\n    else:\n        logging.error(\"No data loaded\")\n\n\nif __name__ == \"__main__\":\n    main()"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341337":{"id":6341337,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-160,"y":176,"width":32,"height":32,"inputConnectorIDs":[6341301,6341303],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6341307],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341338":{"id":6341338,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":-160,"y":-80,"width":32,"height":32,"inputConnectorIDs":[6341304],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6341309],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Not Processed Files"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import boto3\n\ns3_session = boto3.Session()\ns3_client = s3_session.client('s3')\ns3 = s3_session.resource('s3')\ns3_bucket_name= s3_URL.replace(\"s3:\", '').strip('/')\nbucket = s3.Bucket(s3_bucket_name)\ns3_resource = boto3.resource('s3')\n\nsource_folder = 'Concur/requested_vendor'\ntarget_folder = 'Concur/requested_vendor/NotProcessed'\n\ntime_now = datetime.datetime.now().strftime('_%Y%m%d')\n\ntry:\n    \n    src_file = concur_requested_vendor_filename\n    \n    s3_src_file_path = source_folder +'/'+ src_file\n    dest_file = src_file[:-5] + time_now + '.cdata'\n    # Construct the destination file path\n    s3_dest_file_path = target_folder +'/'+ dest_file\n\n    obj = s3.Object(s3_bucket_name, s3_src_file_path)\n    obj_data = obj.get()['Body'].read()\n    res = s3_client.put_object(Bucket=s3_bucket_name, Body=obj_data, Key=s3_dest_file_path)\n    print('Successfully Moved... ')\n    s3_client.delete_object(Bucket=s3_bucket_name, Key=s3_src_file_path)\n    print('Successfully Deleted... ')\n        \nexcept Exception as e:\n    print(f\"Exception: {e}\")\n    print('Error Moving file : ' + src_file)\n\nprint('\\n****File successfully moved to not processed...!')"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"6341339":{"id":6341339,"sourceID":6341330,"targetID":6341335},"6341340":{"id":6341340,"sourceID":6341326,"targetID":6341330},"6341341":{"id":6341341,"sourceID":6341333,"targetID":6341326},"6341342":{"id":6341342,"sourceID":6341334,"targetID":6341329},"6341343":{"id":6341343,"sourceID":6341335,"targetID":6341334}},"failureConnectors":{"6341310":{"id":6341310,"sourceID":6341330,"targetID":6341325},"6341311":{"id":6341311,"sourceID":6341326,"targetID":6341325},"6341351":{"id":6341351,"sourceID":6341335,"targetID":6341325},"6341352":{"id":6341352,"sourceID":6341334,"targetID":6341325},"6341353":{"id":6341353,"sourceID":6341333,"targetID":6341325}},"unconditionalConnectors":{"6341305":{"id":6341305,"sourceID":6341327,"targetID":6341332},"6341306":{"id":6341306,"sourceID":6341325,"targetID":6341328},"6341307":{"id":6341307,"sourceID":6341337,"targetID":6341333},"6341308":{"id":6341308,"sourceID":6341336,"targetID":6341331},"6341309":{"id":6341309,"sourceID":6341338,"targetID":6341325}},"trueConnectors":{"6341301":{"id":6341301,"sourceID":6341331,"targetID":6341337},"6341302":{"id":6341302,"sourceID":6341332,"targetID":6341336}},"falseConnectors":{"6341303":{"id":6341303,"sourceID":6341332,"targetID":6341337},"6341304":{"id":6341304,"sourceID":6341331,"targetID":6341338}},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{"apply_rules":{"definition":{"name":"apply_rules","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"True"},"rules_passed":{"definition":{"name":"rules_passed","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"True"}},"grids":{}},"info":{"name":"jb_Concur_Requested_Vendor_File","description":"","type":"ORCHESTRATION","tag":"6c7afee6-69d3-4039-b1ff-2252a93ef898"}}