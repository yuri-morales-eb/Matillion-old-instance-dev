{"job":{"components":{"6338751":{"id":6338751,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":928,"y":-128,"width":32,"height":32,"inputConnectorIDs":[6338819],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6338782":{"id":6338782,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":-240,"y":0,"width":32,"height":32,"inputConnectorIDs":[6338818],"outputSuccessConnectorIDs":[6338816],"outputFailureConnectorIDs":[6338829],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Start Date"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select coalesce (max(start_date),dateadd(d,-30, current_date())::date) as start_date\nfrom ${DB_DatalakeOrig}.${Sch_Public}.audit_metrics where job_status = 'SUCCESS'\nand job_name = 'jb_PowerBI_Get_Activity_Events'"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"powerbi_start"},"2":{"slot":2,"type":"STRING","value":"START_DATE"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6338783":{"id":6338783,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-448,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6338820],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Started At","mapTo":"audit_started"}},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6338801":{"id":6338801,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-352,"y":-112,"width":32,"height":32,"inputConnectorIDs":[6338828],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6338802":{"id":6338802,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":800,"y":0,"width":32,"height":32,"inputConnectorIDs":[6338813],"outputSuccessConnectorIDs":[6338849],"outputFailureConnectorIDs":[6338830],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delete Old Files"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"\"\"\n-- =============================================\n-- Author       : Alexander Escobar\n-- Create date  : OCT-30_2025\n-- Description  : The goal of this script is to delete files older than one Year from powerbi path\n-- UPDATED BY\t: \n-- UPDATED ON\t:\n-- JIRA TICKET\t: CER-5469\n-- =============================================\n\"\"\"\n\nfrom datetime import datetime, timedelta\nimport boto3\nimport os\n\ns3_session = boto3.Session()\ns3_resource = s3_session.resource('s3')\ns3_client = s3_session.client('s3')\n\ns3_bucket_name= s3_URL.replace(\"s3:\", '').strip('/')\nbucket = s3_resource.Bucket(s3_bucket_name)\n\nsource_folder = 'PowerBI_Archive/'\n\nkept_days = 365\ndrop_date = (datetime.today() - timedelta(days=kept_days)).strftime('%Y%m%d')\n\nfor obj in bucket.objects.filter(Prefix=source_folder):\n    file_name = os.path.basename(obj.key)\n    file_date = obj.last_modified.strftime('%Y%m%d')\n    if len(file_name) > 0 and file_date <= drop_date:\n      s3_client.delete_object(Bucket=s3_bucket_name, Key=obj.key)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6338803":{"id":6338803,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-352,"y":0,"width":32,"height":32,"inputConnectorIDs":[6338820],"outputSuccessConnectorIDs":[6338818],"outputFailureConnectorIDs":[6338828],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_Begin"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_Begin"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"RUNNING"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6338804":{"id":6338804,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":773867971,"x":224,"y":0,"width":32,"height":32,"inputConnectorIDs":[6338815],"outputSuccessConnectorIDs":[6338850],"outputFailureConnectorIDs":[6338822],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Write ActitivyEvents to Snowflake"}}}},"visible":true},"4":{"slot":4,"name":"S3 Object Prefix","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://etld1/"}}}},"visible":true},"5":{"slot":5,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${DB_Datalake}"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${Sch_PowerBI}"}}}},"visible":true},"8":{"slot":8,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LDG_ACTIVITY_EVENTS"}}}},"visible":true},"9":{"slot":9,"name":"Load Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ACTIVITY_EVENTS_JSON"}}}},"visible":true},"10":{"slot":10,"name":"Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"11":{"slot":11,"name":"File Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JSON"}}}},"visible":true},"12":{"slot":12,"name":"Compression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NONE"}}}},"visible":true},"20":{"slot":20,"name":"Record Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"21":{"slot":21,"name":"Field Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":","}}}},"visible":false},"22":{"slot":22,"name":"Skip Header","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"1"}}}},"visible":false},"23":{"slot":23,"name":"Date Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"24":{"slot":24,"name":"Time Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"25":{"slot":25,"name":"Timestamp Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"26":{"slot":26,"name":"","elements":{},"visible":false},"27":{"slot":27,"name":"Escape","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR_OR_ESCAPE_SEQUENCE","value":""}}}},"visible":false},"28":{"slot":28,"name":"Escape Unenclosed Field","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR_OR_ESCAPE_SEQUENCE","value":""}}}},"visible":false},"29":{"slot":29,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":false},"30":{"slot":30,"name":"Field Optionally Enclosed","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"31":{"slot":31,"name":"Null If","elements":{},"visible":false},"32":{"slot":32,"name":"Error On Column Count Mismatch","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"33":{"slot":33,"name":"Empty Field as Null","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":false},"34":{"slot":34,"name":"Encoding Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"35":{"slot":35,"name":"Skip Blank Lines","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"36":{"slot":36,"name":"Replace Invalid Characters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"40":{"slot":40,"name":"Enable Octal","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"41":{"slot":41,"name":"Allow Duplicates","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"42":{"slot":42,"name":"Strip Outer Array","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"43":{"slot":43,"name":"Strip Null Values","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"44":{"slot":44,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"45":{"slot":45,"name":"Nest Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"46":{"slot":46,"name":"Null If","elements":{},"visible":true},"47":{"slot":47,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"50":{"slot":50,"name":"Null If","elements":{},"visible":false},"51":{"slot":51,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"60":{"slot":60,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"61":{"slot":61,"name":"Preserve Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"62":{"slot":62,"name":"Strip Outer Element","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"63":{"slot":63,"name":"Disable Snowflake Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"64":{"slot":64,"name":"Disable Auto Convert","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"66":{"slot":66,"name":"Null If","elements":{},"visible":false},"67":{"slot":67,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"70":{"slot":70,"name":"Null If","elements":{},"visible":false},"71":{"slot":71,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"120":{"slot":120,"name":"On Error","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Abort Statement"}}}},"visible":true},"121":{"slot":121,"name":"n","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":false},"122":{"slot":122,"name":"Size Limit (B)","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"123":{"slot":123,"name":"Purge Files","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"124":{"slot":124,"name":"Truncate Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"125":{"slot":125,"name":"Force Load","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"126":{"slot":126,"name":"Match By Column Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"140":{"slot":140,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"141":{"slot":141,"name":"Master Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"142":{"slot":142,"name":"KMS Key Id","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"143":{"slot":143,"name":"Authentication","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Credentials"}}}},"visible":true},"144":{"slot":144,"name":"Storage Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"200":{"slot":200,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"201":{"slot":201,"name":"Pattern","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ActivityEvents*.*"}}}},"visible":true},"203":{"slot":203,"name":"Metadata Fields","elements":{},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6338805":{"id":6338805,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":800,"y":-128,"width":32,"height":32,"inputConnectorIDs":[6338821],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6338819],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_Failure"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_End"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"FAILURE"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6338806":{"id":6338806,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":384,"y":-128,"width":32,"height":32,"inputConnectorIDs":[6338822,6338823,6338824,6338825,6338826,6338827,6338829,6338830],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6338821],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Started At","mapTo":"audit_started"},"2":{"slot":2,"fromId":null,"fromName":"Completed At","mapTo":"audit_completed"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Failure Path"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6338807":{"id":6338807,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":928,"y":0,"width":32,"height":32,"inputConnectorIDs":[6338849],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_Success"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public_End"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_job_name"},"2":{"slot":2,"type":"STRING","value":"${job_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"SUCCESS"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6338808":{"id":6338808,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":384,"y":0,"width":32,"height":32,"inputConnectorIDs":[6338850],"outputSuccessConnectorIDs":[6338848],"outputFailureConnectorIDs":[6338827],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Insert into Target"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into ${DB_Datalake}.${Sch_PowerBI }.ACTIVITY_EVENTS\n\n(select \nACTIVITY_EVENTS_JSON:Id::varchar as Id,\nACTIVITY_EVENTS_JSON:RecordType::varchar as Record_Type,\nACTIVITY_EVENTS_JSON:CreationTime::timestamp as Creation_Time,\nACTIVITY_EVENTS_JSON:Operation::varchar as Operation,\nACTIVITY_EVENTS_JSON:OrganizationId::varchar as Organization_Id,\nACTIVITY_EVENTS_JSON:UserType::varchar as User_Type ,\nACTIVITY_EVENTS_JSON:UserKey::varchar as User_Key ,\nACTIVITY_EVENTS_JSON:Workload::varchar as Workload ,\nACTIVITY_EVENTS_JSON:UserId::varchar as User_Id,\nACTIVITY_EVENTS_JSON:ClientIP::varchar as Client_IP,\nACTIVITY_EVENTS_JSON:UserAgent::varchar as User_Agent ,\nACTIVITY_EVENTS_JSON:Activity::varchar as Activity,\nACTIVITY_EVENTS_JSON:ItemName::varchar as Item_Name,\nACTIVITY_EVENTS_JSON:WorkSpaceName::varchar as WorkSpace_Name,\nACTIVITY_EVENTS_JSON:DatasetName::varchar as Dataset_Name,\nACTIVITY_EVENTS_JSON:ReportName::varchar as Report_Name,\nACTIVITY_EVENTS_JSON:CapacityId::varchar as Capacity_Id ,\nACTIVITY_EVENTS_JSON:CapacityName::varchar as Capacity_Name,\nACTIVITY_EVENTS_JSON:WorkspaceId::varchar as Workspace_Id,\nACTIVITY_EVENTS_JSON:ObjectId::varchar as Object_Id,\nACTIVITY_EVENTS_JSON:DatasetId::varchar as Dataset_Id,\nACTIVITY_EVENTS_JSON:ReportId::varchar as Report_Id,\nACTIVITY_EVENTS_JSON:ArtifactId::varchar as Artifact_Id,\nACTIVITY_EVENTS_JSON:ArtifactName::varchar as Artifact_Name,\nACTIVITY_EVENTS_JSON:IsSuccess::varchar as Is_Success,\nACTIVITY_EVENTS_JSON:ReportType::varchar as Report_Type,\nACTIVITY_EVENTS_JSON:RequestId::varchar as Request_Id,\nACTIVITY_EVENTS_JSON:ActivityId::varchar as Activity_Id,\nACTIVITY_EVENTS_JSON:DistributionMethod::varchar as Distribution_Method,\nACTIVITY_EVENTS_JSON:ArtifactKind::varchar as Artifact_Kind,\nACTIVITY_EVENTS_JSON:ConsumptionMethod::varchar as Consumption_Method,\nACTIVITY_EVENTS_JSON:AppName::varchar as App_Name,\nACTIVITY_EVENTS_JSON:AppReportId::varchar as App_Report_Id,\nACTIVITY_EVENTS_JSON:AppId::varchar as App_Id,\nACTIVITY_EVENTS_JSON:DataflowId::varchar as Dataflow_Id,\nACTIVITY_EVENTS_JSON:DataflowName::varchar as Dataflow_Name,\nACTIVITY_EVENTS_JSON:DataflowAccessTokenRequestParameters::variant as Dataflow_AccessToken_Request_Parameters,\nACTIVITY_EVENTS_JSON:DataflowType::varchar as Dataflow_Type,\nACTIVITY_EVENTS_JSON:ModelsSnapshots::varchar as Models_Snapshots,\nACTIVITY_EVENTS_JSON:ImportId::varchar as Import_Id,\nACTIVITY_EVENTS_JSON:ImportSource::varchar as Import_Source,\nACTIVITY_EVENTS_JSON:ImportType::varchar as Import_Type,\nACTIVITY_EVENTS_JSON:ImportDisplayName::varchar as Import_Display_Name,\nACTIVITY_EVENTS_JSON:DataConnectivityMode::varchar as DataConnectivity_Mode,\nACTIVITY_EVENTS_JSON:LastRefreshTime::timestamp as LastRefresh_Time,\nACTIVITY_EVENTS_JSON:HasFullReportAttachment::varchar as Has_Full_Report_Attachment,\nACTIVITY_EVENTS_JSON:ExportEventStartDateTimeParameter::timestamp as ExportEvent_StartDateTime_Parameter,\nACTIVITY_EVENTS_JSON:ExportEventEndDateTimeParameter::timestamp as ExportEvent_EndDateTime_Parameter,\nACTIVITY_EVENTS_JSON:GatewayId::varchar as Gateway_Id,\nACTIVITY_EVENTS_JSON:DatasourceId::varchar as Datasource_Id,\nACTIVITY_EVENTS_JSON:FolderObjectId::varchar as Folder_ObjectId,\nACTIVITY_EVENTS_JSON:FolderDisplayName::varchar as Folder_Display_Name,\nACTIVITY_EVENTS_JSON:FolderAccessRequests::variant as Folder_Access_Requests,\nACTIVITY_EVENTS_JSON:Schedules::variant as Schedules,\nACTIVITY_EVENTS_JSON:RefreshType::varchar as Refresh_Type,\nACTIVITY_EVENTS_JSON:DashboardName::varchar as Dashboard_Name,\nACTIVITY_EVENTS_JSON:DashboardId::varchar as Dashboard_Id,\nACTIVITY_EVENTS_JSON:Datasets::variant as Datasets,\nACTIVITY_EVENTS_JSON:SharingInformation::variant as Sharing_Information,\nACTIVITY_EVENTS_JSON:SharingAction::varchar as Sharing_Action,\nACTIVITY_EVENTS_JSON:ExportedArtifactInfo::variant as Exported_Artifact_Info,\nCURRENT_TIMESTAMP AS DL_CREATED_DATE,\n'${environment_username}' AS DL_CREATED_BY,\n'${run_history_id}' AS DL_JOBID\nfrom ${DB_Datalake}.${Sch_PowerBI }.ldg_activity_events l\nleft join ${DB_Datalake}.${Sch_PowerBI }.activity_events p on p.Id = l.ACTIVITY_EVENTS_JSON:Id::varchar\nwhere p.ID is null)\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6338809":{"id":6338809,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":672,"y":0,"width":32,"height":32,"inputConnectorIDs":[6338814],"outputSuccessConnectorIDs":[6338813],"outputFailureConnectorIDs":[6338824],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Archive S3 Files"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import boto3\nimport io \n#import json\n#import sys\n#import os\n#import pandas  \n#import csv\n#import gnupg\n#import requests\n#import urllib.request\n#import glob\n\noutfile = io.StringIO()\ns3_bucket_name= s3_URL.replace(\"s3:\", '').strip('/')\n#print(s3_bucket_name)\n\ns3_client = boto3.Session()\ns3 = s3_client.resource('s3')\nbucket = s3.Bucket(s3_bucket_name)\ns3_resource = boto3.resource('s3')\n\nprint('*** Archival process started ***\\n')\n\nfor obj in bucket.objects.all():\n    #print(obj.key)\n\ttry:\n\t\tsrc_file = os.path.basename(obj.key)\n\t\tname, extension = os.path.splitext(obj.key)\n\t\tif extension == '.json' and name[:15] == 'ActivityEvents_':\n\t\t\tprint('Archiving File... ' + name)\n\t\t\ts3_dest_file_path = 'PowerBI_Archive/'+ src_file\n\t\t\tobj_data = obj.get()['Body'].read()\n            \n\t\t\td = boto3.Session()\n\t\t\ta = d.client('s3')\n\t\t\tres = a.put_object(Bucket=s3_bucket_name, Body=obj_data, Key=s3_dest_file_path)\n\t\t\tprint('Successfully Archived... Deleting file... ' + src_file)\n\t\t\ta.delete_object(Bucket=s3_bucket_name, Key=src_file)\n\t\t\tprint('Successfully Deleted... ' + src_file + '\\n')\n            \n\texcept:\n\t\tprint('Error Archiving file : ' + src_file)\n\nprint('***All files successfully archived...!')\n\n\n\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6338810":{"id":6338810,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":32,"y":0,"width":32,"height":32,"inputConnectorIDs":[6338817],"outputSuccessConnectorIDs":[6338815],"outputFailureConnectorIDs":[6338825],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Activity Events"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import time\nfrom datetime import datetime, timedelta, timezone, date\nimport pytz\nimport json\nimport boto3\nimport botocore\nimport requests\nimport pandas as pd\nfrom io import StringIO\nimport math\n\n#for testing purposes only.  remove and replace with environment variable later\n#powerbi_start = '2022-11-08'\n#current_date = datetime.strptime('2022-11-14', \"%Y-%m-%d\") ### manually setting end date\n\ncurrent_date = datetime.strptime(date.today().strftime(\"%Y-%m-%d\"), \"%Y-%m-%d\") ### also equals loop end date\nrpt_date_str = datetime.strftime(powerbi_start,\"%Y-%m-%d %H:%M:%S\")\nrpt_date_dt = powerbi_start\n\n\n\n### THE GOAL OF THIS CODE IS TO CALL THE POWERBI API FOR ACTIVITY EVENTS, RETRIEVE THE JSON RESPONSE,\n### AND WRITE IT TO AN S3 BUCKET CALLED S3://etld1/\nAPI_Status = \"Success\"\n\nFilename_root = 'ActivityEvents_'\n  \n\n### GET BEARER TOKEN FROM POWERBI API\nprint(\"Getting Auth from PowerBI API\")\nresponse = None\nurl = 'https://login.microsoftonline.com/0eaa99c4-1038-491d-9990-962fab14bea1/oauth2/token?'\npayload='grant_type=client_credentials&resource={}&client_id={}&client_secret={}'.format(powerbi_resource ,powerbi_client_id, powerbi_client_secret)\n#headers = {'Content-Type': 'application/x-www-form-urlencoded'}\nheaders = {'Accept': 'application/json', 'Content-Type': 'application/x-www-form-urlencoded'}\nresponse = requests.request(\"GET\", url, headers=headers, data=payload)\n\n#print(response.text)\ntoken_json = response.json()\ntoken = token_json['access_token']\n#print(token)\nprint(\"Auth acquired\")\n\n\n### USE BEARER TOKEN TO GET ACTIVITY EVENTS FROM POWERBI API\nwhile rpt_date_dt < current_date:\n## Start date loop\n  \n\trpt_date_str = datetime.strftime(rpt_date_dt, '%Y-%m-%d') + 'T00:00:00.000Z'\n\trpt_end_str = datetime.strftime(rpt_date_dt, '%Y-%m-%d')  + 'T23:59:59.000Z'\n\tprint ('start interval = ', rpt_date_str)\n\tprint ('end interval = ', rpt_end_str)\n\tbase_url = 'https://api.powerbi.com/v1.0/myorg/admin/activityevents'\n\turl= base_url + \"?startDateTime='{}'&endDateTime='{}'\".format(rpt_date_str,rpt_end_str)\n\t#print('url = ', url)\n    \n\tpayload={}\n\theaders = {'Authorization': 'Bearer {}'.format(token)}\n\t#print(headers)\n\tresponse = None\n\tresponse = requests.request(\"GET\", url, headers=headers, data=payload)\n\tdata = response.json()\n\tcontinue_uri = data.get('continuationUri')\n\tcontinue_token = data.get('continuationToken')\n\tprint(data)\n#\tprint(data['activityEventEntities'])\n\n\n\titer = 0\n\twhile continue_uri and iter < 100:\n\t\tprint('iteration ', iter, ': ',  continue_token)\n\t\titer = iter + 1\n    \t#loop over continuation tokens for the current date\n        \n\t\t#Save initial call results to csv_buffer\n\t\tdata = response.json()\n    \n\t\tcsv_body = json.dumps(data.get('activityEventEntities'))\n\t\tprint('csv_body = ', csv_body)\n\t\tprint('data_get = ', str(csv_body)[1:-1]) #remove starting and ending brackets\n\t\tBUCKET_NAME = s3_URL.replace(\"s3:\", '').strip('/')\n\t\ts3 = boto3.resource('s3')\n\t\ts3client = boto3.client('s3')\n\t\tKEY = Filename_root + datetime.strftime(rpt_date_dt, '%Y%m%d') + '_{:02d}.json'.format(iter)\n\t\ts3.Object(BUCKET_NAME, KEY).put(Body=str(csv_body)[1:-1])\n        #s3.Object(BUCKET_NAME, KEY).put(Body=csv_buffer.getvalue())\n        \n\t\t#making next call\n\t\tcontinue_uri = data.get('continuationUri')\n\t\tcontinue_token = data.get('continuationToken')\n\t\tcont_base_url = 'https://wabi-us-north-central-d-primary-redirect.analysis.windows.net/v1.0/myorg/admin/activityevents'\n\t\tcont_url= cont_base_url + f\"?continuationToken='{continue_token}'\"\n\n\t\tresponse = requests.request(\"GET\", cont_url, headers=headers, data=payload)\n\t\t#print('url = ', cont_url)\n\t\t#end inner loop\n\t\n\t#Save rest of calls results to csv_buffer\n\tcsv_body = json.dumps(data.get('activityEventEntities'))\n\tdf3 = pd.DataFrame.from_dict(data)\n\tprint('df3 = ', df3)\n\tprint('final csv_body = ', csv_body)\n\tBUCKET_NAME = s3_URL.replace(\"s3:\", '').strip('/')\n\ts3 = boto3.resource('s3')\n\ts3client = boto3.client('s3')\n\tKEY = Filename_root + datetime.strftime(rpt_date_dt, '%Y%m%d') + '_{:02d}.json'.format(iter)\n\ts3.Object(BUCKET_NAME, KEY).put(Body=csv_body)\n\t#s3.Object(BUCKET_NAME, KEY).put(Body=df3)\n        \n\trpt_date_dt = rpt_date_dt + timedelta(days=1)\n\tprint('\\nnew report date is ', rpt_date_dt)\n##end date loop\n\n\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"2000"}}}},"visible":true},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6338811":{"id":6338811,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":237373210,"x":-112,"y":0,"width":32,"height":32,"inputConnectorIDs":[6338816],"outputSuccessConnectorIDs":[6338817],"outputFailureConnectorIDs":[6338823],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate LDG"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${DB_Datalake}"}}}},"visible":true},"4":{"slot":4,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${Sch_PowerBI}"}}}},"visible":true},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LDG_ACTIVITY_EVENTS"}}}},"visible":true},"6":{"slot":6,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6338812":{"id":6338812,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":528,"y":0,"width":32,"height":32,"inputConnectorIDs":[6338848],"outputSuccessConnectorIDs":[6338814],"outputFailureConnectorIDs":[6338826],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Row Count"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select count(*) as num_rows\nfrom ${DB_Datalake}.${Sch_PowerBI}.activity_events \nwhere DL_JOBID = ${run_history_id}"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_rowcount"},"2":{"slot":2,"type":"STRING","value":"NUM_ROWS"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${DB_Datalake}"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ACTIVITY_EVENTS"}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"RECORD_TYPE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"CREATION_TIME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"OPERATION"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ORGANIZATION_ID"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"USER_TYPE"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"USER_KEY"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"WORKLOAD"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"USER_ID"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"CLIENT_IP"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"USER_AGENT"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"ACTIVITY"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"ITEM_NAME"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"WORKSPACE_NAME"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"DATASET_NAME"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"REPORT_NAME"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"CAPACITY_ID"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"CAPACITY_NAME"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"WORKSPACE_ID"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"OBJECT_ID"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"DATASET_ID"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"REPORT_ID"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"ARTIFACT_ID"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"ARTIFACT_NAME"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"IS_SUCCESS"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"REPORT_TYPE"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"REQUEST_ID"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"ACTIVITY_ID"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"DISTRIBUTION_METHOD"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"ARTIFACT_KIND"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"CONSUMPTION_METHOD"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"APP_NAME"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"APP_REPORT_ID"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"APP_ID"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"DATAFLOW_ID"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"DATAFLOW_NAME"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"DATAFLOW_ACCESSTOKEN_REQUEST_PARAMETERS"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"DATAFLOW_TYPE"}}},"39":{"slot":39,"values":{"1":{"slot":1,"type":"STRING","value":"MODELS_SNAPSHOTS"}}},"40":{"slot":40,"values":{"1":{"slot":1,"type":"STRING","value":"IMPORT_ID"}}},"41":{"slot":41,"values":{"1":{"slot":1,"type":"STRING","value":"IMPORT_SOURCE"}}},"42":{"slot":42,"values":{"1":{"slot":1,"type":"STRING","value":"IMPORT_TYPE"}}},"43":{"slot":43,"values":{"1":{"slot":1,"type":"STRING","value":"IMPORT_DISPLAY_NAME"}}},"44":{"slot":44,"values":{"1":{"slot":1,"type":"STRING","value":"DATACONNECTIVITY_MODE"}}},"45":{"slot":45,"values":{"1":{"slot":1,"type":"STRING","value":"LASTREFRESH_TIME"}}},"46":{"slot":46,"values":{"1":{"slot":1,"type":"STRING","value":"HAS_FULL_REPORT_ATTACHMENT"}}},"47":{"slot":47,"values":{"1":{"slot":1,"type":"STRING","value":"EXPORTEVENT_STARTDATETIME_PARAMETER"}}},"48":{"slot":48,"values":{"1":{"slot":1,"type":"STRING","value":"EXPORTEVENT_ENDDATETIME_PARAMETER"}}},"49":{"slot":49,"values":{"1":{"slot":1,"type":"STRING","value":"GATEWAY_ID"}}},"50":{"slot":50,"values":{"1":{"slot":1,"type":"STRING","value":"DATASOURCE_ID"}}},"51":{"slot":51,"values":{"1":{"slot":1,"type":"STRING","value":"FOLDER_OBJECTID"}}},"52":{"slot":52,"values":{"1":{"slot":1,"type":"STRING","value":"FOLDER_DISPLAY_NAME"}}},"53":{"slot":53,"values":{"1":{"slot":1,"type":"STRING","value":"FOLDER_ACCESS_REQUESTS"}}},"54":{"slot":54,"values":{"1":{"slot":1,"type":"STRING","value":"SCHEDULES"}}},"55":{"slot":55,"values":{"1":{"slot":1,"type":"STRING","value":"REFRESH_TYPE"}}},"56":{"slot":56,"values":{"1":{"slot":1,"type":"STRING","value":"DASHBOARD_NAME"}}},"57":{"slot":57,"values":{"1":{"slot":1,"type":"STRING","value":"DASHBOARD_ID"}}},"58":{"slot":58,"values":{"1":{"slot":1,"type":"STRING","value":"DATASETS"}}},"59":{"slot":59,"values":{"1":{"slot":1,"type":"STRING","value":"SHARING_INFORMATION"}}},"60":{"slot":60,"values":{"1":{"slot":1,"type":"STRING","value":"SHARING_ACTION"}}},"61":{"slot":61,"values":{"1":{"slot":1,"type":"STRING","value":"EXPORTED_ARTIFACT_INFO"}}},"62":{"slot":62,"values":{"1":{"slot":1,"type":"STRING","value":"DL_CREATED_DATE"}}},"63":{"slot":63,"values":{"1":{"slot":1,"type":"STRING","value":"DL_CREATED_BY"}}},"64":{"slot":64,"values":{"1":{"slot":1,"type":"STRING","value":"DL_JOBID"}}}},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${Sch_PowerBI}"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"6338813":{"id":6338813,"sourceID":6338809,"targetID":6338802},"6338814":{"id":6338814,"sourceID":6338812,"targetID":6338809},"6338815":{"id":6338815,"sourceID":6338810,"targetID":6338804},"6338816":{"id":6338816,"sourceID":6338782,"targetID":6338811},"6338817":{"id":6338817,"sourceID":6338811,"targetID":6338810},"6338818":{"id":6338818,"sourceID":6338803,"targetID":6338782},"6338848":{"id":6338848,"sourceID":6338808,"targetID":6338812},"6338849":{"id":6338849,"sourceID":6338802,"targetID":6338807},"6338850":{"id":6338850,"sourceID":6338804,"targetID":6338808}},"failureConnectors":{"6338822":{"id":6338822,"sourceID":6338804,"targetID":6338806},"6338823":{"id":6338823,"sourceID":6338811,"targetID":6338806},"6338824":{"id":6338824,"sourceID":6338809,"targetID":6338806},"6338825":{"id":6338825,"sourceID":6338810,"targetID":6338806},"6338826":{"id":6338826,"sourceID":6338812,"targetID":6338806},"6338827":{"id":6338827,"sourceID":6338808,"targetID":6338806},"6338828":{"id":6338828,"sourceID":6338803,"targetID":6338801},"6338829":{"id":6338829,"sourceID":6338782,"targetID":6338806},"6338830":{"id":6338830,"sourceID":6338802,"targetID":6338806}},"unconditionalConnectors":{"6338819":{"id":6338819,"sourceID":6338805,"targetID":6338751},"6338820":{"id":6338820,"sourceID":6338783,"targetID":6338803},"6338821":{"id":6338821,"sourceID":6338806,"targetID":6338805}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{"powerbi_start":{"definition":{"name":"powerbi_start","type":"DATETIME","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null}},"grids":{}},"info":{"name":"jb_PowerBI_Get_Activity_Events","description":"","type":"ORCHESTRATION","tag":"c26b9709-b3cd-4b6d-ae8b-50810bdcdcf7"}}