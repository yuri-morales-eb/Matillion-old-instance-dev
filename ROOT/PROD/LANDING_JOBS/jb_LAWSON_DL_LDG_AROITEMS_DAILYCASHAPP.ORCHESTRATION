{"job":{"components":{"6340379":{"id":6340379,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":48,"y":-224,"width":32,"height":32,"inputConnectorIDs":[6340449],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT_LAWSON_DL_LDG_AROITEMS_DAILYCASHAPP_SUCCESS"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_LAWSON_DL_LDG_AROITEMS_DAILYCASHAPP"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_component"},"2":{"slot":2,"type":"STRING","value":"LAWSON_DL_LDG_AROITEMS_DAILYCASHAPP"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6340380":{"id":6340380,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":48,"y":-128,"width":32,"height":32,"inputConnectorIDs":[6340416],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT_LAWSON_DL_LDG_AROITEMS_DAILYCASHAPP_FAILURE"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_LAWSON_DL_LDG_AROITEMS_DAILYCASHAPP"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"FAILURE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_component"},"2":{"slot":2,"type":"STRING","value":"LAWSON_DL_LDG_AROITEMS_DAILYCASHAPP"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6340381":{"id":6340381,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-576,"y":-224,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6340417],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6340382":{"id":6340382,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-240,"y":-128,"width":32,"height":32,"inputConnectorIDs":[6340418,6340419],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6340416],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Started At","mapTo":"audit_started"},"2":{"slot":2,"fromId":null,"fromName":"Completed At","mapTo":"audit_completed"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALL_FAILURES"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6340383":{"id":6340383,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-416,"y":-224,"width":32,"height":32,"inputConnectorIDs":[6340417],"outputSuccessConnectorIDs":[6340450],"outputFailureConnectorIDs":[6340418],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Status","mapTo":"audit_status"},"2":{"slot":2,"fromId":null,"fromName":"Component","mapTo":"audit_component"},"3":{"slot":3,"fromId":null,"fromName":"Started At","mapTo":"audit_started"},"4":{"slot":4,"fromId":null,"fromName":"Duration","mapTo":"audit_duration"},"5":{"slot":5,"fromId":null,"fromName":"Completed At","mapTo":"audit_completed"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LAWSON_DL_LDG_AROITEMS_DAILYCASHAPP"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MERGE INTO       ${SNFLENTDB}.${SNFLDWHSCH}.LAWSON_DL_LDG_AROITEMS_DAILYCASHAPP TGT USING\n  ( \n\t\t\t\t\t\t\t\t\t\tSELECT DISTINCT ltrim(rtrim(company)) as company,\n                                                 ltrim(rtrim(trans_type)) as trans_type,\n                                                 ltrim(rtrim(invoice)) as invoice,\n                                                 ltrim(rtrim(payment_seq)) as payment_seq,\n                                                 ltrim(rtrim(customer)) as customer,\n                                                 ltrim(rtrim(status)) as status,\n                                                 ltrim(rtrim(trans_date)) as trans_date,\n                                                 ltrim(rtrim(tran_amt)) as tran_amt,\n                                                 ltrim(rtrim(appld_amt)) as appld_amt,\n                                                 ltrim(rtrim(adj_amt)) as adj_amt,\n                                                 ltrim(rtrim(due_date)) as due_date,\n                                                 ltrim(rtrim(orig_amt)) as orig_amt,\n                                                 ltrim(rtrim(orig_app_amt)) as orig_app_amt,\n                                                 ltrim(rtrim(orig_adj_amt)) as orig_adj_amt,\n                                                 ltrim(rtrim(process_level)) as process_level,\n                                                 ltrim(rtrim(gl_date)) as gl_date,\n                                                 ltrim(rtrim(ar_code)) as ar_code,\n                                                 ltrim(rtrim(terms_cd)) as terms_cd\n                                 FROM            ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.AROITEMS \n                                                 \n                                 WHERE           ltrim(rtrim(STATUS)) IN (1,7,8,9)\n                                 AND             ltrim(rtrim(TRANS_TYPE)) = 'C'\n\t\t\t\t\t\t\t\t) SRC\n\t\t\t\t\t\t\t\tON \t\t\t\t ltrim(rtrim(tgt.company)) = ltrim(rtrim(src.company))\n\t\t\t\t\t\t\t\tAND              ltrim(rtrim(tgt.trans_type)) = ltrim(rtrim(src.trans_type))\n\t\t\t\t\t\t\t\tAND              ltrim(rtrim(tgt.invoice)) =  ltrim(rtrim(src.invoice))\n\t\t\t\t\t\t\t\tAND              ltrim(rtrim(tgt.payment_seq)) = ltrim(rtrim(src.payment_seq))\n\t\t\t\t\t\t\t\tAND \t\t\t   ltrim(rtrim(tgt.customer)) =   ltrim(rtrim(src.customer))  \nWHEN MATCHED\nAND (   \t\t\tltrim(rtrim(SRC.status)) \t\t<> ltrim(rtrim(tgt.status))\n\t\tOR          ltrim(rtrim(SRC.trans_date))  \t<> ltrim(rtrim(tgt.trans_date))\n\t\tOR          ltrim(rtrim(SRC.tran_amt))  \t\t<> ltrim(rtrim(tgt.tran_amt))\n\t\tOR          ltrim(rtrim(SRC.APPLD_AMT)) \t\t<> ltrim(rtrim(tgt.APPLD_AMT))\n\t\tOR          ltrim(rtrim(SRC.ADJ_AMT)) \t\t<> ltrim(rtrim(tgt.ADJ_AMT))\n\t\tOR          ltrim(rtrim(SRC.due_date))  \t<> ltrim(rtrim(tgt.due_date))\n\t\tOR          ltrim(rtrim(SRC.ORIG_AMT)) \t\t<> ltrim(rtrim(tgt.ORIG_AMT))\n\t\tOR          ltrim(rtrim(SRC.ORIG_APP_AMT)) \t<> ltrim(rtrim(tgt.ORIG_APP_AMT))\n\t\tOR          ltrim(rtrim(SRC.orig_adj_amt)) \t<> ltrim(rtrim(tgt.orig_adj_amt))\n\t\tOR          ltrim(rtrim(SRC.process_level)) \t\t<> ltrim(rtrim(tgt.process_level))\n\t\tOR          ltrim(rtrim(SRC.gl_date)) \t<> ltrim(rtrim(tgt.gl_date))\n\t\tOR          ltrim(rtrim(SRC.ar_code)) \t<> ltrim(rtrim(tgt.ar_code))  \n\t\tOR          ltrim(rtrim(SRC.terms_cd)) \t<> ltrim(rtrim(tgt.terms_cd)) \n\t\t)  \n        AND tgt.DL_MODIFIED_DATE is null \n \nTHEN\nUPDATE\nSET     dl_modified_date = TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(0)),\n\t    ACTIVE_STATUS = 'N'\n        ,dl_jobid = '${run_history_id}'\nWHEN NOT MATCHED THEN INSERT ( \n\t\t\t  TGT.company,\n              TGT.trans_type,\n              TGT.invoice,\n              TGT.payment_seq,\n              TGT.customer,\n              TGT.status,\n              TGT.trans_date,\n              TGT.tran_amt,\n              TGT.appld_amt,\n              TGT.adj_amt,\n              TGT.due_date,\n              TGT.orig_amt,\n              TGT.orig_app_amt,\n              TGT.orig_adj_amt,\n              TGT.process_level,\n              TGT.gl_date,\n              TGT.ar_code,\n              TGT.terms_cd,\n              TGT.DL_CREATED_DATE ,\n\t\t\t  TGT.ACTIVE_STATUS,\n              TGT.dl_created_by,\n              TGT.dl_jobid)\nVALUES (  \tSRC.company,\n\t\t\tSRC.trans_type,\n\t\t\tSRC.invoice,\n\t\t\tSRC.payment_seq,\n\t\t\tSRC.customer,\n\t\t\tSRC.status,\n\t\t\tSRC.trans_date,\n\t\t\tSRC.tran_amt,\n\t\t\tSRC.appld_amt,\n\t\t\tSRC.adj_amt,\n\t\t\tSRC.due_date,\n\t\t\tSRC.orig_amt,\n\t\t\tSRC.orig_app_amt,\n\t\t\tSRC.orig_adj_amt,\n\t\t\tSRC.process_level,\n\t\t\tSRC.gl_date,\n\t\t\tSRC.ar_code,\n\t\t\tSRC.terms_cd,\n\t\t\tTO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(0)), \n\t\t\t'Y',\n            '${environment_username}',\n\t\t\t'${run_history_id}' \n       );\n\n  \n  ------------------------- Insert -----------------------------------------------------------\n\nMERGE INTO        ${SNFLENTDB}.${SNFLDWHSCH}.LAWSON_DL_LDG_AROITEMS_DAILYCASHAPP TGT USING\n  (  \t\t\t\t\t\t\tSELECT \t\t\t DISTINCT ltrim(rtrim(company)) as company,\n                                                 ltrim(rtrim(trans_type)) as trans_type,\n                                                 ltrim(rtrim(invoice)) as invoice,\n                                                 ltrim(rtrim(payment_seq)) as payment_seq,\n                                                 ltrim(rtrim(customer)) as customer,\n                                                 ltrim(rtrim(status)) as status,\n                                                 ltrim(rtrim(trans_date)) as trans_date,\n                                                 ltrim(rtrim(tran_amt)) as tran_amt,\n                                                 ltrim(rtrim(appld_amt)) as appld_amt,\n                                                 ltrim(rtrim(adj_amt)) as adj_amt,\n                                                 ltrim(rtrim(due_date)) as due_date,\n                                                 ltrim(rtrim(orig_amt)) as orig_amt,\n                                                 ltrim(rtrim(orig_app_amt)) as orig_app_amt,\n                                                 ltrim(rtrim(orig_adj_amt)) as orig_adj_amt,\n                                                 ltrim(rtrim(process_level)) as process_level,\n                                                 ltrim(rtrim(gl_date)) as gl_date,\n                                                 ltrim(rtrim(ar_code)) as ar_code,\n                                                 ltrim(rtrim(terms_cd)) as terms_cd\n                                 FROM            ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.AROITEMS   SRC\n                                                   \n                                 WHERE           ltrim(rtrim(STATUS)) IN (1,7,8,9)\n                                 AND             ltrim(rtrim(TRANS_TYPE)) = 'C'\n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t) SRC\n\t\t\t\t\t\t\t\t\t\tON \t ltrim(rtrim(tgt.company)) = ltrim(rtrim(src.company))\n\t\t\t\t\t\t\t\t\t\tAND  ltrim(rtrim(tgt.trans_type)) = ltrim(rtrim(src.trans_type))\n\t\t\t\t\t\t\t\t\t\tAND\t ltrim(rtrim(tgt.invoice)) = ltrim(rtrim(src.invoice))\n\t\t\t\t\t\t\t\t\t\tAND  ltrim(rtrim(tgt.payment_seq)) = ltrim(rtrim(src.payment_seq))\n\t\t\t\t\t\t\t\t\t\tAND  ltrim(rtrim(tgt.customer)) =   ltrim(rtrim(src.customer))  \n                                        AND TGT.DL_MODIFIED_DATE is null \n          \nWHEN NOT MATCHED THEN INSERT ( \n\t\t\t   TGT.company,\n              TGT.trans_type,\n              TGT.invoice,\n              TGT.payment_seq,\n              TGT.customer,\n              TGT.status,\n              TGT.trans_date,\n              TGT.tran_amt,\n              TGT.appld_amt,\n              TGT.adj_amt,\n              TGT.due_date,\n              TGT.orig_amt,\n              TGT.orig_app_amt,\n              TGT.orig_adj_amt,\n              TGT.process_level,\n              TGT.gl_date,\n              TGT.ar_code,\n              TGT.terms_cd,\n              TGT.DL_CREATED_DATE,\n\t\t\t  TGT.ACTIVE_STATUS,\n              TGT.dl_created_by,\n              TGT.dl_jobid)\nVALUES (  \tSRC.company,\n\t\t\tSRC.trans_type,\n\t\t\tSRC.invoice,\n\t\t\tSRC.payment_seq,\n\t\t\tSRC.customer,\n\t\t\tSRC.status,\n\t\t\tSRC.trans_date,\n\t\t\tSRC.tran_amt,\n\t\t\tSRC.appld_amt,\n\t\t\tSRC.adj_amt,\n\t\t\tSRC.due_date,\n\t\t\tSRC.orig_amt,\n\t\t\tSRC.orig_app_amt,\n\t\t\tSRC.orig_adj_amt,\n\t\t\tSRC.process_level,\n\t\t\tSRC.gl_date,\n\t\t\tSRC.ar_code,\n\t\t\tSRC.terms_cd\n\t\t\t, TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(0)), \n\t\t\t'Y',\n\t\t\t'${environment_username}',\n\t\t\t'${run_history_id}' \n       );\n             "}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6340448":{"id":6340448,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":-240,"y":-224,"width":32,"height":32,"inputConnectorIDs":[6340450],"outputSuccessConnectorIDs":[6340449],"outputFailureConnectorIDs":[6340419],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AuditRow_Count"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select count(*) as RowCount from ${SNFLENTDB}.${SNFLDWHSCH}.LAWSON_DL_LDG_AROITEMS_DAILYCASHAPP\nwhere DL_JOBID = ${run_history_id}"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_rowcount"},"2":{"slot":2,"type":"STRING","value":"ROWCOUNT"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"6340449":{"id":6340449,"sourceID":6340448,"targetID":6340379},"6340450":{"id":6340450,"sourceID":6340383,"targetID":6340448}},"failureConnectors":{"6340418":{"id":6340418,"sourceID":6340383,"targetID":6340382},"6340419":{"id":6340419,"sourceID":6340448,"targetID":6340382}},"unconditionalConnectors":{"6340416":{"id":6340416,"sourceID":6340382,"targetID":6340380},"6340417":{"id":6340417,"sourceID":6340381,"targetID":6340383}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{},"grids":{}},"info":{"name":"jb_LAWSON_DL_LDG_AROITEMS_DAILYCASHAPP","description":"","type":"ORCHESTRATION","tag":"2ff822b4-7bab-4c02-bfee-990465cb8e5f"}}