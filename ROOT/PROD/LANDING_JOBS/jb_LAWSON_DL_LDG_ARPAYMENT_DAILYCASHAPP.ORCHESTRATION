{"job":{"components":{"6340366":{"id":6340366,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-448,"y":-192,"width":32,"height":32,"inputConnectorIDs":[6340374],"outputSuccessConnectorIDs":[6340372],"outputFailureConnectorIDs":[6340376],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Status","mapTo":"audit_status"},"2":{"slot":2,"fromId":null,"fromName":"Component","mapTo":"audit_component"},"3":{"slot":3,"fromId":null,"fromName":"Started At","mapTo":"audit_started"},"4":{"slot":4,"fromId":null,"fromName":"Duration","mapTo":"audit_duration"},"5":{"slot":5,"fromId":null,"fromName":"Completed At","mapTo":"audit_completed"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LAWSON_DL_LDG_ARPAYMENT_DAILYCASHAPP"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MERGE INTO      ${SNFLENTDB}.${SNFLDWHSCH}.LAWSON_DL_LDG_ARPAYMENT_DAILYCASHAPP TGT USING\n  (  SELECT                                      ltrim(rtrim(SRC.company)) as company,\n                                                 ltrim(rtrim(SRC.BATCH_NBR)) as BATCH_NBR,\n                                                 ltrim(rtrim(SRC.PAYMENT_SEQ )) as PAYMENT_SEQ,\n                                                 ltrim(rtrim(SRC.STATUS)) as STATUS,\n                                                 ltrim(rtrim(SRC.customer)) as customer,\n                                                 ltrim(rtrim(SRC.GL_DATE)) as GL_DATE,\n                                                 ltrim(rtrim(SRC.TRANS_TYPE)) as TRANS_TYPE,\n                                                 ltrim(rtrim(SRC.TRANS_NBR)) as TRANS_NBR,\n                                                 ltrim(rtrim(SRC.TRAN_AMT)) as TRAN_AMT,\n                                                 ltrim(rtrim(SRC.APPLD_AMT)) as APPLD_AMT,\n                                                 ltrim(rtrim(SRC.PROCESS_LEVEL)) as PROCESS_LEVEL,\n                                                 ltrim(rtrim(SRC.CASH_CODE)) as CASH_CODE,\n                                                 ltrim(rtrim(SRC.ORIG_AMT)) as ORIG_AMT,\n                                                 ltrim(rtrim(SRC.ORIG_APP_AMT)) as ORIG_APP_AMT,\n                                                 ltrim(rtrim(SRC.CREDIT_APPLD)) as CREDIT_APPLD,\n                                                 ltrim(rtrim(SRC.ORIG_CR_APPLD)) as ORIG_CR_APPLD,\n                                                 ltrim(rtrim(SRC.ADJ_AMT)) as ADJ_AMT,\n                                                 ltrim(rtrim(SRC.ORIG_ADJ_AMT)) as ORIG_ADJ_AMT,\n\t\t\t\t\t\t\t\t\t\t\t\t ltrim(rtrim(SRC.DEPOSIT_DATE)) as DEPOSIT_DATE\n                                 FROM            ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.arpayment  SRC\n                                                 \n                                 WHERE           ltrim(rtrim(SRC.status)) IN (2,7,8,9)\n                                 AND              ltrim(rtrim(SRC.trans_type)) = 'P' \n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t) SRC\n\t\t\t\t\t\t\t\t\t    ON \tltrim(rtrim(SRC.company)) = ltrim(rtrim(TGT.company))\n                                        AND ltrim(rtrim(SRC.BATCH_NBR)) = ltrim(rtrim(TGT.BATCH_NBR))\n                                        AND ltrim(rtrim(SRC.payment_seq)) = ltrim(rtrim(TGT.payment_seq))\nWHEN MATCHED\nAND (   \t\t\tltrim(rtrim(SRC.status)) \t\t<> ltrim(rtrim(tgt.status))\n\t\tOR          ltrim(rtrim(SRC.customer))  \t<> ltrim(rtrim(tgt.customer))\n\t\tOR          ltrim(rtrim(SRC.GL_DATE))  \t\t<> ltrim(rtrim(tgt.GL_DATE))\n\t\tOR          ltrim(rtrim(SRC.TRANS_TYPE))  \t<> ltrim(rtrim(tgt.TRANS_TYPE))\n\t\tOR          ltrim(rtrim(SRC.TRANS_NBR))  \t\t<> ltrim(rtrim(tgt.TRANS_NBR))\n\t\tOR          ltrim(rtrim(SRC.TRAN_AMT))  \t\t<> ltrim(rtrim(tgt.TRAN_AMT))\n\t\tOR          ltrim(rtrim(SRC.APPLD_AMT)) \t\t<> ltrim(rtrim(tgt.APPLD_AMT))\n\t\tOR          ltrim(rtrim(SRC.process_level)) \t<> ltrim(rtrim(tgt.process_level))\n\t\tOR          ltrim(rtrim(SRC.CASH_CODE)) \t\t<> ltrim(rtrim(tgt.CASH_CODE))\n\t\tOR          ltrim(rtrim(SRC.ORIG_AMT)) \t\t<> ltrim(rtrim(tgt.ORIG_AMT))\n\t\tOR          ltrim(rtrim(SRC.ORIG_APP_AMT)) \t<> ltrim(rtrim(tgt.ORIG_APP_AMT))\n\t\tOR          ltrim(rtrim(SRC.CREDIT_APPLD)) \t<> ltrim(rtrim(tgt.CREDIT_APPLD))\n\t\tOR          ltrim(rtrim(SRC.ORIG_CR_APPLD)) \t<> ltrim(rtrim(tgt.ORIG_CR_APPLD))  \n\t\tOR          ltrim(rtrim(SRC.ADJ_AMT)) \t\t<> ltrim(rtrim(tgt.ADJ_AMT))\n\t\tOR          ltrim(rtrim(SRC.ORIG_ADJ_AMT)) \t<> ltrim(rtrim(tgt.ORIG_ADJ_AMT)) \n\t\t)  \n        AND tgt.DL_MODIFIED_DATE is null \n \nTHEN\nUPDATE\nSET     dl_modified_date = TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(0)),\n\t    ACTIVE_STATUS = 'N',\n        dl_jobid = '${run_history_id}'\nWHEN NOT MATCHED THEN INSERT ( \n\t\t\t\tTGT.company,\n\t\t\t\tTGT.BATCH_NBR,\n\t\t\t\tTGT.PAYMENT_SEQ,\n\t\t\t\tTGT.STATUS,\n\t\t\t\tTGT.customer,\n\t\t\t\tTGT.GL_DATE,\n\t\t\t\tTGT.TRANS_TYPE,\n\t\t\t\tTGT.TRANS_NBR,\n\t\t\t\tTGT.TRAN_AMT,\n\t\t\t\tTGT.APPLD_AMT,\n\t\t\t\tTGT.PROCESS_LEVEL,\n\t\t\t\tTGT.CASH_CODE,\n\t\t\t\tTGT.ORIG_AMT,\n\t\t\t\tTGT.ORIG_APP_AMT,\n\t\t\t\tTGT.CREDIT_APPLD,\n\t\t\t\tTGT.ORIG_CR_APPLD,\n\t\t\t\tTGT.ADJ_AMT,\n\t\t\t\tTGT.ORIG_ADJ_AMT,\n\t\t\t\tTGT.DEPOSIT_DATE,\n              TGT.DL_CREATED_DATE ,\n\t\t\t  TGT.ACTIVE_STATUS,\n              TGT.dl_created_by,\n              TGT.dl_jobid)\nVALUES (  SRC.company,\n\t\t\tSRC.BATCH_NBR,\n\t\t\tSRC.PAYMENT_SEQ,\n\t\t\tSRC.STATUS,\n\t\t\tSRC.customer,\n\t\t\tSRC.GL_DATE,\n\t\t\tSRC.TRANS_TYPE,\n\t\t\tSRC.TRANS_NBR,\n\t\t\tSRC.TRAN_AMT,\n\t\t\tSRC.APPLD_AMT,\n\t\t\tSRC.PROCESS_LEVEL,\n\t\t\tSRC.CASH_CODE,\n\t\t\tSRC.ORIG_AMT,\n\t\t\tSRC.ORIG_APP_AMT,\n\t\t\tSRC.CREDIT_APPLD,\n\t\t\tSRC.ORIG_CR_APPLD,\n\t\t\tSRC.ADJ_AMT,\n\t\t\tSRC.ORIG_ADJ_AMT,\n\t\t\tSRC.DEPOSIT_DATE\n\t\t\t, TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(0)), \n\t\t\t   'Y',\n             '${environment_username}',\n\t\t\t '${run_history_id}' );\n \n  ------------------------- Insert -----------------------------------------------------------\n\nMERGE INTO        ${SNFLENTDB}.${SNFLDWHSCH}.LAWSON_DL_LDG_ARPAYMENT_DAILYCASHAPP TGT USING\n  (  SELECT                                      ltrim(rtrim(SRC.company)) as company,\n                                                 ltrim(rtrim(SRC.BATCH_NBR)) as BATCH_NBR,\n                                                 ltrim(rtrim(SRC.PAYMENT_SEQ )) as PAYMENT_SEQ,\n                                                 ltrim(rtrim(SRC.STATUS)) as STATUS,\n                                                 ltrim(rtrim(SRC.customer)) as customer,\n                                                 ltrim(rtrim(SRC.GL_DATE)) as GL_DATE,\n                                                 ltrim(rtrim(SRC.TRANS_TYPE)) as TRANS_TYPE,\n                                                 ltrim(rtrim(SRC.TRANS_NBR)) as TRANS_NBR,\n                                                 ltrim(rtrim(SRC.TRAN_AMT)) as TRAN_AMT,\n                                                 ltrim(rtrim(SRC.APPLD_AMT)) as APPLD_AMT,\n                                                 ltrim(rtrim(SRC.PROCESS_LEVEL)) as PROCESS_LEVEL,\n                                                 ltrim(rtrim(SRC.CASH_CODE)) as CASH_CODE,\n                                                 ltrim(rtrim(SRC.ORIG_AMT)) as ORIG_AMT,\n                                                 ltrim(rtrim(SRC.ORIG_APP_AMT)) as ORIG_APP_AMT,\n                                                 ltrim(rtrim(SRC.CREDIT_APPLD)) as CREDIT_APPLD,\n                                                 ltrim(rtrim(SRC.ORIG_CR_APPLD)) as ORIG_CR_APPLD,\n                                                 ltrim(rtrim(SRC.ADJ_AMT)) as ADJ_AMT,\n                                                 ltrim(rtrim(SRC.ORIG_ADJ_AMT)) as ORIG_ADJ_AMT,\n\t\t\t\t\t\t\t\t\t\t\t\t ltrim(rtrim(SRC.DEPOSIT_DATE)) as DEPOSIT_DATE\n                                 FROM            ${SFDBPROD_DATALAKE}.${SFSCHLAWPROD}.arpayment   SRC\n                                                   \n                                 WHERE           ltrim(rtrim(SRC.status)) IN (2,7,8,9)\n                                 AND              ltrim(rtrim(SRC.trans_type)) = 'P' \n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t) SRC\n\t\t\t\t\t\t\t\t\t    ON \tltrim(rtrim(SRC.company)) = ltrim(rtrim(TGT.company))\n                                        AND ltrim(rtrim(SRC.BATCH_NBR)) = ltrim(rtrim(TGT.BATCH_NBR))\n                                        AND ltrim(rtrim(SRC.payment_seq)) = ltrim(rtrim(TGT.payment_seq))\n                                        AND TGT.DL_MODIFIED_DATE is null \n          \nWHEN NOT MATCHED THEN INSERT ( \n\t\t\t\tTGT.company,\n\t\t\t\tTGT.BATCH_NBR,\n\t\t\t\tTGT.PAYMENT_SEQ,\n\t\t\t\tTGT.STATUS,\n\t\t\t\tTGT.customer,\n\t\t\t\tTGT.GL_DATE,\n\t\t\t\tTGT.TRANS_TYPE,\n\t\t\t\tTGT.TRANS_NBR,\n\t\t\t\tTGT.TRAN_AMT,\n\t\t\t\tTGT.APPLD_AMT,\n\t\t\t\tTGT.PROCESS_LEVEL,\n\t\t\t\tTGT.CASH_CODE,\n\t\t\t\tTGT.ORIG_AMT,\n\t\t\t\tTGT.ORIG_APP_AMT,\n\t\t\t\tTGT.CREDIT_APPLD,\n\t\t\t\tTGT.ORIG_CR_APPLD,\n\t\t\t\tTGT.ADJ_AMT,\n\t\t\t\tTGT.ORIG_ADJ_AMT,\n\t\t\t\tTGT.DEPOSIT_DATE,\n              TGT.DL_CREATED_DATE,\n\t\t\t  TGT.ACTIVE_STATUS,\n              TGT.dl_created_by,\n              TGT.dl_jobid)\nVALUES (  SRC.company,\n\t\t\tSRC.BATCH_NBR,\n\t\t\tSRC.PAYMENT_SEQ,\n\t\t\tSRC.STATUS,\n\t\t\tSRC.customer,\n\t\t\tSRC.GL_DATE,\n\t\t\tSRC.TRANS_TYPE,\n\t\t\tSRC.TRANS_NBR,\n\t\t\tSRC.TRAN_AMT,\n\t\t\tSRC.APPLD_AMT,\n\t\t\tSRC.PROCESS_LEVEL,\n\t\t\tSRC.CASH_CODE,\n\t\t\tSRC.ORIG_AMT,\n\t\t\tSRC.ORIG_APP_AMT,\n\t\t\tSRC.CREDIT_APPLD,\n\t\t\tSRC.ORIG_CR_APPLD,\n\t\t\tSRC.ADJ_AMT,\n\t\t\tSRC.ORIG_ADJ_AMT,\n\t\t\tSRC.DEPOSIT_DATE\n\t\t\t, TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(0)), \n\t\t\t   'Y',\n              '${environment_username}',\n\t\t\t  '${run_history_id}' );\n             \n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6340367":{"id":6340367,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-16,"y":-192,"width":32,"height":32,"inputConnectorIDs":[6340373],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT_LAWSON_DL_LDG_ARPAYMENT_DAILYCASHAPP_SUCCESS"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_LAWSON_DL_LDG_ARPAYMENT_DAILYCASHAPP"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_component"},"2":{"slot":2,"type":"STRING","value":"LAWSON_DL_LDG_ARPAYMENT_DAILYCASHAPP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"SUCCESS"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6340368":{"id":6340368,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-624,"y":-192,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6340374],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6340369":{"id":6340369,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-16,"y":-96,"width":32,"height":32,"inputConnectorIDs":[6340375],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT_LAWSON_DL_LDG_ARPAYMENT_DAILYCASHAPP_FAILURE"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_LAWSON_DL_LDG_ARPAYMENT_DAILYCASHAPP"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"FAILURE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_component"},"2":{"slot":2,"type":"STRING","value":"LAWSON_DL_LDG_ARPAYMENT_DAILYCASHAPP"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6340370":{"id":6340370,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":-256,"y":-192,"width":32,"height":32,"inputConnectorIDs":[6340372],"outputSuccessConnectorIDs":[6340373],"outputFailureConnectorIDs":[6340377],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Completed At","mapTo":"audit_completed"},"2":{"slot":2,"fromId":null,"fromName":"Started At","mapTo":"audit_started"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_Row_Count"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select count(*) as RowCount from ${SNFLENTDB}.${SNFLDWHSCH}.LAWSON_DL_LDG_ARPAYMENT_DAILYCASHAPP\nwhere DL_JOBID = ${run_history_id}"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_rowcount"},"2":{"slot":2,"type":"STRING","value":"ROWCOUNT"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6340371":{"id":6340371,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-320,"y":-96,"width":32,"height":32,"inputConnectorIDs":[6340376,6340377],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6340375],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Started At","mapTo":"audit_started"},"2":{"slot":2,"fromId":null,"fromName":"Completed At","mapTo":"audit_completed"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALL_FAILURES"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"6340372":{"id":6340372,"sourceID":6340366,"targetID":6340370},"6340373":{"id":6340373,"sourceID":6340370,"targetID":6340367}},"failureConnectors":{"6340376":{"id":6340376,"sourceID":6340366,"targetID":6340371},"6340377":{"id":6340377,"sourceID":6340370,"targetID":6340371}},"unconditionalConnectors":{"6340374":{"id":6340374,"sourceID":6340368,"targetID":6340366},"6340375":{"id":6340375,"sourceID":6340371,"targetID":6340369}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{},"grids":{}},"info":{"name":"jb_LAWSON_DL_LDG_ARPAYMENT_DAILYCASHAPP","description":"","type":"ORCHESTRATION","tag":"9292c51a-f221-4258-8d4e-b9d2370a1120"}}