{"job":{"components":{"6341954":{"id":6341954,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-928,"y":-224,"width":32,"height":32,"inputConnectorIDs":[6341972],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_UKG_OPEN_AND_CLOSED_REQUISITIONS_Success"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341955":{"id":6341955,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-1152,"y":-320,"width":32,"height":32,"inputConnectorIDs":[6341978],"outputSuccessConnectorIDs":[6341968],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_UKG_OPEN_AND_CLOSED_REQUISITIONS_Failure"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"_Audit_Datalake_Public"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_component"},"2":{"slot":2,"type":"STRING","value":"UKG_OPEN_AND_CLOSED_REQUISITIONS"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"FAILED"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"audit_rowcount"},"2":{"slot":2,"type":"STRING","value":"0"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341956":{"id":6341956,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1984,"y":-320,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6341976],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341957":{"id":6341957,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":-1872,"y":-288,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Started At","mapTo":"audit_started"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UKG_OPEN_AND_CLOSED_REQUISITIONS_API"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import pandas as pd\nimport boto3\nimport botocore\nimport json\nimport time\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom io import StringIO\nimport requests\nimport xml.etree.ElementTree as ET\nimport base64\nimport traceback\n\"\"\"The goal of this script is to take the data from the API and\ndrop it to s3 in a file called 's3://etld1/UltiPro/Requisitions/Open and Closed Requisitions.csv'\"\"\"\n\n####################################### DECLARE VARIABLES ####################################################\n\"\"\"This section lays out the amazon s3 resources for the UltiPro data to stage to snowflake. \"\"\"\nBUCKET_NAME = s3_URL.replace(\"s3:\", '').strip('/')\nKEY = 'UltiPro/Requisitions/Open and Closed Requisitions.csv'\nulti_un = 'DataLake'\nulti_pw = 'STsj=YyLAe{ODi1NUM;?[ykWf=!OUU2MIWicOxxxi^i=2v?5C^'\nAUTH = (ulti_un, ulti_pw)\ns3 = boto3.resource('s3')\nBaseUriConfiguration = \"service5.ultipro.com\"\nlogin_request_url = f\"https://{BaseUriConfiguration}/services/BIDataService\"\ncak = \"Z1JCJ\"\nuak = \"DNQN1R000010\"\n\nraasReportPath = \"/content/folder[@name='zzzCompany Folders']/folder[@name='EmployBridge, LLC']/folder[@name='UltiPro']/folder[@name='DataLake']/report[@name='Open and Closed Requisitions']\"\n\n\n\nlogin_request_headers = {\n\t\t\"Host\": BaseUriConfiguration, \"Content-Type\": \"application/soap+xml; charset=utf-8\", \"Expect\": \"100-continue\",\n\t\t\"Accept-Encoding\": \"gzip, deflate\", \"Connection\": \"Keep-Alive\"}\n####################################### DEFINE METHODS ####################################################\n\ndef login(ulti_un, ulti_pw, cak, uak, login_request_url, login_request_headers):\n\tlogin_request_body = f\"\"\"\n\t<s:Envelope xmlns:s=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:a=\"http://www.w3.org/2005/08/addressing\">\n\t\t\t<s:Header>\n\t\t\t\t<a:Action s:mustUnderstand=\"1\">http://www.ultipro.com/dataservices/bidata/2/IBIDataService/LogOn</a:Action>\n\t\t\t\t<a:MessageID>urn:uuid:7e5d2b3f-00cf-4171-b568-af831c49b747</a:MessageID>\n\t\t\t\t<a:ReplyTo>\n\t\t\t\t\t<a:Address>http://www.w3.org/2005/08/addressing/anonymous</a:Address>\n\t\t\t\t</a:ReplyTo>\n\t\t\t\t<a:To s:mustUnderstand=\"1\">https://service2.ultipro.com/services/BIDataService</a:To>\n\t\t\t</s:Header>\n\t\t\t<s:Body>\n\t\t\t\t<LogOn xmlns=\"http://www.ultipro.com/dataservices/bidata/2\">\n\t\t\t\t\t<logOnRequest xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\">\n\t\t\t\t\t\t<UserName>{ulti_un}</UserName>\n\t\t\t\t\t\t<Password>{ulti_pw}</Password>\n\t\t\t\t\t\t<ClientAccessKey>{cak}</ClientAccessKey>\n\t\t\t\t\t\t<UserAccessKey>{uak}</UserAccessKey>\n\t\t\t\t\t</logOnRequest>\n\t\t\t\t</LogOn>\n\t\t\t</s:Body>\n\t\t</s:Envelope>\"\"\"\n\t\n\tresponse = requests.post(\n\t\tlogin_request_url, data=login_request_body, headers=login_request_headers)\n\tresp = response.text\n\t# parsing xml response to get creds\n\troot_ele = ET.fromstring(resp)\n\tnamespaces = {\n\t\t'body': 'http://www.w3.org/2003/05/soap-envelope',\n\t\t'logon-response': 'http://www.ultipro.com/dataservices/bidata/2',\n\t\t'logon-result': 'http://www.ultipro.com/dataservices/bidata/2'\n\t}\n\tbody = root_ele.find('body:Body', namespaces)\n\tlg_resp = body.find('logon-response:LogOnResponse',\n\t\t\t\t\t\tnamespaces) if body else None\n\tlg_result = lg_resp.find('logon-result:LogOnResult',\n\t\t\t\t\t\t\t\tnamespaces) if lg_resp else None\n\tif (not lg_result) or len(lg_result) != 6:\n\t\tprint('Login Request Failed...Please try Again')\n\t\treturn {}\n\toutput_login_req = {}\n\tfor element in lg_result:\n\t\tif 'ServiceId' in element.tag:\n\t\t\toutput_login_req['ServiceId'] = element.text\n\t\telif 'Token' in element.tag:\n\t\t\toutput_login_req['Token'] = element.text\n\t\telif 'InstanceKey' in element.tag:\n\t\t\toutput_login_req['InstanceKey'] = element.text\n\treturn output_login_req\n  \ndef get_er_result(output_login_req, raasReportPath, cak): \n\texecute_report_body = f\"\"\"\n\t<s:Envelope xmlns:s=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:a=\"http://www.w3.org/2005/08/addressing\">\n\t\t<s:Header>\n\t\t<a:Action s:mustUnderstand=\"1\">http://www.ultipro.com/dataservices/bidata/2/IBIDataService/ExecuteReport</a:Action>\n\t\t<a:MessageID>urn:uuid:f42623fb-2d80-4860-baf2-18b9d4174cfd</a:MessageID>\n\t\t<a:ReplyTo>\n\t\t\t<a:Address>http://www.w3.org/2005/08/addressing/anonymous</a:Address>\n\t\t</a:ReplyTo>\n\t\t<a:To s:mustUnderstand=\"1\">https://service2.ultipro.com/services/BIDataService</a:To>\n\t\t</s:Header>\n\t\t<s:Body>\n\t\t<ExecuteReport xmlns=\"http://www.ultipro.com/dataservices/bidata/2\">\n\t\t\t<request xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\">\n\t\t\t<ReportPath>{raasReportPath}</ReportPath>\n\t\t\t<ReportParameters/>\n\t\t\t</request>\n\t\t\t<context xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\">\n\t\t\t<ServiceId>{output_login_req['ServiceId']}</ServiceId>\n\t\t\t<ClientAccessKey>{cak}</ClientAccessKey>\n\t\t\t<Token>{output_login_req['Token']}</Token>\n\t\t\t<Status>Ok</Status>\n\t\t\t<StatusMessage i:nil=\"true\"/>\n\t\t\t<InstanceKey>{output_login_req['InstanceKey']}</InstanceKey>\n\t\t\t</context>\n\t\t\t</ExecuteReport>\n\t\t</s:Body>\n\t</s:Envelope>\n\t\"\"\"\n\n\tresponse = requests.post(\n\t\tlogin_request_url, data=execute_report_body, headers=login_request_headers)\n\tprint('ExecuteReport Done')\n\tprint(\"--------------------------------\")\n\tresp = response.text\n\tprint(resp)\n\tprint(\"--------------------------------\")\n\troot_execute = ET.fromstring(resp)\n\texecute_report_namespaces = {\n\t\t'body': 'http://www.w3.org/2003/05/soap-envelope',\n\t\t'execute-report-response': 'http://www.ultipro.com/dataservices/bidata/2',\n\t\t'execute-report-result': 'http://www.ultipro.com/dataservices/bidata/2'\n\t}\n\tbody = root_execute.find('body:Body', execute_report_namespaces)\n\ter_resp = body.find('execute-report-response:ExecuteReportResponse',\n\t\t\t\t\t\texecute_report_namespaces) if body else None\n\ter_result = er_resp.find('execute-report-result:ExecuteReportResult',\n\t\t\t\t\t\t\t\texecute_report_namespaces) if er_resp else None\n\tif (not er_result) or len(er_result) != 4:\n\t\tprint('Execute Report Failed! Please try Again')\n\t\treturn {}\n\toutput_execute_report = {}\n\tfor element in er_result:\n\t\tif 'ReportKey' in element.tag:\n\t\t\toutput_execute_report['ReportKey'] = element.text\n\treturn output_execute_report\n  \ndef get_decoded_csv(output_execute_report, BaseUriConfiguration):\n\tretrieve_report_url = f\"https://{BaseUriConfiguration}/services/BIStreamingService\"\n\tretrieve_report_body = f\"\"\"\n\t<s:Envelope xmlns:s=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:a=\"http://www.w3.org/2005/08/addressing\">\n\t\t<s:Header>\n\t\t\t<a:Action s:mustUnderstand=\"1\">http://www.ultipro.com/dataservices/bistream/2/IBIStreamService/RetrieveReport</a:Action>\n\t\t\t<h:ReportKey xmlns:h=\"http://www.ultipro.com/dataservices/bistream/2\" xmlns=\"http://www.ultipro.com/dataservices/bistream/2\">{output_execute_report['ReportKey']}</h:ReportKey>\n\t\t\t<a:MessageID>urn:uuid:8332571f-3a89-4442-ac80-27195b397b4d</a:MessageID>\n\t\t\t<a:ReplyTo>\n\t\t\t\t<a:Address>http://www.w3.org/2005/08/addressing/anonymous</a:Address>\n\t\t\t</a:ReplyTo>\n\t\t\t<a:To s:mustUnderstand=\"1\">https://service2.ultipro.com/services/BIStreamingService</a:To>\n\t\t</s:Header>\n\t\t<s:Body xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\">\n\t\t\t<RetrieveReportRequest xmlns=\"http://www.ultipro.com/dataservices/bistream/2\"/>\n\t\t</s:Body>\n\t</s:Envelope>\n\t\"\"\"\n\tif login_request_headers.get(\"US-DELIMITER\"):\n\t\tdel login_request_headers[\"US-DELIMITER\"]\n        \n\tpos = 1\n\titer = 0\n\twhile pos > 0:\n\t\ttime.sleep(30)  \n\t\titer = iter + 1\n\t\tresponse = requests.post(retrieve_report_url, data=retrieve_report_body, headers=login_request_headers)\t\n\t\n\t\tresp = response.text\n\t\tprint(f'Retrieve #{iter} Request Done')    \n\t\tpos = resp.find('Working')\n\t\tif pos > 0:\n\t\t\tprint(f'Status = Working found at character position {pos}.  Need another iteration...')\n\t\telse:\n\t\t\tprint(f'Results found on iteration {iter}')\n            \n\t\tif response.status_code != 200:\n\t\t\tresult = \"Failure\"\n\t\t\tpos = 0\n\t\telse:\n\t\t\tresult = \"Success\"\n\t\n\tprint(resp)    \n\tprint(f\"retrieve status code: {response.status_code}\")\n\tprint(f\"Retrieve Status: '{result}'\")\n\tcontext.updateVariable(\"API_Status\", result)\n    \n\troot_retrieve = ET.fromstring(resp)\n\tretrieve_report_namespaces = {\n\t\t'body': 'http://www.w3.org/2003/05/soap-envelope',\n\t\t'stream-report-response': 'http://www.ultipro.com/dataservices/bistream/2'\n\t}\n\tbody = root_retrieve.find('body:Body', retrieve_report_namespaces)\n\trr_resp = body.find('stream-report-response:StreamReportResponse',\n\t\t\t\t\t\tretrieve_report_namespaces) if body else None\n\tif not rr_resp:\n\t\treturn ''\n\tendcoded_data = None\n\tfor element in rr_resp:\n\t\tif 'ReportStream' in element.tag:\n\t\t\tendcoded_data = element.text\n\t\t\tbreak\n                \n\tif not result == \"Success\":\n\t\treturn ''\n\ttry:\n\t\tdecoded_csv = base64.b64decode(endcoded_data)\n\texcept Exception as ex:\n\t\tprint(ex)\n\t\treturn ''\n\treturn decoded_csv.decode('cp1252')\n  \ndef get_data():\n\tprint(\"Getting data from UKG Open and Closed Requisitions API\")\n\toutput_login_req = login(ulti_un, ulti_pw, cak, uak, login_request_url, login_request_headers)\n\tlogin_request_headers.update({\"US-DELIMITER\": \",\"})\n\toutput_execute_report = get_er_result(output_login_req, raasReportPath, cak)\n\t\n\tdecoded_csv = get_decoded_csv(output_execute_report, BaseUriConfiguration)\n\tprint(\"Data pull complete\")\n\treturn decoded_csv\n\ndef load_s3(data):\n\tprint(\"Starting S3 Load\")\n\tif len(data) == 0:\n\t\tprint(\"No data to load\")\n        #raise error\n\t\traise Exception (\"No Data\")\n\telse:\n\t\tprint(\"Data Loading\")\n\tdata = StringIO(data)\n\tdf = pd.read_csv(data)\n\tdf['DL_CREATED_DATE'] = datetime.utcnow()\n\tdf['DL_CREATEDBY'] = environment_username\n\tdf['DL_JOBID'] = run_history_id\n\tcsv_buffer = StringIO()\n\tdf.to_csv(csv_buffer, index=False, line_terminator='\\n', quotechar='\"')\n\ts3.Object(BUCKET_NAME, KEY).put(Body=csv_buffer.getvalue())\n\tprint(\"S3 Load complete\")\n\n####################################### RUN PROGRAM ####################################################\nif __name__ == '__main__':\n\t#with requests.Session() as s:\n\t\t#s.auth = AUTH\n\t\t#finaldata = get_data()\n\ttry:\n\n\t\twith requests.Session() as s:\n\t\t\ts.auth = AUTH\n\t\t\tfinaldata = get_data()\n\n\t\tload_s3(finaldata)\n\texcept Exception as e:\n\t\tprint(\"No data available\")"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"1200"}}}},"visible":true},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[6341951]},"6341958":{"id":6341958,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1760,"y":-224,"width":32,"height":32,"inputConnectorIDs":[6341974],"outputSuccessConnectorIDs":[6341970],"outputFailureConnectorIDs":[6341979],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate LDG"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRUNCATE ${SNFLKDB_PDL}.${SNFLKSCH_UKG}.LDG_UKG_REQUISITION"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341959":{"id":6341959,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-1712,"y":-144,"width":32,"height":32,"inputConnectorIDs":[6341977],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Status","mapTo":"audit_status"},"2":{"slot":2,"fromId":null,"fromName":"Started At","mapTo":"audit_started"},"3":{"slot":3,"fromId":null,"fromName":"Completed At","mapTo":"audit_completed"},"4":{"slot":4,"fromId":null,"fromName":"Duration","mapTo":"audit_duration"},"5":{"slot":5,"fromId":null,"fromName":"Component","mapTo":"audit_component"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UKG_REQUISITIONS_API_FAILURE"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341960":{"id":6341960,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1344,"y":-224,"width":32,"height":32,"inputConnectorIDs":[6341973],"outputSuccessConnectorIDs":[6341969],"outputFailureConnectorIDs":[6341983],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Component","mapTo":"audit_component"},"2":{"slot":2,"fromId":null,"fromName":"Completed At","mapTo":"audit_completed"},"3":{"slot":3,"fromId":null,"fromName":"Duration","mapTo":"audit_duration"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UKG_OPEN_AND_CLOSED_REQUISITIONS"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MERGE INTO ${SNFLKDB_PDL}.${SNFLKSCH_UKG}.UKG_REQUISITION AS TGT\nUSING (SELECT REQUISITION_NUMBER,\n              OPPORTUNITY_TITLE,\n              CREATED_DATE,\n              FIRST_PUBLISHED_DATE,\t\n              CLOSED_DATE,\n              SOURCE_JOB_CODE,\n              HIRING_MANAGER,\n              LOCATION,\n              DIVISION,\n              REGION,\n              REGEXP_REPLACE(ACCOUNTING_UNIT, '[^[:digit:]]', '') AS ACCOUNTING_UNIT_NUMBER, \n              TRIM(REGEXP_REPLACE(ACCOUNTING_UNIT, '[[:digit:]]', ''),' -') AS ACCOUNTING_UNIT_NAME,\n              BRAND,\n              COMPANY_CODE,\n              OPPORTUNITY_STATUS,\n              REASON_FOR_OPENING,\n              INCUMBENT_NAME,\n              START_DATE,\n              DL_CREATEDBY,\n              DL_CREATED_DATE,\n              DL_JOBID,\n              HASH(OPPORTUNITY_TITLE,\n                   CREATED_DATE,\n                   FIRST_PUBLISHED_DATE,\t\n                   CLOSED_DATE,\n                   SOURCE_JOB_CODE,\n                   HIRING_MANAGER,\n                   LOCATION,\n                   DIVISION,\n                   REGION,\n                   REGEXP_REPLACE(ACCOUNTING_UNIT, '[^[:digit:]]', ''),\n                   TRIM(REGEXP_REPLACE(ACCOUNTING_UNIT, '[[:digit:]]', ''),' -'),\n                   BRAND,\n                   COMPANY_CODE,\n                   OPPORTUNITY_STATUS,\n                   REASON_FOR_OPENING,\n                   INCUMBENT_NAME,\n                   START_DATE) AS TRACKINGHASH\n         FROM ${SNFLKDB_PDL}.${SNFLKSCH_UKG}.LDG_UKG_REQUISITION) AS LDG\n   ON LDG.REQUISITION_NUMBER = TGT.REQUISITION_NUMBER\n  \nWHEN MATCHED \n AND LDG.TRACKINGHASH <>  HASH(TGT.OPPORTUNITY_TITLE,\n                               TGT.CREATED_DATE,\n                               TGT.FIRST_PUBLISHED_DATE,\t\n                               TGT.CLOSED_DATE,\n                               TGT.SOURCE_JOB_CODE,\n                               TGT.HIRING_MANAGER,\n                               TGT.LOCATION,\n                               TGT.DIVISION,\n                               TGT.REGION,\n                               TGT.ACCOUNTING_UNIT_NUMBER, \n                               TGT.ACCOUNTING_UNIT_NAME,\n                               TGT.BRAND,\n                               TGT.COMPANY_CODE,\n                               TGT.OPPORTUNITY_STATUS,\n                               TGT.REASON_FOR_OPENING,\n                               TGT.INCUMBENT_NAME,\n                               TGT.START_DATE) \nTHEN \n     UPDATE SET TGT.REQUISITION_NUMBER     = LDG.REQUISITION_NUMBER,\n                TGT.OPPORTUNITY_TITLE      = LDG.OPPORTUNITY_TITLE,\n                TGT.CREATED_DATE           = LDG.CREATED_DATE,\n                TGT.FIRST_PUBLISHED_DATE   = LDG.FIRST_PUBLISHED_DATE,\t\n                TGT.CLOSED_DATE            = LDG.CLOSED_DATE,\n                TGT.SOURCE_JOB_CODE        = LDG.SOURCE_JOB_CODE,\n                TGT.HIRING_MANAGER         = LDG.HIRING_MANAGER,\n                TGT.LOCATION               = LDG.LOCATION,\n                TGT.DIVISION               = LDG.DIVISION,\n                TGT.REGION                 = LDG.REGION,\n                TGT.ACCOUNTING_UNIT_NUMBER = LDG.ACCOUNTING_UNIT_NUMBER,\n                TGT.ACCOUNTING_UNIT_NAME   = LDG.ACCOUNTING_UNIT_NAME,\n                TGT.BRAND                  = LDG.BRAND,\n                TGT.COMPANY_CODE           = LDG.COMPANY_CODE,\n                TGT.OPPORTUNITY_STATUS     = LDG.OPPORTUNITY_STATUS,\n                TGT.REASON_FOR_OPENING     = LDG.REASON_FOR_OPENING,\n                TGT.INCUMBENT_NAME         = LDG.INCUMBENT_NAME,\n                TGT.START_DATE             = LDG.START_DATE,\n                TGT.DL_MODIFIED_DATE       = CURRENT_TIMESTAMP,\n                TGT.DL_MODIFIEDBY          = '${environment_username}',\n                TGT.DL_JOBID               = '${run_history_id}'\nWHEN NOT MATCHED THEN \n\t       INSERT (REQUISITION_NUMBER,\n                   OPPORTUNITY_TITLE,\n                   CREATED_DATE,\n                   FIRST_PUBLISHED_DATE,\t\n                   CLOSED_DATE,\n                   SOURCE_JOB_CODE,\n                   HIRING_MANAGER,\n                   LOCATION,\n                   DIVISION,\n                   REGION,\n                   ACCOUNTING_UNIT_NUMBER,\n                   ACCOUNTING_UNIT_NAME,\n                   BRAND,\n                   COMPANY_CODE,\n                   OPPORTUNITY_STATUS,\n                   REASON_FOR_OPENING,\n                   INCUMBENT_NAME,\n                   START_DATE,\n                   DL_CREATEDBY,\n                   DL_MODIFIEDBY,\n                   DL_CREATED_DATE,\n                   DL_MODIFIED_DATE,\n                   DL_JOBID) \n           VALUES (REQUISITION_NUMBER,\n                   OPPORTUNITY_TITLE,\n                   CREATED_DATE,\n                   FIRST_PUBLISHED_DATE,\t\n                   CLOSED_DATE,\n                   SOURCE_JOB_CODE,\n                   HIRING_MANAGER,\n                   LOCATION,\n                   DIVISION,\n                   REGION,\n                   ACCOUNTING_UNIT_NUMBER,\n                   ACCOUNTING_UNIT_NAME,\n                   BRAND,\n                   COMPANY_CODE,\n                   OPPORTUNITY_STATUS,\n                   REASON_FOR_OPENING,\n                   INCUMBENT_NAME,\n                   START_DATE,\n                   DL_CREATEDBY,\n                   '${environment_username}',\n                   DL_CREATED_DATE,\n                   CURRENT_TIMESTAMP,\n                   DL_JOBID);\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341961":{"id":6341961,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-1872,"y":-224,"width":32,"height":32,"inputConnectorIDs":[6341971],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[6341974],"outputFalseConnectorIDs":[6341975],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"API_Check"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"API_Status"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"Success"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341962":{"id":6341962,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-1456,"y":-320,"width":32,"height":32,"inputConnectorIDs":[6341979,6341980,6341981,6341982,6341983],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6341978],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Started At","mapTo":"audit_started"},"2":{"slot":2,"fromId":null,"fromName":"Completed At","mapTo":"audit_completed"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Failure"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341963":{"id":6341963,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-944,"y":-320,"width":32,"height":32,"inputConnectorIDs":[6341968],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341964":{"id":6341964,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":773867971,"x":-1584,"y":-224,"width":32,"height":32,"inputConnectorIDs":[6341970],"outputSuccessConnectorIDs":[6341973],"outputFailureConnectorIDs":[6341980],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UKG_LDG_OPEN_AND_CLOSED_REQUISITIONS"}}}},"visible":true},"4":{"slot":4,"name":"S3 Object Prefix","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://etld1/UltiPro/Requisitions/"}}}},"visible":true},"5":{"slot":5,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SNFLKDB_PDL}"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SNFLKSCH_UKG}"}}}},"visible":true},"8":{"slot":8,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LDG_UKG_REQUISITION"}}}},"visible":true},"9":{"slot":9,"name":"Load Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"REQUISITION_NUMBER"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"OPPORTUNITY_TITLE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"CREATED_DATE"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"FIRST_PUBLISHED_DATE"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"CLOSED_DATE"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCE_JOB_CODE"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"HIRING_MANAGER"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"LOCATION"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"DIVISION"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"REGION"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNTING_UNIT"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"BRAND"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"COMPANY_CODE"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"REASON_FOR_OPENING"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"INCUMBENT_NAME"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"OPPORTUNITY_STATUS"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"START_DATE"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"DL_CREATED_DATE"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"DL_CREATEDBY"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"DL_JOBID"}}}},"visible":true},"10":{"slot":10,"name":"Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"11":{"slot":11,"name":"File Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CSV"}}}},"visible":true},"12":{"slot":12,"name":"Compression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUTO"}}}},"visible":true},"20":{"slot":20,"name":"Record Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"21":{"slot":21,"name":"Field Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":","}}}},"visible":true},"22":{"slot":22,"name":"Skip Header","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"1"}}}},"visible":true},"23":{"slot":23,"name":"Date Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"24":{"slot":24,"name":"Time Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"25":{"slot":25,"name":"Timestamp Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"26":{"slot":26,"name":"","elements":{},"visible":false},"27":{"slot":27,"name":"Escape","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR_OR_ESCAPE_SEQUENCE","value":""}}}},"visible":true},"28":{"slot":28,"name":"Escape Unenclosed Field","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR_OR_ESCAPE_SEQUENCE","value":""}}}},"visible":true},"29":{"slot":29,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"30":{"slot":30,"name":"Field Optionally Enclosed","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\""}}}},"visible":true},"31":{"slot":31,"name":"Null If","elements":{},"visible":true},"32":{"slot":32,"name":"Error On Column Count Mismatch","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"33":{"slot":33,"name":"Empty Field as Null","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"34":{"slot":34,"name":"Encoding Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"35":{"slot":35,"name":"Skip Blank Lines","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"36":{"slot":36,"name":"Replace Invalid Characters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"40":{"slot":40,"name":"Enable Octal","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"41":{"slot":41,"name":"Allow Duplicates","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"42":{"slot":42,"name":"Strip Outer Array","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"43":{"slot":43,"name":"Strip Null Values","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"44":{"slot":44,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"45":{"slot":45,"name":"Nest Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"46":{"slot":46,"name":"Null If","elements":{},"visible":false},"47":{"slot":47,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"50":{"slot":50,"name":"Null If","elements":{},"visible":false},"51":{"slot":51,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"60":{"slot":60,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"61":{"slot":61,"name":"Preserve Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"62":{"slot":62,"name":"Strip Outer Element","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"63":{"slot":63,"name":"Disable Snowflake Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"64":{"slot":64,"name":"Disable Auto Convert","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"66":{"slot":66,"name":"Null If","elements":{},"visible":false},"67":{"slot":67,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"70":{"slot":70,"name":"Null If","elements":{},"visible":false},"71":{"slot":71,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"120":{"slot":120,"name":"On Error","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Abort Statement"}}}},"visible":true},"121":{"slot":121,"name":"n","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":false},"122":{"slot":122,"name":"Size Limit (B)","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"123":{"slot":123,"name":"Purge Files","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"124":{"slot":124,"name":"Truncate Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"125":{"slot":125,"name":"Force Load","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"126":{"slot":126,"name":"Match By Column Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"140":{"slot":140,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"141":{"slot":141,"name":"Master Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"142":{"slot":142,"name":"KMS Key Id","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"200":{"slot":200,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"201":{"slot":201,"name":"Pattern","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":".*"}}}},"visible":true},"203":{"slot":203,"name":"Metadata Fields","elements":{},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341965":{"id":6341965,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":-1872,"y":-144,"width":32,"height":32,"inputConnectorIDs":[6341975],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6341977],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Status","mapTo":"audit_status"},"2":{"slot":2,"fromId":null,"fromName":"Started At","mapTo":"audit_started"},"3":{"slot":3,"fromId":null,"fromName":"Completed At","mapTo":"audit_completed"},"4":{"slot":4,"fromId":null,"fromName":"Duration","mapTo":"audit_duration"},"5":{"slot":5,"fromId":null,"fromName":"Component","mapTo":"audit_component"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_API_Check_Failure"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"from datetime import datetime\nfrom pytz import timezone\n\njob_name = 'jb_UKG_OPEN_AND_CLOSED_REQUISITIONS'\ncontext.updateVariable(\"Job_Name\",job_name)\n\nfmt = \"%Y-%m-%d %H:%M:%S\"\nCurrentTime = datetime.now()\ncontext.updateVariable(\"Job_StartTimeStamp\",CurrentTime.strftime(fmt))\nCurrentTime = datetime.now()\ncontext.updateVariable(\"Job_EndTimeStamp\",CurrentTime.strftime(fmt))\n\ncursor = context.cursor()\n\ncursor.execute(\"INSERT INTO ${SNFLKDB}.${SNFLKSCH}.AUDIT_METRICS (ROW_COUNT,START_DATE, END_DATE, JOB_ID, JOB_NAME, JOB_STATUS) select 0 AS ROW_COUNT, '%s' AS START_DATE ,'%s' AS END_DATE ,'%s'  AS JOB_ID, '%s' as JOB_NAME ,'FAILED' AS JOB_STATUS\" % (Job_StartTimeStamp,Job_EndTimeStamp, run_history_id, job_name))\t\n\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341966":{"id":6341966,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":-1152,"y":-224,"width":32,"height":32,"inputConnectorIDs":[6341969],"outputSuccessConnectorIDs":[6341972],"outputFailureConnectorIDs":[6341982],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Status","mapTo":"audit_status"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rows affected in this run"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"/* Note: this query will be run as a subquery for the purposes of sampling the data.\n   As such it will be restricted by any subquery limitations specified by the current platform. */\n   \nSELECT COUNT(*) AS rowcount FROM ${SNFLKDB_PDL}.${SNFLKSCH_UKG}.UKG_REQUISITION WHERE DL_JOBID = '${run_history_id}'"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_rowcount"},"2":{"slot":2,"type":"STRING","value":"ROWCOUNT"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341967":{"id":6341967,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-158614544,"x":-1872,"y":-320,"width":32,"height":16,"inputConnectorIDs":[6341976],"outputSuccessConnectorIDs":[6341971],"outputFailureConnectorIDs":[6341981],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Retry 0"}}}},"visible":true},"2":{"slot":2,"name":"Number of Retries","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"3"}}}},"visible":true},"3":{"slot":3,"name":"Retry Delay","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Retry immediately"}}}},"visible":true},"4":{"slot":4,"name":"Retry Interval","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"}}}},"visible":false},"5":{"slot":5,"name":"Retry Time Unit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Second"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[6341951],"inputIterationConnectorIDs":[]}},"successConnectors":{"6341968":{"id":6341968,"sourceID":6341955,"targetID":6341963},"6341969":{"id":6341969,"sourceID":6341960,"targetID":6341966},"6341970":{"id":6341970,"sourceID":6341958,"targetID":6341964},"6341971":{"id":6341971,"sourceID":6341967,"targetID":6341961},"6341972":{"id":6341972,"sourceID":6341966,"targetID":6341954},"6341973":{"id":6341973,"sourceID":6341964,"targetID":6341960}},"failureConnectors":{"6341979":{"id":6341979,"sourceID":6341958,"targetID":6341962},"6341980":{"id":6341980,"sourceID":6341964,"targetID":6341962},"6341981":{"id":6341981,"sourceID":6341967,"targetID":6341962},"6341982":{"id":6341982,"sourceID":6341966,"targetID":6341962},"6341983":{"id":6341983,"sourceID":6341960,"targetID":6341962}},"unconditionalConnectors":{"6341976":{"id":6341976,"sourceID":6341956,"targetID":6341967},"6341977":{"id":6341977,"sourceID":6341965,"targetID":6341959},"6341978":{"id":6341978,"sourceID":6341962,"targetID":6341955}},"trueConnectors":{"6341974":{"id":6341974,"sourceID":6341961,"targetID":6341958}},"falseConnectors":{"6341975":{"id":6341975,"sourceID":6341961,"targetID":6341965}},"iterationConnectors":{"6341951":{"id":6341951,"sourceID":6341967,"targetID":6341957}},"noteConnectors":{},"notes":{},"variables":{"API_Status":{"definition":{"name":"API_Status","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"Success"}},"grids":{"GV_talkdesk_calls":{"definition":{"name":"GV_talkdesk_calls","scope":"BRANCH","definitions":[{"name":"calls_id","type":"TEXT"},{"name":"callsid","type":"TEXT"},{"name":"type","type":"TEXT"},{"name":"start_at","type":"DATETIME"},{"name":"end_at","type":"DATETIME"},{"name":"talkdesk_phone_number","type":"DECIMAL"},{"name":"talkdesk_phone_display_name","type":"TEXT"},{"name":"contact_phone_number","type":"DECIMAL"},{"name":"user_id","type":"TEXT"},{"name":"user_name","type":"TEXT"},{"name":"user_email","type":"TEXT"},{"name":"total_time","type":"DECIMAL"},{"name":"talk_time","type":"DECIMAL"},{"name":"wait_time","type":"DECIMAL"},{"name":"hold_time","type":"DECIMAL"},{"name":"abandon_time","type":"DECIMAL"},{"name":"total_ringing_time","type":"DECIMAL"},{"name":"disposition_code","type":"TEXT"},{"name":"notes","type":"TEXT"},{"name":"user_voice_rating","type":"DECIMAL"},{"name":"ring_groups","type":"TEXT"},{"name":"ivr_options","type":"TEXT"},{"name":"is_in_business_hours","type":"TEXT"},{"name":"is_callback_from_queue","type":"TEXT"},{"name":"is_transfer","type":"TEXT"},{"name":"handling_user_id","type":"TEXT"},{"name":"handling_user_name","type":"TEXT"},{"name":"handling_user_email","type":"TEXT"},{"name":"recording_url","type":"TEXT"},{"name":"is_external_transfer","type":"TEXT"},{"name":"is_if_no_answer","type":"TEXT"},{"name":"is_call_forwarding","type":"TEXT"},{"name":"csat_score","type":"TEXT"},{"name":"csat_survey_time","type":"TEXT"},{"name":"mood","type":"TEXT"},{"name":"is_mood_prompted","type":"TEXT"},{"name":"team_id","type":"TEXT"},{"name":"rating_reason","type":"TEXT"}],"description":"Holds talkdesk calls api data for loading to tables.","visibility":"PUBLIC"},"values":[]}}},"info":{"name":"jb_UKG_OPEN_AND_CLOSED_REQUISITIONS","description":"","type":"ORCHESTRATION","tag":"2b0b00ca-79a0-48a3-af01-b8f636708ca6"}}