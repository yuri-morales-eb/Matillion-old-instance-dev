{"job":{"components":{"6341815":{"id":6341815,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":208,"y":-192,"width":32,"height":32,"inputConnectorIDs":[6341860],"outputSuccessConnectorIDs":[6341862],"outputFailureConnectorIDs":[6341868],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LOCATION_DETAILS_API"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import requests\nimport pandas as pd\nimport boto3\nimport botocore\nimport json\nimport time\nimport math\n\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom io import StringIO\nfrom itertools import chain\n\n\n\"\"\"The goal of this script is not to fully load the file to snowflake, \nbut to take the data from the API and drop it to s3 in a file called 's3://etld1/UltiPro/LocationDetailsDF.csv'\"\"\"\n\n\"\"\"A utility testing script is attached to the ticket in Jira. Ticket BIWS-2896\"\"\"\n\n# Amazon S3 resources for the UltiPro data to stage to snowflake\nBUCKET_NAME = s3_URL.replace(\"s3:\", '').strip('/')\nKEY = 'UltiPro/LocationDetailsDF.csv'  \n\nULTI_USERNAME = 'DataLake'\nULTI_PASSWORD ='STsj=YyLAe{ODi1NUM;?[ykWf=!OUU2MIWicOxxxi^i=2v?5C^'\n\nAUTH = (ULTI_USERNAME, ULTI_PASSWORD)\n\ns3 = boto3.resource('s3')\ns3client = boto3.client('s3')\n\nHEADERS = {\n    'Accept':'*/*',\n    'Accept-Encoding':'gzip, deflate, br',\n    'Connection':'keep-alive',\n    'US-CUSTOMER-API-KEY': 'Z1JCJ',\n    'Accept': 'application/json',\n    'Content-Type': 'application/json'\n}\n\nURL = 'https://service5.ultipro.com/configuration/v1/locations'\n\n\ndef get_data(session, header):\n    \"\"\"\n    Method makes call to UKG API to get location details data. API is paginated, so the first call is made and then \n    :param session: Session object\n    :param header: dict\n    :rtype: response.json object\n    \"\"\"\n    print(\"Getting data from UKG LocationDetails API\")\n    attempts = 0\n\n    while attempts < 3:\n        try:\n            response = session.get(URL, headers=header)\n            print(f\"Response headers: {response.json()}\")\n            response.raise_for_status()\n            return response.json()\n\n        except requests.exceptions.HTTPError as errh:\n            print(errh)\n            attempts += 1\n\n        except requests.exceptions.ConnectionError as errc:\n            print(errc)\n            attempts += 1\n\n        except requests.exceptions.Timeout as errt:\n            print(errt)\n            attempts += 1\n\n        except requests.exceptions.RequestException as err:\n            print(err)\n            attempts += 1\n\n    print(\"Data pull is complete\")\n\n\ndef load_s3(data):\n    print(\"Starting S3 Load\")\n    df = pd.DataFrame(data)\n\n    df['DL_CREATED_DATE'] = datetime.utcnow()\n    df['DL_CREATEDBY'] = environment_username\n    df['DL_JOBID'] = run_history_id\n    \n    csv_buffer = StringIO()\n    df.to_csv(csv_buffer, index=False, line_terminator='\\n', quotechar='\"')\n    \n    s3.Object(BUCKET_NAME, KEY).put(Body=csv_buffer.getvalue())\n    \n    print(\"S3 load is complete\")\n\n\n####################################### RUN PROGRAM ####################################################\nwith requests.Session() as session:\n    session.auth = AUTH\n    result = get_data(session, HEADERS)\n\nload_s3(result)\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"40000"}}}},"visible":true},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341816":{"id":6341816,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":773867971,"x":400,"y":-192,"width":32,"height":32,"inputConnectorIDs":[6341862],"outputSuccessConnectorIDs":[6341859],"outputFailureConnectorIDs":[6341869],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Status","mapTo":"audit_status"},"2":{"slot":2,"fromId":null,"fromName":"Row Count","mapTo":"audit_rowcount"},"3":{"slot":3,"fromId":null,"fromName":"Component","mapTo":"audit_component"},"4":{"slot":4,"fromId":null,"fromName":"Started At","mapTo":"audit_started"},"5":{"slot":5,"fromId":null,"fromName":"Duration","mapTo":"audit_duration"},"6":{"slot":6,"fromId":null,"fromName":"Completed At","mapTo":"audit_completed"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UKG_DL_LOCATIONDETAILS"}}}},"visible":true},"4":{"slot":4,"name":"S3 Object Prefix","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://etld1/"}}}},"visible":true},"5":{"slot":5,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SNFLKDB_PDL}"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SNFLKSCH_UKG}"}}}},"visible":true},"8":{"slot":8,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LDG_UKG_LOCATION_DETAILS"}}}},"visible":true},"9":{"slot":9,"name":"Load Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LOCATIONCODE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"DESCRIPTION"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ISACTIVE"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ADDRESSLINE1"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ADDRESSLINE2"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"CITY"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"STATE"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ZIPORPOSTALCODE"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"COUNTRYCODE"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"LOCATIONGLSEGMENT"}}}},"visible":true},"10":{"slot":10,"name":"Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"11":{"slot":11,"name":"File Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CSV"}}}},"visible":true},"12":{"slot":12,"name":"Compression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUTO"}}}},"visible":true},"20":{"slot":20,"name":"Record Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"21":{"slot":21,"name":"Field Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":","}}}},"visible":true},"22":{"slot":22,"name":"Skip Header","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"1"}}}},"visible":true},"23":{"slot":23,"name":"Date Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"24":{"slot":24,"name":"Time Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"25":{"slot":25,"name":"Timestamp Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"26":{"slot":26,"name":"","elements":{},"visible":false},"27":{"slot":27,"name":"Escape","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"28":{"slot":28,"name":"Escape Unenclosed Field","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"29":{"slot":29,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"30":{"slot":30,"name":"Field Optionally Enclosed","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\""}}}},"visible":true},"31":{"slot":31,"name":"Null If","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"32":{"slot":32,"name":"Error On Column Count Mismatch","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"33":{"slot":33,"name":"Empty Field as Null","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"34":{"slot":34,"name":"Encoding Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"35":{"slot":35,"name":"Skip Blank Lines","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"36":{"slot":36,"name":"Replace Invalid Characters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"40":{"slot":40,"name":"Enable Octal","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"41":{"slot":41,"name":"Allow Duplicates","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"42":{"slot":42,"name":"Strip Outer Array","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"43":{"slot":43,"name":"Strip Null Values","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"44":{"slot":44,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"45":{"slot":45,"name":"Nest Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"46":{"slot":46,"name":"Null If","elements":{},"visible":false},"47":{"slot":47,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"50":{"slot":50,"name":"Null If","elements":{},"visible":false},"51":{"slot":51,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"60":{"slot":60,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"61":{"slot":61,"name":"Preserve Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"62":{"slot":62,"name":"Strip Outer Element","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"63":{"slot":63,"name":"Disable Snowflake Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"64":{"slot":64,"name":"Disable Auto Convert","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"66":{"slot":66,"name":"Null If","elements":{},"visible":false},"67":{"slot":67,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"70":{"slot":70,"name":"Null If","elements":{},"visible":false},"71":{"slot":71,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"120":{"slot":120,"name":"On Error","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Abort Statement"}}}},"visible":true},"121":{"slot":121,"name":"n","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":false},"122":{"slot":122,"name":"Size Limit (B)","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"123":{"slot":123,"name":"Purge Files","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"124":{"slot":124,"name":"Truncate Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"125":{"slot":125,"name":"Force Load","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"126":{"slot":126,"name":"Match By Column Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"140":{"slot":140,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"141":{"slot":141,"name":"Master Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"142":{"slot":142,"name":"KMS Key Id","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"200":{"slot":200,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"201":{"slot":201,"name":"Pattern","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UltiPro/LocationDetailsDF.csv"}}}},"visible":true},"203":{"slot":203,"name":"Metadata Fields","elements":{},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341817":{"id":6341817,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-112,"y":-192,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6341866],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341818":{"id":6341818,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1611478312,"x":576,"y":-192,"width":32,"height":32,"inputConnectorIDs":[6341859],"outputSuccessConnectorIDs":[6341858],"outputFailureConnectorIDs":[6341870],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create Table UKG_Location_Details"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SNFLKDB_PDL}"}}}},"visible":true},"3":{"slot":3,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SNFLKSCH_UKG}"}}}},"visible":true},"4":{"slot":4,"name":"New Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LDG_UKG_LOCATION_DETAILS"}}}},"visible":true},"5":{"slot":5,"name":"Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"locationCode"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"20"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"description"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"100"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"isActive"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"10"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"addressLine1"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"100"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"addressLine2"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"100"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"city"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"30"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"state"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"2"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"zipOrPostalCode"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"20"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"countryCode"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"10"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"locationGLSegment"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"20"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Create/Replace","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create if not exists"}}}},"visible":true},"7":{"slot":7,"name":"Clustering Keys","elements":{},"visible":true},"8":{"slot":8,"name":"Data Retention Time in Days","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"9":{"slot":9,"name":"Comment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"11":{"slot":11,"name":"Primary Keys","elements":{},"visible":true},"12":{"slot":12,"name":"Table Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Temporary"}}}},"visible":true},"13":{"slot":13,"name":"Default DDL Collation","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341819":{"id":6341819,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":704,"y":-192,"width":32,"height":32,"inputConnectorIDs":[6341858],"outputSuccessConnectorIDs":[6341861],"outputFailureConnectorIDs":[6341867],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load UKG Location Details"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT INTO ${SNFLKDB_PDL}.${SNFLKSCH_UKG}.LOCATION_DETAILS\n(SELECT \n \t\"LOCATIONCODE\" LOCATION_CODE,\n\t\"DESCRIPTION\" DESCRIPTION,\n\t\"ISACTIVE\" IS_ACTIVE,\n\t\"ADDRESSLINE1\" ADDRESS_LINE1,\n\t\"ADDRESSLINE2\" ADDRESS_LINE2,\n\t\"CITY\" CITY,\n\t\"STATE\" STATE,\n\t\"ZIPORPOSTALCODE\" ZIP_OR_POSTALCODE,\n\t\"COUNTRYCODE\" COUNTRY_CODE,\n \t\"LOCATIONGLSEGMENT\" LOCATION_GL_SEGMENT\n\t,CURRENT_TIMESTAMP AS DL_CREATED_DATE\n\t,'${environment_username}' AS DL_CREATEDBY\n\t,'${run_history_id}' AS DL_JOBID\nFROM ${SNFLKDB_PDL}.${SNFLKSCH_UKG}.LDG_UKG_LOCATION_DETAILS\n);"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341820":{"id":6341820,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":896,"y":-192,"width":32,"height":32,"inputConnectorIDs":[6341861],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6341863],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_UKG_DL_LOCATIONDETAILS_Success"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_UKG"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341821":{"id":6341821,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":640,"y":-320,"width":32,"height":32,"inputConnectorIDs":[6341864],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6341865],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_UKG_DL_LOCATIONDETAILS_Failure"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_UKG"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_status"},"2":{"slot":2,"type":"STRING","value":"FAILURE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"audit_rowcount"},"2":{"slot":2,"type":"STRING","value":"0"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"audit_component"},"2":{"slot":2,"type":"STRING","value":"UKG_DL_LOCATIONDETAILS"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341822":{"id":6341822,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":1040,"y":-192,"width":32,"height":32,"inputConnectorIDs":[6341863],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341823":{"id":6341823,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":400,"y":-320,"width":32,"height":32,"inputConnectorIDs":[6341867,6341868,6341869,6341870,6341871],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6341864],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Completed At","mapTo":"audit_completed"},"2":{"slot":2,"fromId":null,"fromName":"Started At","mapTo":"audit_started"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341856":{"id":6341856,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":48,"y":-192,"width":32,"height":32,"inputConnectorIDs":[6341866],"outputSuccessConnectorIDs":[6341860],"outputFailureConnectorIDs":[6341871],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate Table UKG Location Details"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate table  ${SNFLKDB_PDL}.${SNFLKSCH_UKG}.LDG_UKG_LOCATION_DETAILS;\nTruncate table  ${SNFLKDB_PDL}.${SNFLKSCH_UKG}.LOCATION_DETAILS;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341857":{"id":6341857,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":880,"y":-320,"width":32,"height":32,"inputConnectorIDs":[6341865],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"6341858":{"id":6341858,"sourceID":6341818,"targetID":6341819},"6341859":{"id":6341859,"sourceID":6341816,"targetID":6341818},"6341860":{"id":6341860,"sourceID":6341856,"targetID":6341815},"6341861":{"id":6341861,"sourceID":6341819,"targetID":6341820},"6341862":{"id":6341862,"sourceID":6341815,"targetID":6341816}},"failureConnectors":{"6341867":{"id":6341867,"sourceID":6341819,"targetID":6341823},"6341868":{"id":6341868,"sourceID":6341815,"targetID":6341823},"6341869":{"id":6341869,"sourceID":6341816,"targetID":6341823},"6341870":{"id":6341870,"sourceID":6341818,"targetID":6341823},"6341871":{"id":6341871,"sourceID":6341856,"targetID":6341823}},"unconditionalConnectors":{"6341863":{"id":6341863,"sourceID":6341820,"targetID":6341822},"6341864":{"id":6341864,"sourceID":6341823,"targetID":6341821},"6341865":{"id":6341865,"sourceID":6341821,"targetID":6341857},"6341866":{"id":6341866,"sourceID":6341817,"targetID":6341856}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{},"grids":{"GV_talkdesk_calls":{"definition":{"name":"GV_talkdesk_calls","scope":"BRANCH","definitions":[{"name":"calls_id","type":"TEXT"},{"name":"callsid","type":"TEXT"},{"name":"type","type":"TEXT"},{"name":"start_at","type":"DATETIME"},{"name":"end_at","type":"DATETIME"},{"name":"talkdesk_phone_number","type":"DECIMAL"},{"name":"talkdesk_phone_display_name","type":"TEXT"},{"name":"contact_phone_number","type":"DECIMAL"},{"name":"user_id","type":"TEXT"},{"name":"user_name","type":"TEXT"},{"name":"user_email","type":"TEXT"},{"name":"total_time","type":"DECIMAL"},{"name":"talk_time","type":"DECIMAL"},{"name":"wait_time","type":"DECIMAL"},{"name":"hold_time","type":"DECIMAL"},{"name":"abandon_time","type":"DECIMAL"},{"name":"total_ringing_time","type":"DECIMAL"},{"name":"disposition_code","type":"TEXT"},{"name":"notes","type":"TEXT"},{"name":"user_voice_rating","type":"DECIMAL"},{"name":"ring_groups","type":"TEXT"},{"name":"ivr_options","type":"TEXT"},{"name":"is_in_business_hours","type":"TEXT"},{"name":"is_callback_from_queue","type":"TEXT"},{"name":"is_transfer","type":"TEXT"},{"name":"handling_user_id","type":"TEXT"},{"name":"handling_user_name","type":"TEXT"},{"name":"handling_user_email","type":"TEXT"},{"name":"recording_url","type":"TEXT"},{"name":"is_external_transfer","type":"TEXT"},{"name":"is_if_no_answer","type":"TEXT"},{"name":"is_call_forwarding","type":"TEXT"},{"name":"csat_score","type":"TEXT"},{"name":"csat_survey_time","type":"TEXT"},{"name":"mood","type":"TEXT"},{"name":"is_mood_prompted","type":"TEXT"},{"name":"team_id","type":"TEXT"},{"name":"rating_reason","type":"TEXT"}],"description":"Holds talkdesk calls api data for loading to tables.","visibility":"PUBLIC"},"values":[]}}},"info":{"name":"jb_UKG_DL_LOCATIONDETAILS","description":"","type":"ORCHESTRATION","tag":"049f3d3d-101d-4110-883e-e58734535ee0"}}